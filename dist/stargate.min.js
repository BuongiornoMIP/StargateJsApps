/*!
 * StargateJS Apps
 * v0.1.0
 * Copyright 2015 DMobileLab. http://buongiorno.com/
 * See LICENSE in this repository for license information
 */
!function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function e(e){return function(){return H.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===te(e)||e instanceof z}function o(e,t){if(G&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ne)){for(var n=[],o=t;o;o=o.source)o.stack&&n.unshift(o.stack);n.unshift(e.stack);var a=n.join("\n"+ne+"\n");e.stack=r(a)}}function r(e){for(var t=e.split("\n"),n=[],o=0;o<t.length;++o){var r=t[o];s(r)||a(r)||!r||n.push(r)}return n.join("\n")}function a(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function i(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var o=/.*@(.+):(\d+)$/.exec(e);return o?[o[1],Number(o[2])]:void 0}function s(e){var t=i(e);if(!t)return!1;var n=t[0],o=t[1];return n===F&&o>=X&&ie>=o}function c(){if(G)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],o=i(n);if(!o)return;return F=o[0],o[1]}}function u(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function p(e){return m(e)?e:v(e)?E(e):_(e)}function l(){function e(e){t=e,a.source=e,V(n,function(t,n){Q(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,o=void 0}var t,n=[],o=[],r=W(l.prototype),a=W(g.prototype);if(a.promiseDispatch=function(e,r,a){var i=K(arguments);n?(n.push(i),"when"===r&&a[1]&&o.push(a[1])):Q(function(){t.promiseDispatch.apply(t,i)})},a.valueOf=function(){if(n)return a;var e=y(t);return m(e)&&(t=e),e},a.inspect=function(){return t?t.inspect():{state:"pending"}},p.longStackSupport&&G)try{throw new Error}catch(i){a.stack=i.stack.substring(i.stack.indexOf("\n")+1)}return r.promise=a,r.resolve=function(n){t||e(p(n))},r.fulfill=function(n){t||e(_(n))},r.reject=function(n){t||e(P(n))},r.notify=function(e){t||V(o,function(t,n){Q(function(){n(e)})},void 0)},r}function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=l();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function f(e){return d(function(t,n){for(var o=0,r=e.length;r>o;o++)p(e[o]).then(t,n)})}function g(e,t,n){void 0===t&&(t=function(e){return P(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var o=W(g.prototype);if(o.promiseDispatch=function(n,r,a){var i;try{i=e[r]?e[r].apply(o,a):t.call(o,r,a)}catch(s){i=P(s)}n&&n(i)},o.inspect=n,n){var r=n();"rejected"===r.state&&(o.exception=r.reason),o.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?o:e.value}}return o}function h(e,t,n,o){return p(e).then(t,n,o)}function y(e){if(m(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function m(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function v(e){return t(e)&&"function"==typeof e.then}function w(e){return m(e)&&"pending"===e.inspect().state}function b(e){return!m(e)||"fulfilled"===e.inspect().state}function S(e){return m(e)&&"rejected"===e.inspect().state}function k(){oe.length=0,re.length=0,ae||(ae=!0)}function A(e,t){ae&&(re.push(e),t&&"undefined"!=typeof t.stack?oe.push(t.stack):oe.push("(no stack) "+t))}function I(e){if(ae){var t=Y(re,e);-1!==t&&(re.splice(t,1),oe.splice(t,1))}}function P(e){var t=g({when:function(t){return t&&I(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return A(t,e),t}function _(e){return g({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return ee(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function E(e){var t=l();return Q(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function M(e){return g({isDef:function(){}},function(t,n){return C(e,t,n)},function(){return p(e).inspect()})}function O(e,t,n){return p(e).spread(t,n)}function B(e){return function(){function t(e,t){var i;if("undefined"==typeof StopIteration){try{i=o[e](t)}catch(s){return P(s)}return i.done?i.value:h(i.value,r,a)}try{i=o[e](t)}catch(s){return n(s)?s.value:P(s)}return h(i,r,a)}var o=e.apply(this,arguments),r=t.bind(t,"next"),a=t.bind(t,"throw");return r()}}function T(e){p.done(p.async(e)())}function x(e){throw new z(e)}function R(e){return function(){return O([this,U(arguments)],function(t,n){return e.apply(t,n)})}}function C(e,t,n){return p(e).dispatch(t,n)}function U(e){return h(e,function(e){var t=0,n=l();return V(e,function(o,r,a){var i;m(r)&&"fulfilled"===(i=r.inspect()).state?e[a]=i.value:(++t,h(r,function(o){e[a]=o,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:a,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function L(e){return h(e,function(e){return e=$(e,p),h(U($(e,function(e){return h(e,J,J)})),function(){return e})})}function D(e){return p(e).allSettled()}function j(e,t){return p(e).then(void 0,void 0,t)}function N(e,t){return p(e).nodeify(t)}var G=!1;try{throw new Error}catch(q){G=!!q.stack}var F,z,X=c(),J=function(){},Q=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var r=t.domain;r&&(t.domain=void 0,r.enter());try{n()}catch(i){if(a)throw r&&r.exit(),setTimeout(e,0),r&&r.enter(),i;setTimeout(function(){throw i},0)}r&&r.exit()}o=!1}var t={task:void 0,next:null},n=t,o=!1,r=void 0,a=!1;if(Q=function(e){n=n.next={task:e,domain:a&&process.domain,next:null},o||(o=!0,r())},"undefined"!=typeof process&&process.nextTick)a=!0,r=function(){process.nextTick(e)};else if("function"==typeof setImmediate)r="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var i=new MessageChannel;i.port1.onmessage=function(){r=s,i.port1.onmessage=e,e()};var s=function(){i.port2.postMessage(0)};r=function(){setTimeout(e,0),s()}}else r=function(){setTimeout(e,0)};return Q}(),H=Function.call,K=e(Array.prototype.slice),V=e(Array.prototype.reduce||function(e,t){var n=0,o=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=o)throw new TypeError}for(;o>n;n++)n in this&&(t=e(t,this[n],n));return t}),Y=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),$=e(Array.prototype.map||function(e,t){var n=this,o=[];return V(n,function(r,a,i){o.push(e.call(t,a,i,n))},void 0),o}),W=Object.create||function(e){function t(){}return t.prototype=e,new t},Z=e(Object.prototype.hasOwnProperty),ee=Object.keys||function(e){var t=[];for(var n in e)Z(e,n)&&t.push(n);return t},te=e(Object.prototype.toString);z="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ne="From previous event:";p.resolve=p,p.nextTick=Q,p.longStackSupport=!1,p.defer=l,l.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(K(arguments,1)):e.resolve(n)}},p.Promise=d,p.promise=d,d.race=f,d.all=U,d.reject=P,d.resolve=p,p.passByCopy=function(e){return e},g.prototype.passByCopy=function(){return this},p.join=function(e,t){return p(e).join(t)},g.prototype.join=function(e){return p([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},p.race=f,g.prototype.race=function(){return this.then(p.race)},p.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(n){return P(n)}}function a(e){if("function"==typeof t){o(e,s);try{return t(e)}catch(n){return P(n)}}return P(e)}function i(e){return"function"==typeof n?n(e):e}var s=this,c=l(),u=!1;return Q(function(){s.promiseDispatch(function(e){u||(u=!0,c.resolve(r(e)))},"when",[function(e){u||(u=!0,c.resolve(a(e)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=i(e)}catch(o){if(n=!0,!p.onerror)throw o;p.onerror(o)}n||c.notify(t)}]),c.promise},p.when=h,g.prototype.thenResolve=function(e){return this.then(function(){return e})},p.thenResolve=function(e,t){return p(e).thenResolve(t)},g.prototype.thenReject=function(e){return this.then(function(){throw e})},p.thenReject=function(e,t){return p(e).thenReject(t)},p.nearer=y,p.isPromise=m,p.isPromiseAlike=v,p.isPending=w,g.prototype.isPending=function(){return"pending"===this.inspect().state},p.isFulfilled=b,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},p.isRejected=S,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var oe=[],re=[],ae=!0;p.resetUnhandledRejections=k,p.getUnhandledReasons=function(){return oe.slice()},p.stopUnhandledRejectionTracking=function(){k(),ae=!1},k(),p.reject=P,p.fulfill=_,p.master=M,p.spread=O,g.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},p.async=B,p.spawn=T,p["return"]=x,p.promised=R,p.dispatch=C,g.prototype.dispatch=function(e,t){var n=this,o=l();return Q(function(){n.promiseDispatch(o.resolve,e,t)}),o.promise},p.get=function(e,t){return p(e).dispatch("get",[t])},g.prototype.get=function(e){return this.dispatch("get",[e])},p.set=function(e,t,n){return p(e).dispatch("set",[t,n])},g.prototype.set=function(e,t){return this.dispatch("set",[e,t])},p.del=p["delete"]=function(e,t){return p(e).dispatch("delete",[t])},g.prototype.del=g.prototype["delete"]=function(e){return this.dispatch("delete",[e])},p.mapply=p.post=function(e,t,n){return p(e).dispatch("post",[t,n])},g.prototype.mapply=g.prototype.post=function(e,t){return this.dispatch("post",[e,t])},p.send=p.mcall=p.invoke=function(e,t){return p(e).dispatch("post",[t,K(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(e){return this.dispatch("post",[e,K(arguments,1)])},p.fapply=function(e,t){return p(e).dispatch("apply",[void 0,t])},g.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},p["try"]=p.fcall=function(e){return p(e).dispatch("apply",[void 0,K(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,K(arguments)])},p.fbind=function(e){var t=p(e),n=K(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(K(arguments))])}},g.prototype.fbind=function(){var e=this,t=K(arguments);return function(){return e.dispatch("apply",[this,t.concat(K(arguments))])}},p.keys=function(e){return p(e).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},p.all=U,g.prototype.all=function(){return U(this)},p.allResolved=u(L,"allResolved","allSettled"),g.prototype.allResolved=function(){return L(this)},p.allSettled=D,g.prototype.allSettled=function(){return this.then(function(e){return U($(e,function(e){function t(){return e.inspect()}return e=p(e),e.then(t,t)}))})},p.fail=p["catch"]=function(e,t){return p(e).then(void 0,t)},g.prototype.fail=g.prototype["catch"]=function(e){return this.then(void 0,e)},p.progress=j,g.prototype.progress=function(e){return this.then(void 0,void 0,e)},p.fin=p["finally"]=function(e,t){return p(e)["finally"](t)},g.prototype.fin=g.prototype["finally"]=function(e){return e=p(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},p.done=function(e,t,n,o){return p(e).done(t,n,o)},g.prototype.done=function(e,t,n){var r=function(e){Q(function(){if(o(e,a),!p.onerror)throw e;p.onerror(e)})},a=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),a.then(void 0,r)},p.timeout=function(e,t,n){return p(e).timeout(t,n)},g.prototype.timeout=function(e,t){var n=l(),o=setTimeout(function(){n.reject(new Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(o),n.resolve(e)},function(e){clearTimeout(o),n.reject(e)},n.notify),n.promise},p.delay=function(e,t){return void 0===t&&(t=e,e=void 0),p(e).delay(t)},g.prototype.delay=function(e){return this.then(function(t){var n=l();return setTimeout(function(){n.resolve(t)},e),n.promise})},p.nfapply=function(e,t){return p(e).nfapply(t)},g.prototype.nfapply=function(e){var t=l(),n=K(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},p.nfcall=function(e){var t=K(arguments,1);return p(e).nfapply(t)},g.prototype.nfcall=function(){var e=K(arguments),t=l();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},p.nfbind=p.denodeify=function(e){var t=K(arguments,1);return function(){var n=t.concat(K(arguments)),o=l();return n.push(o.makeNodeResolver()),p(e).fapply(n).fail(o.reject),o.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var e=K(arguments);return e.unshift(this),p.denodeify.apply(void 0,e)},p.nbind=function(e,t){var n=K(arguments,2);return function(){function o(){return e.apply(t,arguments)}var r=n.concat(K(arguments)),a=l();return r.push(a.makeNodeResolver()),p(o).fapply(r).fail(a.reject),a.promise}},g.prototype.nbind=function(){var e=K(arguments,0);return e.unshift(this),p.nbind.apply(void 0,e)},p.nmapply=p.npost=function(e,t,n){return p(e).npost(t,n)},g.prototype.nmapply=g.prototype.npost=function(e,t){var n=K(t||[]),o=l();return n.push(o.makeNodeResolver()),this.dispatch("post",[e,n]).fail(o.reject),o.promise},p.nsend=p.nmcall=p.ninvoke=function(e,t){var n=K(arguments,2),o=l();return n.push(o.makeNodeResolver()),p(e).dispatch("post",[t,n]).fail(o.reject),o.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(e){var t=K(arguments,1),n=l();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},p.nodeify=N,g.prototype.nodeify=function(e){return e?void this.then(function(t){Q(function(){e(null,t)})},function(t){Q(function(){e(t)})}):this};var ie=c();return p}),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.stargate=t()}(this,function(){function e(){this.initialize=function(e,t,n){var o=Stargate.createMessageId();Stargate.messages[o]=new Message,Stargate.messages[o].msgId=o,Stargate.messages[o].exec="stargate.initializeAd","undefined"!=typeof e&&(Stargate.messages[o].data=e),Stargate.messages[o].callbackSuccess=t,Stargate.messages[o].callbackError=n,Stargate.messages[o].send()},this.createBanner=function(e,t,n){var o=Stargate.createMessageId();Stargate.messages[o]=new Message,Stargate.messages[o].msgId=o,Stargate.messages[o].exec="stargate.createBanner","undefined"!=typeof e&&(Stargate.messages[o].data=e),Stargate.messages[o].callbackSuccess=t,Stargate.messages[o].callbackError=n,Stargate.messages[o].send()},this.hideBanner=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.hideBanner","undefined"!=typeof e&&(Stargate.messages[t].data=e),Stargate.messages[t].send()},this.removeBanner=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.removeBanner","undefined"!=typeof e&&(Stargate.messages[t].data=e),Stargate.messages[t].send()},this.showBannerAtSelectedPosition=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.showBannerAtSelectedPosition","undefined"!=typeof e&&(Stargate.messages[t].data=e),Stargate.messages[t].send()},this.showBannerAtGivenXY=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.showBannerAtGivenXY","undefined"!=typeof e&&(Stargate.messages[t].data=e),Stargate.messages[t].send()},this.registerAdEvents=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.registerAdEvents","undefined"!=typeof e&&(Stargate.messages[t].eventManager=e),Stargate.messages[t].send()},this.prepareInterstitial=function(e,t,n){var o=Stargate.createMessageId();Stargate.messages[o]=new Message,Stargate.messages[o].msgId=o,Stargate.messages[o].exec="stargate.prepareInterstitial","undefined"!=typeof e&&(Stargate.messages[o].data=e),Stargate.messages[o].callbackSuccess=t,Stargate.messages[o].callbackError=n,Stargate.messages[o].send()},this.showInterstitial=function(e){var t=Stargate.createMessageId();Stargate.messages[t]=new Message,Stargate.messages[t].msgId=t,Stargate.messages[t].exec="stargate.showInterstitial","undefined"!=typeof e&&(Stargate.messages[t].data=e),Stargate.messages[t].send()},this.test=function(){alert("it works")}}function t(){window.location.href="index.html"}function n(){document.getElementById("waiting").className="on"}function o(){document.getElementById("waiting").className=""}var r={},a={AdMobSupport:!1,MoPubSupport:!1,AdPosition:{NO_CHANGE:0,TOP_LEFT:1,TOP_CENTER:2,TOP_RIGHT:3,LEFT:4,CENTER:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM_CENTER:8,BOTTOM_RIGHT:9,POS_XY:10},AdSize:{SMART_BANNER:"SMART_BANNER",BANNER:"BANNER",MEDIUM_RECTANGLE:"MEDIUM_RECTANGLE",FULL_BANNER:"FULL_BANNER",LEADERBOARD:"LEADERBOARD",SKYSCRAPER:"SKYSCRAPER"},DefaultOptions:null,initialize:function(e,t,n){return e&&(a.DefaultOptions=e),AdMob&&(a.AdMobSupport=!0,a.initAdMob(e,t,n)),MoPub&&(a.MoPubSupport=!0),!0},isAdMobSupported:function(){return a.AdMobSupport},isMoPubSupported:function(){return a.MoPubSupport},getUserAgent:function(){return/(android)/i.test(navigator.userAgent)?"android":/(ipod|iphone|ipad)/i.test(navigator.userAgent)?"ios":"other"},initAdMob:function(e,t,n){var o={adSize:"BANNER",position:8,bgColor:"black",isTesting:!1,autoShow:!0};AdMob.setOptions(o,t,n)},initMoPub:function(e,t,n){},registerAdEvents:function(e){document.addEventListener("onAdFailLoad",e),document.addEventListener("onAdLoaded",e),document.addEventListener("onAdPresent",e),document.addEventListener("onAdLeaveApp",e),document.addEventListener("onAdDismiss",e)},manageAdEvents:function(e){console.log("error: "+e.error+", reason: "+e.reason+", adNetwork:"+e.adNetwork+", adType:"+e.adType+", adEvent:"+e.adEvent)},createBanner:function(e,t,n){var o={},r=new Array,i=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?r=e:r.push(e),r.forEach(function(e){if("default"==e.device||e.device==i){var r=a.getAdSize().toLowerCase();e.overlap&&(o.overlap=e.overlap),e.offsetTopBar&&(o.offsetTopBar=e.offsetTopBar),o.adSize=a.getAdSize(),r&&(o.adId=e[r]),e.position&&(o.position=a.AdPosition[e.position]),e.width&&(o.width=e.width),e.height&&(o.height=e.height),e.autoShow&&(o.autoShow=e.autoShow),"admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?(e.width&&e.height&&(o.adSize="CUSTOM"),AdMob.createBanner(o,t,n)):"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.createBanner(o,t,n)}})},showBannerAtSelectedPosition:function(e){var t=new Array,n=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?t=e:t.push(e),t.forEach(function(e){("default"==e.device||e.device==n)&&("admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.showBanner(e.position):"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.showBanner(e.position))})},showBannerAtGivenXY:function(e){var t=new Array,n=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?t=e:t.push(e),t.forEach(function(e){("default"==e.device||e.device==n)&&("admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.showBannerAtXY(e.x,e.y):"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.showBannerAtXY(e.x,e.y))})},hideBanner:function(e){var t=new Array,n=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?t=e:t.push(e),t.forEach(function(e){("default"==e.device||e.device==n)&&("admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.hideBanner():"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.hideBanner())})},removeBanner:function(e){var t=new Array,n=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?t=e:t.push(e),t.forEach(function(e){("default"==e.device||e.device==n)&&("admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.removeBanner():"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.removeBanner())})},prepareInterstitial:function(e,t,n){var o={},r=new Array,i=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?r=e:r.push(e),r.forEach(function(e){("default"==e.device||e.device==i)&&(e.interstitial&&(o.adId=e.interstitial),e.autoShow&&(o.autoShow=e.autoShow),"admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.prepareInterstitial(o):"mopub"==e.network.toLowerCase()&&MoPub.prepareInterstitial(o,t,n))})},showInterstitial:function(e){var t=new Array,n=a.getUserAgent();e||a.isObjEmpty(a.DefaultOptions)||(e=a.DefaultOptions),Array.isArray(e)?t=e:t.push(e),t.forEach(function(e){("default"==e.device||e.device==n)&&("admob"==e.network.toLowerCase()||"dfp"==e.network.toLowerCase()?AdMob.showInterstitial():"mopub"==e.network.toLowerCase().toLowerCase()&&MoPub.showInterstitial())})},isObjEmpty:function(e){return 0===Object.keys(e).length},getAdSize:function(){var e=screen.height,t=screen.width;return t>=728&&e>=90?a.AdSize.LEADERBOARD:t>=468&&e>=60?a.AdSize.BANNER:t>=320&&e>=50?a.AdSize.BANNER:void 0}},i={height:"",width:"",appUrl:"",version:"",country:"",selector:"",api_selector:"",app_prefix:"",hybrid_conf:{},crypter:{},msgId:"",busy:!1,back:0,cordovaError:function(e){null!==e&&console.error("Error from Cordova: "+e)},onMessageReceived:function(e){if(e.origin!==s.label.origin)return void console.log("postMessage received from invalid origin",e);var t={};try{t=JSON.parse(e.data)}catch(r){return void console.log("Json error: ",e.data)}if(i.isBusy()&&"ready"!==t.exec)return void console.log("Message received but the app is busy, ignoring");switch(t.exec){case"system":window.open(t.url,"_system");break;case"stargate.facebookLogin":i.setBusy(!0),i.msgId=t.msgId,facebookConnectPlugin.login(t.scope.split(","),i.onFbLoginSuccessStargate,function(e){i.setBusy(!1),console.log("Got FB login error:",e),i.sendBackToStargate("stargate.facebooklogin",i.msgId,!1,{error:e},!0)});break;case"stargate.facebookShare":i.setBusy(!0),i.msgId=t.msgId;var u={method:"share",href:t.url};facebookConnectPlugin.showDialog(u,function(e){i.sendBackToStargate("stargate.facebookShare",i.msgId,!0,{message:e},!1)},function(e){i.setBusy(!1),console.log("Got FB share error:",e),i.sendBackToStargate("stargate.facebookShare",i.msgId,!1,{error:e},!1)});break;case"fblogin":n(),i.appUrl=t.url,facebookConnectPlugin.login(t.scope.split(","),i.onFbLoginSuccess,function(e){console.log("Got FB login error:",e),o()});break;case"googlelogin":n(),i.appUrl=t.url,window.plugins.googleplus.login({androidApiKey:s.label.google_client_id},i.onGoogleLoginSuccess,function(e){console.log("Got Google login error: "+e),o()});break;case"purchase":n(),t.url&&(i.appUrl=t.url),store.order(c.id),store.refresh();break;case"stargate.purchase.subscription":i.setBusy(!0),i.msgId=t.msgId,t.returnUrl&&(i.appUrl=t.returnUrl),"undefined"!=typeof t.subscriptionUrl&&(c.subscribeMethod=t.subscriptionUrl),store.order(c.id),store.refresh();break;case"restore":n(),t.url&&(i.appUrl=t.url),store.refresh(),storekit.restore();break;case"stargate.restore":i.setBusy(!0),i.msgId=t.msgId,t.returnUrl&&(i.appUrl=t.returnUrl),"undefined"==typeof t.subscriptionUrl&&(c.subscribeMethod="stargate"),store.refresh(),storekit.restore();break;case"stargate.googleLogin":console.log(t),i.setBusy(!0),i.msgId=t.msgId,window.plugins.googleplus.login({androidApiKey:s.label.google_client_id},i.onGoogleLoginSuccessStargate,function(e){console.log("Got Google login error: "+e),i.sendBackToStargate("stargate.googleLogin",i.msgId,!1,{error:e}),i.setBusy(!1)});break;case"stargate.checkConnection":i.msgId=t.msgId;var p=navigator.connection.type;i.sendBackToStargate("stargate.checkConnection",i.msgId,!0,{networkState:p});break;case"stargate.getDeviceID":i.msgId=t.msgId;var l=device.uuid;i.sendBackToStargate("stargate.getDeviceId",i.msgId,!0,{deviceID:l});break;case"stargate.createBanner":i.setBusy(!0),i.msgId=t.msgId;var d=null;t.data&&(d="object"==typeof t.data?t.data:JSON.parse(decodeURIComponent(t.data))),a.createBanner(d),i.setBusy(!1);break;case"stargate.hideBanner":i.setBusy(!0),i.msgId=t.msgId;var d=null;t.data&&(d="object"==typeof t.data?t.data:JSON.parse(decodeURIComponent(t.data))),a.hideBanner(d),i.setBusy(!1);break;case"stargate.removeBanner":i.setBusy(!0),i.msgId=t.msgId;var d=null;t.data&&(d="object"==typeof t.data?t.data:JSON.parse(decodeURIComponent(t.data))),a.removeBanner(d),i.setBusy(!1)}},onFbLoginSuccess:function(e){facebookConnectPlugin.getAccessToken(function(e){i.appUrl=i.appUrl+"&apk_fb_user_token="+e,i.launch(i.appUrl)},function(e){console.log("Could not get access token: "+e),t()})},onGoogleLoginSuccess:function(e){window.localStorage.getItem("googleRefreshToken_"+e.userId)?(i.appUrl=i.appUrl+"&apk_google_user_token="+window.localStorage.getItem("googleRefreshToken_"+e.userId),i.launch(i.appUrl)):window.plugins.googleplus.token({email:e.email,androidApiKey:s.label.google_client_id},function(t){i.onGoogleTokenSuccess(t,e)},function(e){console.log("Got Google login error: "+e),o()})},onGoogleTokenSuccess:function(e,n){if(e.oauthToken){var o;o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var e=JSON.parse(o.responseText),r=e.refresh_token;r?(window.localStorage.setItem("googleRefreshToken_"+n.userId,r),i.appUrl=i.appUrl+"&apk_google_user_token="+r,i.launch(i.appUrl)):(console.log("Could not get refresh token"),t())}catch(a){console.log("Error app.onGoogleLoginSuccess reading the response: "+a.toString()),t()}else console.log("Error app.onGoogleLoginSuccess",o.statusText),i.launch(i.url())};var r=s.api.googleToken;o.open("POST",r,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded");var a="client_id="+s.label.google_client_id+"&client_secret="+s.label.google_client_secret+"&code="+e.oauthToken+"&redirect_uri=&grant_type=authorization_code";o.send(a)}else console.log("Could not get google code"),t()},onFbLoginSuccessStargate:function(e,t){i.setBusy(!1),facebookConnectPlugin.getAccessToken(function(e){i.sendBackToStargate("stargate.facebooklogin",i.msgId,!0,{accessToken:e})},function(e){i.sendBackToStargate("stargate.facebooklogin",i.msgId,!1,{error:e})})},onGoogleLoginSuccessStargate:function(e){console.log(e,s.label.google_client_id),i._userData=e,window.plugins.googleplus.token({email:e.email,androidApiKey:s.label.google_client_id},function(e){i.onGoogleTokenSuccess(e,i._userData)},function(e){i.sendBackToStargate("stargate.googleLogin",i.msgId,!1,{error:e}),console.log("Got Google login error: "+e),i.setBusy(!1)})},onDeltaDNAStartedSuccess:function(){deltadna.registerPushCallback(i.onDeltaDNAPush)},onDeltaDNAStartedError:function(){},onDeltaDNAPush:function(e){B.Android()&&e.payload&&e.payload.url&&!e.foreground&&(i.appUrl=e.payload.url,i.launch(i.appUrl)),B.iOS()&&e.url&&(i.appUrl=e.url,i.launch(i.appUrl))},sendBackToStargate:function(e,t,n,o,r){var a={};a.exec=e,a.originalMsgId=t,a.success=n,a.callbackParams=o,a.timestamp=Date.now();var s=forge.md.sha1.create();s.update(a.originalMsgId+a.exec+a.timestamp+(a.success?"OK":"KO"),"utf8"),a.signature="",i.iframe.contentWindow.postMessage(JSON.stringify(a),"*"),r||i.setBusy(!1)}},s={api:{networkInfo:"http://api.playme.info/xradio/network.info?apikey=%apikey%&country=it&format=json",dictPlayme:"http://api.playme.info/%api_selector%/dictionary.get",mfpSet:"/mfpset.php?url=%url%%pony%",mfpGet:"http://api.motime.com/v01/mobileFingerprint.get?apikey=%apikey%&contents_inapp=%contents_inapp%&country=%country%&expire=%expire%",googleToken:"https://accounts.google.com/o/oauth2/token",userCreate:"%domain%/%country%/%selector%/%app_prefix%/store/usercreate/"},iap_android:{id:"test_subscription_trial",alias:"PlayMe Subscription",type:"PAID_SUBSCRIPTION",verbosity:"DEBUG",paymethod:"gwallet"},iap_ios:{id:"playme.subscription.monthly",alias:"PlayMe Subscription",type:"PAID_SUBSCRIPTION",verbosity:"DEBUG",paymethod:"itunes"}};s.getText=function(e){return console.error("CONFIGS.getText is deprecated!"),e};var c={id:"",alias:"",type:"",verbosity:"",paymethod:"",subscribeMethod:"stargate",initialize:function(){return window.store?(c.id=i.hybrid_conf.IAP.id?i.hybrid_conf.IAP.id:B.Android()?s.iap_android.id:s.iap_ios.id,c.alias=i.hybrid_conf.IAP.alias?i.hybrid_conf.IAP.alias:B.Android()?s.iap_android.alias:s.iap_ios.alias,c.type=i.hybrid_conf.IAP.type?i.hybrid_conf.IAP.type:B.Android()?s.iap_android.type:s.iap_ios.type,c.verbosity=i.hybrid_conf.IAP.verbosity?i.hybrid_conf.IAP.verbosity:B.Android()?s.iap_android.verbosity:s.iap_ios.verbosity,c.paymethod=i.hybrid_conf.IAP.paymethod?i.hybrid_conf.IAP.paymethod:B.Android()?s.iap_android.paymethod:s.iap_ios.paymethod,console.log("IAP initialize id: "+c.id),B.Android()&&c.getGoogleAccount(),store.verbosity=store[c.verbosity],store.register({id:c.id,alias:c.alias,type:store[c.type]}),store.when(c.alias).approved(function(e){c.onPurchaseApproved(e)}),store.when(c.alias).verified(function(e){c.onPurchaseVerified(e)}),store.when(c.alias).updated(function(e){c.onProductUpdate(e)}),store.when(c.alias).owned(function(e){c.onProductOwned(e)}),store.when(c.alias).cancelled(function(e){c.onCancelledProduct(e)}),store.when(c.alias).error(function(e){c.error(JSON.stringify(e))}),store.ready(function(){c.onStoreReady()}),void store.when("order "+c.id).approved(function(e){c.onOrderApproved(e)})):void console.log("Store not available")},getPassword:function(e){return u("iap."+e+".playme").substr(0,8)},getGoogleAccount:function(){window.accountmanager.getAccounts(c.checkGoogleAccount,c.error,"com.google")},checkGoogleAccount:function(e){if(e){console.log("accounts"),console.log(e);for(var t in e)return window.localStorage.setItem("googleAccount",e[t].email),e[t].email}},onProductUpdate:function(e){console.log("IAP> Product updated."),console.log(JSON.stringify(e)),e.owned?console.log("Subscribed!"):console.log("Not Subscribed")},onPurchaseApproved:function(e){console.log("IAP> Purchase approved."),console.log(JSON.stringify(e)),e.finish()},onPurchaseVerified:function(e){console.log("subscription verified")},onStoreReady:function(){console.log("\\o/ STORE READY \\o/")},onProductOwned:function(e){if(console.log("IAP > Product Owned."),!e.transaction.id&&B.iOS())return console.log("IAP > no transaction id"),!1;if(window.localStorage.setItem("product",e),B.iOS()&&window.localStorage.setItem("transaction_id",e.transaction.id),B.Android()){var t=e.transaction.purchaseToken+"|"+s.label.id+"|"+c.id;console.log("Purchase Token: "+t),window.localStorage.getItem("user_account")||c.createUser(e,t)}else storekit.loadReceipts(function(n){if(console.log("appStoreReceipt: "+n.appStoreReceipt),"callback"==c.subscribeMethod){var o={};return o.exec="stargate.purchase.subscription",o.originalMsgId=i.msgId,o.callbackParams={product:e,purchase_token:t,paymethod:c.paymethod},o.success=!0,appframe=document.getElementById("appframe"),void appframe.contentWindow.postMessage(JSON.stringify(o),"*")}window.localStorage.getItem("user_account")||c.createUser(e,n.appStoreReceipt)})},onCancelledProduct:function(e){i.sendBackToStargate("stargate.purchase.subscription",i.msgId,!1,{
iap_cancelled:1,return_url:i.appUrl},!1),console.log("IAP > Purchase cancelled ##################################")},onOrderApproved:function(e){console.log("ORDER APPROVED "+c.id),e.finish()},error:function(e){i.sendBackToStargate("stargate.purchase.subscription",i.msgId,!1,{iap_error:1,return_url:i.appUrl},!1),console.log("error")},createUser:function(e,t){window.localStorage.setItem("user_account",B.Android()?window.localStorage.getItem("googleAccount")?window.localStorage.getItem("googleAccount"):t+"@google.com":e.transaction.id+"@itunes.com");var n=c.subscribeMethod;"stargate"==c.subscribeMethod&&(n=s.api.userCreate,n=i.app_prefix?n.replace("%app_prefix%",i.app_prefix).replace("%selector%",i.selector):n.replace("%app_prefix%/","").replace("%selector%/",""),n=n.replace("%domain%",i.url()).replace("%country%",i.country)),$.ajax({type:"POST",url:n,data:"paymethod="+c.paymethod+"&user_account="+window.localStorage.getItem("user_account")+"&purchase_token="+encodeURIComponent(t)+"&return_url="+encodeURIComponent(i.url())+"&inapp_pwd="+c.getPassword(t)+"&hybrid=1",dataType:"json",success:function(e){console.log(e),e.device_id=device.uuid,window.localStorage.getItem("transaction_id")&&(e.transaction_id=window.localStorage.getItem("transaction_id")),i.sendBackToStargate("stargate.purchase.subscription",i.msgId,!0,e,!1)},error:function(e){console.log("Chiamata fallita, si prega di riprovare...",e);var t={iap_error:"1",return_url:i.url()};i.sendBackToStargate("stargate.purchase.subscription",i.msgId,!1,t,!1)}})}},u=function(){function e(e,t){var i=e[0],s=e[1],c=e[2],u=e[3];i=n(i,s,c,u,t[0],7,-680876936),u=n(u,i,s,c,t[1],12,-389564586),c=n(c,u,i,s,t[2],17,606105819),s=n(s,c,u,i,t[3],22,-1044525330),i=n(i,s,c,u,t[4],7,-176418897),u=n(u,i,s,c,t[5],12,1200080426),c=n(c,u,i,s,t[6],17,-1473231341),s=n(s,c,u,i,t[7],22,-45705983),i=n(i,s,c,u,t[8],7,1770035416),u=n(u,i,s,c,t[9],12,-1958414417),c=n(c,u,i,s,t[10],17,-42063),s=n(s,c,u,i,t[11],22,-1990404162),i=n(i,s,c,u,t[12],7,1804603682),u=n(u,i,s,c,t[13],12,-40341101),c=n(c,u,i,s,t[14],17,-1502002290),s=n(s,c,u,i,t[15],22,1236535329),i=o(i,s,c,u,t[1],5,-165796510),u=o(u,i,s,c,t[6],9,-1069501632),c=o(c,u,i,s,t[11],14,643717713),s=o(s,c,u,i,t[0],20,-373897302),i=o(i,s,c,u,t[5],5,-701558691),u=o(u,i,s,c,t[10],9,38016083),c=o(c,u,i,s,t[15],14,-660478335),s=o(s,c,u,i,t[4],20,-405537848),i=o(i,s,c,u,t[9],5,568446438),u=o(u,i,s,c,t[14],9,-1019803690),c=o(c,u,i,s,t[3],14,-187363961),s=o(s,c,u,i,t[8],20,1163531501),i=o(i,s,c,u,t[13],5,-1444681467),u=o(u,i,s,c,t[2],9,-51403784),c=o(c,u,i,s,t[7],14,1735328473),s=o(s,c,u,i,t[12],20,-1926607734),i=r(i,s,c,u,t[5],4,-378558),u=r(u,i,s,c,t[8],11,-2022574463),c=r(c,u,i,s,t[11],16,1839030562),s=r(s,c,u,i,t[14],23,-35309556),i=r(i,s,c,u,t[1],4,-1530992060),u=r(u,i,s,c,t[4],11,1272893353),c=r(c,u,i,s,t[7],16,-155497632),s=r(s,c,u,i,t[10],23,-1094730640),i=r(i,s,c,u,t[13],4,681279174),u=r(u,i,s,c,t[0],11,-358537222),c=r(c,u,i,s,t[3],16,-722521979),s=r(s,c,u,i,t[6],23,76029189),i=r(i,s,c,u,t[9],4,-640364487),u=r(u,i,s,c,t[12],11,-421815835),c=r(c,u,i,s,t[15],16,530742520),s=r(s,c,u,i,t[2],23,-995338651),i=a(i,s,c,u,t[0],6,-198630844),u=a(u,i,s,c,t[7],10,1126891415),c=a(c,u,i,s,t[14],15,-1416354905),s=a(s,c,u,i,t[5],21,-57434055),i=a(i,s,c,u,t[12],6,1700485571),u=a(u,i,s,c,t[3],10,-1894986606),c=a(c,u,i,s,t[10],15,-1051523),s=a(s,c,u,i,t[1],21,-2054922799),i=a(i,s,c,u,t[8],6,1873313359),u=a(u,i,s,c,t[15],10,-30611744),c=a(c,u,i,s,t[6],15,-1560198380),s=a(s,c,u,i,t[13],21,1309151649),i=a(i,s,c,u,t[4],6,-145523070),u=a(u,i,s,c,t[11],10,-1120210379),c=a(c,u,i,s,t[2],15,718787259),s=a(s,c,u,i,t[9],21,-343485551),e[0]=l(i,e[0]),e[1]=l(s,e[1]),e[2]=l(c,e[2]),e[3]=l(u,e[3])}function t(e,t,n,o,r,a){return t=l(l(t,e),l(o,a)),l(t<<r|t>>>32-r,n)}function n(e,n,o,r,a,i,s){return t(n&o|~n&r,e,n,a,i,s)}function o(e,n,o,r,a,i,s){return t(n&r|o&~r,e,n,a,i,s)}function r(e,n,o,r,a,i,s){return t(n^o^r,e,n,a,i,s)}function a(e,n,o,r,a,i,s){return t(o^(n|~r),e,n,a,i,s)}function i(t){var n,o=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=t.length;n+=64)e(r,s(t.substring(n-64,n)));t=t.substring(n-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)a[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(a[n>>2]|=128<<(n%4<<3),n>55)for(e(r,a),n=0;16>n;n++)a[n]=0;return a[14]=8*o,e(r,a),r}function s(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function c(e){for(var t="",n=0;4>n;n++)t+=d[e>>8*n+4&15]+d[e>>8*n&15];return t}function u(e){for(var t=0;t<e.length;t++)e[t]=c(e[t]);return e.join("")}function p(e){return u(i(unescape(encodeURIComponent(e))))}function l(e,t){return e+t&4294967295}var d="0123456789abcdef".split("");return p}(),p={};p.check=function(){if(s.label.country)p.get(s.label.country);else{var e;e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status)try{console.log(e.responseText);var t=JSON.parse(e.responseText);console.log(t);var n=t.response.realCountry;p.get(n)}catch(o){console.log("Error MFP.check reading the response: "+o.toString()),i.launch(i.url())}else console.log("Error MFP.check",e.statusText),i.launch(i.url())};var t=s.api.networkInfo;t=t.replace("%apikey%",s.label.apimm_apikey),e.open("GET",t,!0),e.send()}},p.getContents=function(e,t,n,o){var r={};r.api_country=n,r.country=e,o&&(r.extData=o),r.fpnamespace=t;var a=JSON.stringify(r);return a},p.set=function(e,t){var n=s.label.url+s.api.mfpSet,o=i.url();e&&(e="&"+e),window.localStorage.getItem("appUrl")&&(o=window.localStorage.getItem("appUrl")),n=n.replace("%pony%",e).replace("%url%",encodeURIComponent(o)),console.log("MFP going to url: ",n),i.launch(n)},p.get=function(e){var t,n="";t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status)try{console.log(t.responseText);var o=JSON.parse(t.responseText);if(console.log(o),o.content.inappInfo){var r=JSON.parse(o.content.inappInfo);r.extData&&r.extData.ponyUrl&&(n=r.extData.ponyUrl),r.extData&&r.extData.return_url&&window.localStorage.setItem("appUrl",r.extData.return_url)}else console.log("Empty session MFP.get");p.set(n,e)}catch(a){console.log("Error MFP.get reading the response: "+a.toString()),i.launch(i.url())}else console.log("Error MFP.get",t.statusText),i.launch(i.url())};var o=(navigator.language.split("-"),s.label.namespace),r="",a=s.label.motime_apikey,c=s.label.label,u=p.getContents(e,o,c),l=s.api.mfpGet;l=l.replace("%apikey%",a).replace("%contents_inapp%",u).replace("%country%",e).replace("%expire%",r),t.open("GET",l,!0),t.send()};var l=function(e,t){return"undefined"!=typeof t?console.log("[Stargate] "+e+" ",t):console.log("[Stargate] "+e),!0},d=function(e,t){return"undefined"!=typeof t?console.error("[Stargate] "+e+" ",t):console.error("[Stargate] "+e),!1},f={available:!1,cordova:"",manufacturer:"",model:"",platform:"",uuid:"",version:""},g=function(){if("undefined"==typeof window.device)return d("Missing cordova device plugin");for(var e in f)window.device.hasOwnProperty(e)&&(f[e]=window.device[e]);return!0};window.pubKey="",window.forge="";var h=function(){var e=Q.defer();return cordova.getAppVersion(function(t){l("[getAppVersionPromise] got version: "+t),e.resolve(t)}),e.promise},y=function(){var e=Q.defer();return hostedwebapp.getManifest(function(t){e.resolve(t)},function(t){e.reject(new Error(t)),console.error(t)}),e.promise},m=!1,v=!1,w=null,b=null,S="",k="",A="",I="",P="",_={},E=function(){document.title=s.label.title,StatusBar.hide(),i.hasFeature("mfp")&&p.check(),i.hasFeature("deltadna")&&window.deltadna.startSDK(s.label.deltadna.environmentKey,s.label.deltadna.collectApi,s.label.deltadna.engageApi,i.onDeltaDNAStartedSuccess,i.onDeltaDNAStartedError,s.label.deltadna.settings),e&&(r.ad=new e),navigator.splashscreen.hide(),i.setBusy(!1),c.initialize(),document.cookie="hybrid=1; path=/",v=!0,w()},M=function(){g();var e=h(),t=y();Q.all([e,t]).then(function(e,t){S=e,O=t.stargateConf,E()})};r.initialize=function(e,t,n,o){return m&&Q.defer().reject(new Error("Stargate.initialize() already called!")),m=!0,w=o,b=Q.defer(),e.country&&(k=e.country),e.selector&&(A=e.selector),e.api_selector&&(I=e.api_selector),e.app_prefix&&(P=e.app_prefix),e.hybrid_conf&&(_="object"==typeof e.hybrid_conf?e.hybrid_conf:JSON.parse(decodeURIComponent(e.hybrid_conf))),document.addEventListener("deviceready",M,!1),initDeferred.promise},r.isInitialized=function(){return m},r.isOpen=function(){return v},r.openUrl=function(e){},r.inAppPurchase=function(e,t,n,o){},r.inAppPurchaseSubscription=function(e,t,n,o){},r.inAppRestore=function(e,t,n,o){},r.facebookLogin=function(e,t,n){},r.facebookShare=function(e,t,n){},r.googleLogin=function(e,t){},r.checkConnection=function(e,t){},r.getDeviceID=function(e,t){};var O={};!function(e){function t(e){return e&&(e=decodeURIComponent(e),e=e.replace(a.pluses," ")),e}function n(e){var t=a.uri_parser,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],o=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=o[t]||""}),r}function o(e){var t,n,o,r,i,s,c=[];if("undefined"==typeof e||null===e||""===e)return c;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(a.query_separator),t=0;t<n.length;t++)o=n[t],r=o.indexOf("="),0!==r&&(i=decodeURIComponent(o.substring(0,r)),s=decodeURIComponent(o.substring(r+1)),c.push(-1===r?[o,null]:[i,s]));return c}function r(e){this.uriParts=n(e),this.queryPairs=o(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var a={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,o=this.length;o>n;++n)e.call(t||this,this[n],n,this)}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){r.prototype[e]=function(t){return"undefined"!=typeof t&&(this.uriParts[e]=t),this.uriParts[e]}}),r.prototype.hasAuthorityPrefix=function(e){return"undefined"!=typeof e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},r.prototype.query=function(e){var t,n,r="";for("undefined"!=typeof e&&(this.queryPairs=o(e)),t=0;t<this.queryPairs.length;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:(r+=n[0],r+="=",n[1]&&(r+=encodeURIComponent(n[1])));return r.length>0?"?"+r:r},r.prototype.getQueryParamValue=function(e){var t,n;for(n=0;n<this.queryPairs.length;n++)if(t=this.queryPairs[n],e===t[0])return t[1]},r.prototype.getQueryParamValues=function(e){var t,n,o=[];for(t=0;t<this.queryPairs.length;t++)n=this.queryPairs[t],e===n[0]&&o.push(n[1]);return o},r.prototype.deleteQueryParam=function(e,n){var o,r,a,i,s=[];for(o=0;o<this.queryPairs.length;o++)r=this.queryPairs[o],a=t(r[0])===t(e),i=r[1]===n,(1!==arguments.length||a)&&(2!==arguments.length||a&&i)||s.push(r);return this.queryPairs=s,this},r.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},r.prototype.replaceQueryParam=function(e,n,o){var r,a,i=-1;if(3===arguments.length){for(r=0;r<this.queryPairs.length;r++)if(a=this.queryPairs[r],t(a[0])===t(e)&&decodeURIComponent(a[1])===t(o)){i=r;break}this.deleteQueryParam(e,t(o)).addQueryParam(e,n,i)}else{for(r=0;r<this.queryPairs.length;r++)if(a=this.queryPairs[r],t(a[0])===t(e)){i=r;break}this.deleteQueryParam(e),this.addQueryParam(e,n,i)}return this},["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);r.prototype[t]=function(t){return this[e](t),this}}),r.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},r.prototype.origin=function(){var e=this.scheme();return"file://"==e?e+this.uriParts.authority:(this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),this.port()&&(e+=":"+this.port())),e)},r.prototype.addTrailingSlash=function(){var e=this.path()||"";return"/"!==e.substr(-1)&&this.path(e+"/"),this},r.prototype.toString=function(){var e,t=this.origin();return this.path()?(e=this.path(),a.ends_with_slashes.test(t)||a.starts_with_slashes.test(e)?(t&&t.replace(a.ends_with_slashes,"/"),e=e.replace(a.starts_with_slashes,"/")):t+="/",t+=e):this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(0!==this.query().toString().indexOf("?")&&(t+="?"),t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},r.prototype.clone=function(){return new r(this.toString())},"function"==typeof define&&define.amd?define(function(){return r}):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=r:e.Uri=r}(this);var B={Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},Windows:function(){return/IEMobile/i.test(navigator.userAgent)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Windows()}};return r});