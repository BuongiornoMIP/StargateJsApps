/*!
 * StargateJS Apps
 * v0.2.0
 * Copyright 2015 DMobileLab. http://buongiorno.com/
 * See LICENSE in this repository for license information
 */
!function(e,t){"use strict";"object"==typeof exports?module.exports=t(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)}(this,function(e,t,n,r){"use strict";function i(e,t){var n=arguments.length>=1,r=arguments.length>=2;if(!(this instanceof i))return n?r?new i(e,t):new i(e):new i;if(void 0===e){if(n)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}return this.href(e),void 0!==t?this.absoluteTo(t):this}function o(e){return e.replace(/([.*+?^=!:()|[\]\/\\])/g,"\\$1")}function a(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function s(e){return"Array"===a(e)}function c(e,t){var n,r,i={};if("RegExp"===a(t))i=null;else if(s(t))for(n=0,r=t.length;r>n;n++)i[t[n]]=!0;else i[t]=!0;for(n=0,r=e.length;r>n;n++){var o=i&&void 0!==i[e[n]]||!i&&t.test(e[n]);o&&(e.splice(n,1),r--,n--)}return e}function u(e,t){var n,r;if(s(t)){for(n=0,r=t.length;r>n;n++)if(!u(e,t[n]))return!1;return!0}var i=a(t);for(n=0,r=e.length;r>n;n++)if("RegExp"===i){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function l(e,t){if(!s(e)||!s(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0,r=e.length;r>n;n++)if(e[n]!==t[n])return!1;return!0}function d(e){var t=/^\/+|\/+$/g;return e.replace(t,"")}function p(e){return escape(e)}function f(e){return encodeURIComponent(e).replace(/[!'()*]/g,p).replace(/\*/g,"%2A")}function h(e){return function(t,n){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!n),this)}}function m(e,t){return function(n,r){return void 0===n?this._parts[e]||"":(null!==n&&(n+="",n.charAt(0)===t&&(n=n.substring(1))),this._parts[e]=n,this.build(!r),this)}}var g=r&&r.URI;i.version="1.17.0";var y=i.prototype,v=Object.prototype.hasOwnProperty;i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}},i.duplicateQueryParameters=!1,i.escapeQuerySpace=!0,i.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,i.idn_expression=/[^a-z0-9\.-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,i.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/},i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},i.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},i.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return i.domAttributes[t]}},i.encode=f,i.decode=decodeURIComponent,i.iso8859=function(){i.encode=escape,i.decode=unescape},i.unicode=function(){i.encode=f,i.decode=decodeURIComponent},i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},i.encodeQuery=function(e,t){var n=i.encode(e+"");return void 0===t&&(t=i.escapeQuerySpace),t?n.replace(/%20/g,"+"):n},i.decodeQuery=function(e,t){e+="",void 0===t&&(t=i.escapeQuerySpace);try{return i.decode(t?e.replace(/\+/g,"%20"):e)}catch(n){return e}};var w,b={encode:"encode",decode:"decode"},k=function(e,t){return function(n){try{return i[t](n+"").replace(i.characters[e][t].expression,function(n){return i.characters[e][t].map[n]})}catch(r){return n}}};for(w in b)i[w+"PathSegment"]=k("pathname",b[w]),i[w+"UrnPathSegment"]=k("urnpath",b[w]);var _=function(e,t,n){return function(r){var o;o=n?function(e){return i[t](i[n](e))}:i[t];for(var a=(r+"").split(e),s=0,c=a.length;c>s;s++)a[s]=o(a[s]);return a.join(e)}};i.decodePath=_("/","decodePathSegment"),i.decodeUrnPath=_(":","decodeUrnPathSegment"),i.recodePath=_("/","encodePathSegment","decode"),i.recodeUrnPath=_(":","encodeUrnPathSegment","decode"),i.encodeReserved=k("reserved","encode"),i.parse=function(e,t){var n;return t||(t={}),n=e.indexOf("#"),n>-1&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n)),n=e.indexOf("?"),n>-1&&(t.query=e.substring(n+1)||null,e=e.substring(0,n)),"//"===e.substring(0,2)?(t.protocol=null,e=e.substring(2),e=i.parseAuthority(e,t)):(n=e.indexOf(":"),n>-1&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(i.protocol_expression)?t.protocol=void 0:"//"===e.substring(n+1,n+3)?(e=e.substring(n+3),e=i.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0))),t.path=e,t},i.parseHost=function(e,t){e=e.replace(/\\/g,"/");var n,r,i=e.indexOf("/");if(-1===i&&(i=e.length),"["===e.charAt(0))n=e.indexOf("]"),t.hostname=e.substring(1,n)||null,t.port=e.substring(n+2,i)||null,"/"===t.port&&(t.port=null);else{var o=e.indexOf(":"),a=e.indexOf("/"),s=e.indexOf(":",o+1);-1!==s&&(-1===a||a>s)?(t.hostname=e.substring(0,i)||null,t.port=null):(r=e.substring(0,i).split(":"),t.hostname=r[0]||null,t.port=r[1]||null)}return t.hostname&&"/"!==e.substring(i).charAt(0)&&(i++,e="/"+e),e.substring(i)||"/"},i.parseAuthority=function(e,t){return e=i.parseUserinfo(e,t),i.parseHost(e,t)},i.parseUserinfo=function(e,t){var n,r=e.indexOf("/"),o=e.lastIndexOf("@",r>-1?r:e.length-1);return o>-1&&(-1===r||r>o)?(n=e.substring(0,o).split(":"),t.username=n[0]?i.decode(n[0]):null,n.shift(),t.password=n[0]?i.decode(n.join(":")):null,e=e.substring(o+1)):(t.username=null,t.password=null),e},i.parseQuery=function(e,t){if(!e)return{};if(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!e)return{};for(var n,r,o,a={},s=e.split("&"),c=s.length,u=0;c>u;u++)n=s[u].split("="),r=i.decodeQuery(n.shift(),t),o=n.length?i.decodeQuery(n.join("="),t):null,v.call(a,r)?(("string"==typeof a[r]||null===a[r])&&(a[r]=[a[r]]),a[r].push(o)):a[r]=o;return a},i.build=function(e){var t="";return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//"),t+=i.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&"string"==typeof e.hostname&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},i.buildHost=function(e){var t="";return e.hostname?(t+=i.ip6_expression.test(e.hostname)?"["+e.hostname+"]":e.hostname,e.port&&(t+=":"+e.port),t):""},i.buildAuthority=function(e){return i.buildUserinfo(e)+i.buildHost(e)},i.buildUserinfo=function(e){var t="";return e.username&&(t+=i.encode(e.username),e.password&&(t+=":"+i.encode(e.password)),t+="@"),t},i.buildQuery=function(e,t,n){var r,o,a,c,u="";for(o in e)if(v.call(e,o)&&o)if(s(e[o]))for(r={},a=0,c=e[o].length;c>a;a++)void 0!==e[o][a]&&void 0===r[e[o][a]+""]&&(u+="&"+i.buildQueryParameter(o,e[o][a],n),t!==!0&&(r[e[o][a]+""]=!0));else void 0!==e[o]&&(u+="&"+i.buildQueryParameter(o,e[o],n));return u.substring(1)},i.buildQueryParameter=function(e,t,n){return i.encodeQuery(e,n)+(null!==t?"="+i.encodeQuery(t,n):"")},i.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)v.call(t,r)&&i.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=n);"string"==typeof e[t]&&(e[t]=[e[t]]),s(n)||(n=[n]),e[t]=(e[t]||[]).concat(n)}},i.removeQuery=function(e,t,n){var r,o,u;if(s(t))for(r=0,o=t.length;o>r;r++)e[t[r]]=void 0;else if("RegExp"===a(t))for(u in e)t.test(u)&&(e[u]=void 0);else if("object"==typeof t)for(u in t)v.call(t,u)&&i.removeQuery(e,u,t[u]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===a(n)?!s(e[t])&&n.test(e[t])?e[t]=void 0:e[t]=c(e[t],n):e[t]!==String(n)||s(n)&&1!==n.length?s(e[t])&&(e[t]=c(e[t],n)):e[t]=void 0:e[t]=void 0}},i.hasQuery=function(e,t,n,r){if("object"==typeof t){for(var o in t)if(v.call(t,o)&&!i.hasQuery(e,o,t[o]))return!1;return!0}if("string"!=typeof t)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(a(n)){case"Undefined":return t in e;case"Boolean":var c=Boolean(s(e[t])?e[t].length:e[t]);return n===c;case"Function":return!!n(e[t],t,e);case"Array":if(!s(e[t]))return!1;var d=r?u:l;return d(e[t],n);case"RegExp":return s(e[t])?r?u(e[t],n):!1:Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return s(e[t])?r?u(e[t],n):!1:e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},i.commonPath=function(e,t){var n,r=Math.min(e.length,t.length);for(n=0;r>n;n++)if(e.charAt(n)!==t.charAt(n)){n--;break}return 1>n?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":(("/"!==e.charAt(n)||"/"!==t.charAt(n))&&(n=e.substring(0,n).lastIndexOf("/")),e.substring(0,n+1))},i.withinString=function(e,t,n){n||(n={});var r=n.start||i.findUri.start,o=n.end||i.findUri.end,a=n.trim||i.findUri.trim,s=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var c=r.exec(e);if(!c)break;var u=c.index;if(n.ignoreHtml){var l=e.slice(Math.max(u-3,0),u);if(l&&s.test(l))continue}var d=u+e.slice(u).search(o),p=e.slice(u,d).replace(a,"");if(!n.ignore||!n.ignore.test(p)){d=u+p.length;var f=t(p,u,d,e);e=e.slice(0,u)+f+e.slice(d),r.lastIndex=u+f.length}}return r.lastIndex=0,e},i.ensureValidHostname=function(t){if(t.match(i.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(e.toASCII(t).match(i.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]')}},i.noConflict=function(e){if(e){var t={URI:this.noConflict()};return r.URITemplate&&"function"==typeof r.URITemplate.noConflict&&(t.URITemplate=r.URITemplate.noConflict()),r.IPv6&&"function"==typeof r.IPv6.noConflict&&(t.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&"function"==typeof r.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=r.SecondLevelDomains.noConflict()),t}return r.URI===this&&(r.URI=g),this},y.build=function(e){return e===!0?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=i.build(this._parts),this._deferred_build=!1),this},y.clone=function(){return new i(this)},y.valueOf=y.toString=function(){return this.build(!1)._string},y.protocol=h("protocol"),y.username=h("username"),y.password=h("password"),y.hostname=h("hostname"),y.port=h("port"),y.query=m("query","?"),y.fragment=m("fragment","#"),y.search=function(e,t){var n=this.query(e,t);return"string"==typeof n&&n.length?"?"+n:n},y.hash=function(e,t){var n=this.fragment(e,t);return"string"==typeof n&&n.length?"#"+n:n},y.pathname=function(e,t){if(void 0===e||e===!0){var n=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?i.decodeUrnPath:i.decodePath)(n):n}return this._parts.urn?this._parts.path=e?i.recodeUrnPath(e):"":this._parts.path=e?i.recodePath(e):"/",this.build(!t),this},y.path=y.pathname,y.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="",this._parts=i._parts();var r=e instanceof i,o="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName){var a=i.getDomAttribute(e);e=e[a]||"",o=!1}if(!r&&o&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=i.parse(String(e),this._parts);else{if(!r&&!o)throw new TypeError("invalid input");var s=r?e._parts:e;for(n in s)v.call(this._parts,n)&&(this._parts[n]=s[n])}return this.build(!t),this},y.is=function(e){var t=!1,r=!1,o=!1,a=!1,s=!1,c=!1,u=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,r=i.ip4_expression.test(this._parts.hostname),o=i.ip6_expression.test(this._parts.hostname),t=r||o,a=!t,s=a&&n&&n.has(this._parts.hostname),c=a&&i.idn_expression.test(this._parts.hostname),u=a&&i.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return a;case"sld":return s;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return o;case"idn":return c;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return u}return null};var x=y.protocol,S=y.port,A=y.hostname;y.protocol=function(e,t){if(void 0!==e&&e&&(e=e.replace(/:(\/\/)?$/,""),!e.match(i.protocol_expression)))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return x.call(this,e,t)},y.scheme=y.protocol,y.port=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),e.match(/[^0-9]/))))throw new TypeError('Port "'+e+'" contains characters other than [0-9]');return S.call(this,e,t)},y.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={},r=i.parseHost(e,n);if("/"!==r)throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=n.hostname}return A.call(this,e,t)},y.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=this.protocol(),r=this.authority();return r?(n?n+"://":"")+this.authority():""}var o=i(e);return this.protocol(o.protocol()).authority(o.authority()).build(!t),this},y.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildHost(this._parts):"";var n=i.parseHost(e,this._parts);if("/"!==n)throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},y.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildAuthority(this._parts):"";var n=i.parseAuthority(e,this._parts);if("/"!==n)throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},y.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.username)return"";var n=i.buildUserinfo(this._parts);return n.substring(0,n.length-1)}return"@"!==e[e.length-1]&&(e+="@"),i.parseUserinfo(e,this._parts),this.build(!t),this},y.resource=function(e,t){var n;return void 0===e?this.path()+this.search()+this.hash():(n=i.parse(e),this._parts.path=n.path,this._parts.query=n.query,this._parts.fragment=n.fragment,this.build(!t),this)},y.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}var r=this._parts.hostname.length-this.domain().length,a=this._parts.hostname.substring(0,r),s=new RegExp("^"+o(a));return e&&"."!==e.charAt(e.length-1)&&(e+="."),e&&i.ensureValidHostname(e),this._parts.hostname=this._parts.hostname.replace(s,e),this.build(!t),this},y.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&n.length<2)return this._parts.hostname;var r=this._parts.hostname.length-this.tld(t).length-1;return r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||""}if(!e)throw new TypeError("cannot set domain empty");if(i.ensureValidHostname(e),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var a=new RegExp(o(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(a,e)}return this.build(!t),this},y.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),i=this._parts.hostname.substring(r+1);return t!==!0&&n&&n.list[i.toLowerCase()]?n.get(this._parts.hostname)||i:i}var a;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');a=new RegExp(o(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(a,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");a=new RegExp(o(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(a,e)}return this.build(!t),this},y.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?i.decodePath(r):r}var a=this._parts.path.length-this.filename().length,s=this._parts.path.substring(0,a),c=new RegExp("^"+o(s));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=i.recodePath(e),this._parts.path=this._parts.path.replace(c,e),this.build(!t),this},y.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(n+1);return e?i.decodePathSegment(r):r}var a=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(a=!0);var s=new RegExp(o(this.filename())+"$");return e=i.recodePath(e),this._parts.path=this._parts.path.replace(s,e),a?this.normalizePath(t):this.build(!t),this},y.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path||"/"===this._parts.path)return"";var n,r,a=this.filename(),s=a.lastIndexOf(".");return-1===s?"":(n=a.substring(s+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",e?i.decodePathSegment(r):r)}"."===e.charAt(0)&&(e=e.substring(1));var c,u=this.suffix();if(u)c=e?new RegExp(o(u)+"$"):new RegExp(o("."+u)+"$");else{if(!e)return this;this._parts.path+="."+i.recodePath(e)}return c&&(e=i.recodePath(e),this._parts.path=this._parts.path.replace(c,e)),this.build(!t),this},y.segment=function(e,t,n){var r=this._parts.urn?":":"/",i=this.path(),o="/"===i.substring(0,1),a=i.split(r);if(void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(o&&a.shift(),0>e&&(e=Math.max(a.length+e,0)),void 0===t)return void 0===e?a:a[e];if(null===e||void 0===a[e])if(s(t)){a=[];for(var c=0,u=t.length;u>c;c++)(t[c].length||a.length&&a[a.length-1].length)&&(a.length&&!a[a.length-1].length&&a.pop(),a.push(d(t[c])))}else(t||"string"==typeof t)&&(t=d(t),""===a[a.length-1]?a[a.length-1]=t:a.push(t));else t?a[e]=d(t):a.splice(e,1);return o&&a.unshift(""),this.path(a.join(r),n)},y.segmentCoded=function(e,t,n){var r,o,a;if("number"!=typeof e&&(n=t,t=e,e=void 0),void 0===t){if(r=this.segment(e,t,n),s(r))for(o=0,a=r.length;a>o;o++)r[o]=i.decode(r[o]);else r=void 0!==r?i.decode(r):void 0;return r}if(s(t))for(o=0,a=t.length;a>o;o++)t[o]=i.encode(t[o]);else t="string"==typeof t||t instanceof String?i.encode(t):t;return this.segment(e,t,n)};var R=y.query;return y.query=function(e,t){if(e===!0)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);return this._parts.query=i.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=i.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):R.call(this,e,t)},y.setQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)r[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var o in e)v.call(e,o)&&(r[o]=e[o])}return this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},y.addQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.addQuery(r,e,void 0===t?null:t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},y.removeQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.removeQuery(r,e,t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},y.hasQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(r,e,t,n)},y.setSearch=y.setQuery,y.addSearch=y.addQuery,y.removeSearch=y.removeQuery,y.hasSearch=y.hasQuery,y.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},y.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},y.normalizeHostname=function(n){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n)),this},y.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},y.normalizePath=function(e){var t=this._parts.path;if(!t)return this;if(this._parts.urn)return this._parts.path=i.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var n,r,o,a="";for("/"!==t.charAt(0)&&(n=!0,t="/"+t),("/.."===t.slice(-3)||"/."===t.slice(-2))&&(t+="/"),t=t.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),n&&(a=t.substring(1).match(/^(\.\.\/)+/)||"",a&&(a=a[0]));;){if(r=t.indexOf("/.."),-1===r)break;0!==r?(o=t.substring(0,r).lastIndexOf("/"),-1===o&&(o=r),t=t.substring(0,o)+t.substring(r+3)):t=t.substring(3)}return n&&this.is("relative")&&(t=a+t.substring(1)),t=i.recodePath(t),this._parts.path=t,this.build(!e),this},y.normalizePathname=y.normalizePath,y.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},y.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},y.normalizeSearch=y.normalizeQuery,y.normalizeHash=y.normalizeFragment,y.iso8859=function(){var e=i.encode,t=i.decode;i.encode=escape,i.decode=decodeURIComponent;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},y.unicode=function(){var e=i.encode,t=i.decode;i.encode=f,i.decode=unescape;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},y.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";if(t._parts.protocol&&(n+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/"),n+=t.path(!0),t._parts.query){for(var r="",o=0,a=t._parts.query.split("&"),s=a.length;s>o;o++){var c=(a[o]||"").split("=");r+="&"+i.decodeQuery(c[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==c[1]&&(r+="="+i.decodeQuery(c[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+=i.decodeQuery(t.hash(),!0)},y.absoluteTo=function(e){var t,n,r,o=this.clone(),a=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof i||(e=new i(e)),o._parts.protocol||(o._parts.protocol=e._parts.protocol),this._parts.hostname)return o;for(n=0;r=a[n];n++)o._parts[r]=e._parts[r];return o._parts.path?".."===o._parts.path.substring(-2)&&(o._parts.path+="/"):(o._parts.path=e._parts.path,o._parts.query||(o._parts.query=e._parts.query)),"/"!==o.path().charAt(0)&&(t=e.directory(),t=t?t:0===e.path().indexOf("/")?"/":"",o._parts.path=(t?t+"/":"")+o._parts.path,o.normalizePath()),o.build(),o},y.relativeTo=function(e){var t,n,r,o,a,s=this.clone().normalize();if(s._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new i(e).normalize(),t=s._parts,n=e._parts,o=s.path(),a=e.path(),"/"!==o.charAt(0))throw new Error("URI is already relative");if("/"!==a.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===n.protocol&&(t.protocol=null),t.username!==n.username||t.password!==n.password)return s.build();if(null!==t.protocol||null!==t.username||null!==t.password)return s.build();if(t.hostname!==n.hostname||t.port!==n.port)return s.build();if(t.hostname=null,t.port=null,o===a)return t.path="",s.build();if(r=i.commonPath(o,a),!r)return s.build();var c=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=c+t.path.substring(r.length)||"./",s.build()},y.equals=function(e){var t,n,r,o=this.clone(),a=new i(e),c={},u={},d={};if(o.normalize(),a.normalize(),o.toString()===a.toString())return!0;if(t=o.query(),n=a.query(),o.query(""),a.query(""),o.toString()!==a.toString())return!1;if(t.length!==n.length)return!1;c=i.parseQuery(t,this._parts.escapeQuerySpace),u=i.parseQuery(n,this._parts.escapeQuerySpace);for(r in c)if(v.call(c,r)){if(s(c[r])){if(!l(c[r],u[r]))return!1}else if(c[r]!==u[r])return!1;d[r]=!0}for(r in u)if(v.call(u,r)&&!d[r])return!1;return!0},y.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},y.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},i}),function(e,t){"use strict";"object"==typeof exports?module.exports=t(require("./URI")):"function"==typeof define&&define.amd?define(["./URI"],t):e.URITemplate=t(e.URI,e)}(this,function(e,t){"use strict";function n(e){return n._cache[e]?n._cache[e]:this instanceof n?(this.expression=e,n._cache[e]=this,this):new n(e)}function r(e){this.data=e,this.cache={}}var i=t&&t.URITemplate,o=Object.prototype.hasOwnProperty,a=n.prototype,s={"":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encode"},"+":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encodeReserved"},"#":{prefix:"#",separator:",",named:!1,empty_name_separator:!1,encode:"encodeReserved"},".":{prefix:".",separator:".",named:!1,empty_name_separator:!1,encode:"encode"},"/":{prefix:"/",separator:"/",named:!1,empty_name_separator:!1,encode:"encode"},";":{prefix:";",separator:";",named:!0,empty_name_separator:!1,encode:"encode"},"?":{prefix:"?",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"},"&":{prefix:"&",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"}};return n._cache={},n.EXPRESSION_PATTERN=/\{([^a-zA-Z0-9%_]?)([^\}]+)(\}|$)/g,n.VARIABLE_PATTERN=/^([^*:]+)((\*)|:(\d+))?$/,n.VARIABLE_NAME_PATTERN=/[^a-zA-Z0-9%_]/,n.expand=function(e,t){var r,i,o,a=s[e.operator],c=a.named?"Named":"Unnamed",u=e.variables,l=[];for(o=0;i=u[o];o++)r=t.get(i.name),r.val.length?l.push(n["expand"+c](r,a,i.explode,i.explode&&a.separator||",",i.maxlength,i.name)):r.type&&l.push("");return l.length?a.prefix+l.join(a.separator):""},n.expandNamed=function(t,n,r,i,o,a){var s,c,u,l="",d=n.encode,p=n.empty_name_separator,f=!t[d].length,h=2===t.type?"":e[d](a);for(c=0,u=t.val.length;u>c;c++)o?(s=e[d](t.val[c][1].substring(0,o)),2===t.type&&(h=e[d](t.val[c][0].substring(0,o)))):f?(s=e[d](t.val[c][1]),2===t.type?(h=e[d](t.val[c][0]),t[d].push([h,s])):t[d].push([void 0,s])):(s=t[d][c][1],2===t.type&&(h=t[d][c][0])),l&&(l+=i),r?l+=h+(p||s?"=":"")+s:(c||(l+=e[d](a)+(p||s?"=":"")),2===t.type&&(l+=h+","),l+=s);return l},n.expandUnnamed=function(t,n,r,i,o){var a,s,c,u,l="",d=n.encode,p=n.empty_name_separator,f=!t[d].length;for(c=0,u=t.val.length;u>c;c++)o?s=e[d](t.val[c][1].substring(0,o)):f?(s=e[d](t.val[c][1]),t[d].push([2===t.type?e[d](t.val[c][0]):void 0,s])):s=t[d][c][1],l&&(l+=i),2===t.type&&(a=o?e[d](t.val[c][0].substring(0,o)):t[d][c][0],l+=a,l+=r?p||s?"=":"":","),l+=s;return l},n.noConflict=function(){return t.URITemplate===n&&(t.URITemplate=i),n},a.expand=function(e){var t="";this.parts&&this.parts.length||this.parse(),e instanceof r||(e=new r(e));for(var i=0,o=this.parts.length;o>i;i++)t+="string"==typeof this.parts[i]?this.parts[i]:n.expand(this.parts[i],e);return t},a.parse=function(){var e,t,r,i=this.expression,o=n.EXPRESSION_PATTERN,a=n.VARIABLE_PATTERN,c=n.VARIABLE_NAME_PATTERN,u=[],l=0;for(o.lastIndex=0;;){if(t=o.exec(i),null===t){u.push(i.substring(l));break}if(u.push(i.substring(l,t.index)),l=t.index+t[0].length,!s[t[1]])throw new Error('Unknown Operator "'+t[1]+'" in "'+t[0]+'"');if(!t[3])throw new Error('Unclosed Expression "'+t[0]+'"');e=t[2].split(",");for(var d=0,p=e.length;p>d;d++){if(r=e[d].match(a),null===r)throw new Error('Invalid Variable "'+e[d]+'" in "'+t[0]+'"');if(r[1].match(c))throw new Error('Invalid Variable Name "'+r[1]+'" in "'+t[0]+'"');e[d]={name:r[1],explode:!!r[3],maxlength:r[4]&&parseInt(r[4],10)}}if(!e.length)throw new Error('Expression Missing Variable(s) "'+t[0]+'"');u.push({expression:t[0],operator:t[1],variables:e})}return u.length||u.push(i),this.parts=u,this},r.prototype.get=function(e){var t,n,r,i=this.data,a={type:0,val:[],encode:[],encodeReserved:[]};if(void 0!==this.cache[e])return this.cache[e];if(this.cache[e]=a,r="[object Function]"===String(Object.prototype.toString.call(i))?i(e):"[object Function]"===String(Object.prototype.toString.call(i[e]))?i[e](e):i[e],
void 0===r||null===r)return a;if("[object Array]"===String(Object.prototype.toString.call(r))){for(t=0,n=r.length;n>t;t++)void 0!==r[t]&&null!==r[t]&&a.val.push([void 0,String(r[t])]);a.val.length&&(a.type=3)}else if("[object Object]"===String(Object.prototype.toString.call(r))){for(t in r)o.call(r,t)&&void 0!==r[t]&&null!==r[t]&&a.val.push([t,String(r[t])]);a.val.length&&(a.type=2)}else a.type=1,a.val.push([void 0,String(r)]);return a},e.expand=function(t,r){var i=new n(t),o=i.expand(r);return new e(o)},n}),function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function e(e){return function(){return $.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===te(e)||e instanceof B}function r(e,t){if(L&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ne)){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var o=n.join("\n"+ne+"\n");e.stack=i(o)}}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];s(i)||o(i)||!i||n.push(i)}return n.join("\n")}function o(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function s(e){var t=a(e);if(!t)return!1;var n=t[0],r=t[1];return n===q&&r>=V&&ae>=r}function c(){if(L)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=a(n);if(!r)return;return q=r[0],r[1]}}function u(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function l(e){return y(e)?e:v(e)?I(e):R(e)}function d(){function e(e){t=e,o.source=e,K(n,function(t,n){H(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],i=Y(d.prototype),o=Y(h.prototype);if(o.promiseDispatch=function(e,i,o){var a=J(arguments);n?(n.push(a),"when"===i&&o[1]&&r.push(o[1])):H(function(){t.promiseDispatch.apply(t,a)})},o.valueOf=function(){if(n)return o;var e=g(t);return y(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},l.longStackSupport&&L)try{throw new Error}catch(a){o.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(n){t||e(l(n))},i.fulfill=function(n){t||e(R(n))},i.reject=function(n){t||e(A(n))},i.notify=function(e){t||K(r,function(t,n){H(function(){n(e)})},void 0)},i}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=d();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function f(e){return p(function(t,n){for(var r=0,i=e.length;i>r;r++)l(e[r]).then(t,n)})}function h(e,t,n){void 0===t&&(t=function(e){return A(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=Y(h.prototype);if(r.promiseDispatch=function(n,i,o){var a;try{a=e[i]?e[i].apply(r,o):t.call(r,i,o)}catch(s){a=A(s)}n&&n(a)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function m(e,t,n,r){return l(e).then(t,n,r)}function g(e){if(y(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function y(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function v(e){return t(e)&&"function"==typeof e.then}function w(e){return y(e)&&"pending"===e.inspect().state}function b(e){return!y(e)||"fulfilled"===e.inspect().state}function k(e){return y(e)&&"rejected"===e.inspect().state}function _(){re.length=0,ie.length=0,oe||(oe=!0)}function x(e,t){oe&&(ie.push(e),t&&"undefined"!=typeof t.stack?re.push(t.stack):re.push("(no stack) "+t))}function S(e){if(oe){var t=X(ie,e);-1!==t&&(ie.splice(t,1),re.splice(t,1))}}function A(e){var t=h({when:function(t){return t&&S(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return x(t,e),t}function R(e){return h({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return ee(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function I(e){var t=d();return H(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function E(e){return h({isDef:function(){}},function(t,n){return C(e,t,n)},function(){return l(e).inspect()})}function P(e,t,n){return l(e).spread(t,n)}function D(e){return function(){function t(e,t){var a;if("undefined"==typeof StopIteration){try{a=r[e](t)}catch(s){return A(s)}return a.done?a.value:m(a.value,i,o)}try{a=r[e](t)}catch(s){return n(s)?s.value:A(s)}return m(a,i,o)}var r=e.apply(this,arguments),i=t.bind(t,"next"),o=t.bind(t,"throw");return i()}}function j(e){l.done(l.async(e)())}function T(e){throw new B(e)}function O(e){return function(){return P([this,U(arguments)],function(t,n){return e.apply(t,n)})}}function C(e,t,n){return l(e).dispatch(t,n)}function U(e){return m(e,function(e){var t=0,n=d();return K(e,function(r,i,o){var a;y(i)&&"fulfilled"===(a=i.inspect()).state?e[o]=a.value:(++t,m(i,function(r){e[o]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:o,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function F(e){return m(e,function(e){return e=Z(e,l),m(U(Z(e,function(e){return m(e,G,G)})),function(){return e})})}function z(e){return l(e).allSettled()}function Q(e,t){return l(e).then(void 0,void 0,t)}function N(e,t){return l(e).nodeify(t)}var L=!1;try{throw new Error}catch(M){L=!!M.stack}var q,B,V=c(),G=function(){},H=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var i=t.domain;i&&(t.domain=void 0,i.enter());try{n()}catch(a){if(o)throw i&&i.exit(),setTimeout(e,0),i&&i.enter(),a;setTimeout(function(){throw a},0)}i&&i.exit()}r=!1}var t={task:void 0,next:null},n=t,r=!1,i=void 0,o=!1;if(H=function(e){n=n.next={task:e,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(e)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){i=s,a.port1.onmessage=e,e()};var s=function(){a.port2.postMessage(0)};i=function(){setTimeout(e,0),s()}}else i=function(){setTimeout(e,0)};return H}(),$=Function.call,J=e(Array.prototype.slice),K=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(t=e(t,this[n],n));return t}),X=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Z=e(Array.prototype.map||function(e,t){var n=this,r=[];return K(n,function(i,o,a){r.push(e.call(t,o,a,n))},void 0),r}),Y=Object.create||function(e){function t(){}return t.prototype=e,new t},W=e(Object.prototype.hasOwnProperty),ee=Object.keys||function(e){var t=[];for(var n in e)W(e,n)&&t.push(n);return t},te=e(Object.prototype.toString);B="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ne="From previous event:";l.resolve=l,l.nextTick=H,l.longStackSupport=!1,l.defer=d,d.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(J(arguments,1)):e.resolve(n)}},l.Promise=p,l.promise=p,p.race=f,p.all=U,p.reject=A,p.resolve=l,l.passByCopy=function(e){return e},h.prototype.passByCopy=function(){return this},l.join=function(e,t){return l(e).join(t)},h.prototype.join=function(e){return l([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},l.race=f,h.prototype.race=function(){return this.then(l.race)},l.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(e,t,n){function i(t){try{return"function"==typeof e?e(t):t}catch(n){return A(n)}}function o(e){if("function"==typeof t){r(e,s);try{return t(e)}catch(n){return A(n)}}return A(e)}function a(e){return"function"==typeof n?n(e):e}var s=this,c=d(),u=!1;return H(function(){s.promiseDispatch(function(e){u||(u=!0,c.resolve(i(e)))},"when",[function(e){u||(u=!0,c.resolve(o(e)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||c.notify(t)}]),c.promise},l.when=m,h.prototype.thenResolve=function(e){return this.then(function(){return e})},l.thenResolve=function(e,t){return l(e).thenResolve(t)},h.prototype.thenReject=function(e){return this.then(function(){throw e})},l.thenReject=function(e,t){return l(e).thenReject(t)},l.nearer=g,l.isPromise=y,l.isPromiseAlike=v,l.isPending=w,h.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=b,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=k,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var re=[],ie=[],oe=!0;l.resetUnhandledRejections=_,l.getUnhandledReasons=function(){return re.slice()},l.stopUnhandledRejectionTracking=function(){_(),oe=!1},_(),l.reject=A,l.fulfill=R,l.master=E,l.spread=P,h.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},l.async=D,l.spawn=j,l["return"]=T,l.promised=O,l.dispatch=C,h.prototype.dispatch=function(e,t){var n=this,r=d();return H(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},l.get=function(e,t){return l(e).dispatch("get",[t])},h.prototype.get=function(e){return this.dispatch("get",[e])},l.set=function(e,t,n){return l(e).dispatch("set",[t,n])},h.prototype.set=function(e,t){return this.dispatch("set",[e,t])},l.del=l["delete"]=function(e,t){return l(e).dispatch("delete",[t])},h.prototype.del=h.prototype["delete"]=function(e){return this.dispatch("delete",[e])},l.mapply=l.post=function(e,t,n){return l(e).dispatch("post",[t,n])},h.prototype.mapply=h.prototype.post=function(e,t){return this.dispatch("post",[e,t])},l.send=l.mcall=l.invoke=function(e,t){return l(e).dispatch("post",[t,J(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(e){return this.dispatch("post",[e,J(arguments,1)])},l.fapply=function(e,t){return l(e).dispatch("apply",[void 0,t])},h.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},l["try"]=l.fcall=function(e){return l(e).dispatch("apply",[void 0,J(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},l.fbind=function(e){var t=l(e),n=J(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(J(arguments))])}},h.prototype.fbind=function(){var e=this,t=J(arguments);return function(){return e.dispatch("apply",[this,t.concat(J(arguments))])}},l.keys=function(e){return l(e).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},l.all=U,h.prototype.all=function(){return U(this)},l.allResolved=u(F,"allResolved","allSettled"),h.prototype.allResolved=function(){return F(this)},l.allSettled=z,h.prototype.allSettled=function(){return this.then(function(e){return U(Z(e,function(e){function t(){return e.inspect()}return e=l(e),e.then(t,t)}))})},l.fail=l["catch"]=function(e,t){return l(e).then(void 0,t)},h.prototype.fail=h.prototype["catch"]=function(e){return this.then(void 0,e)},l.progress=Q,h.prototype.progress=function(e){return this.then(void 0,void 0,e)},l.fin=l["finally"]=function(e,t){return l(e)["finally"](t)},h.prototype.fin=h.prototype["finally"]=function(e){return e=l(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},l.done=function(e,t,n,r){return l(e).done(t,n,r)},h.prototype.done=function(e,t,n){var i=function(e){H(function(){if(r(e,o),!l.onerror)throw e;l.onerror(e)})},o=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},l.timeout=function(e,t,n){return l(e).timeout(t,n)},h.prototype.timeout=function(e,t){var n=d(),r=setTimeout(function(){n.reject(new Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},l.delay=function(e,t){return void 0===t&&(t=e,e=void 0),l(e).delay(t)},h.prototype.delay=function(e){return this.then(function(t){var n=d();return setTimeout(function(){n.resolve(t)},e),n.promise})},l.nfapply=function(e,t){return l(e).nfapply(t)},h.prototype.nfapply=function(e){var t=d(),n=J(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},l.nfcall=function(e){var t=J(arguments,1);return l(e).nfapply(t)},h.prototype.nfcall=function(){var e=J(arguments),t=d();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},l.nfbind=l.denodeify=function(e){var t=J(arguments,1);return function(){var n=t.concat(J(arguments)),r=d();return n.push(r.makeNodeResolver()),l(e).fapply(n).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var e=J(arguments);return e.unshift(this),l.denodeify.apply(void 0,e)},l.nbind=function(e,t){var n=J(arguments,2);return function(){function r(){return e.apply(t,arguments)}var i=n.concat(J(arguments)),o=d();return i.push(o.makeNodeResolver()),l(r).fapply(i).fail(o.reject),o.promise}},h.prototype.nbind=function(){var e=J(arguments,0);return e.unshift(this),l.nbind.apply(void 0,e)},l.nmapply=l.npost=function(e,t,n){return l(e).npost(t,n)},h.prototype.nmapply=h.prototype.npost=function(e,t){var n=J(t||[]),r=d();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(e,t){var n=J(arguments,2),r=d();return n.push(r.makeNodeResolver()),l(e).dispatch("post",[t,n]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(e){var t=J(arguments,1),n=d();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},l.nodeify=N,h.prototype.nodeify=function(e){return e?void this.then(function(t){H(function(){e(null,t)})},function(t){H(function(){e(t)})}):this};var ae=c();return l}),function(){"use strict";var e=["html","json","jsonp","script"],t=["connect","delete","get","head","options","patch","post","put","trace"],n=function o(){var e={},t={},n={url:function(e){return s.call(this,"url",e,r.string)},sync:function(e){return s.call(this,"sync",e,r.bool)},cache:function(e){return s.call(this,"cache",e,r.bool)},type:function(e){return s.call(this,"type",e,r.type)},header:function(t,n){return e.headers=e.headers||{},r.string(t),"undefined"!=typeof n?(r.string(n),e.headers[t]=n,this):e.headers[t]},auth:function(t,n){return r.string(t),r.string(n),e.auth={user:t,passwd:n},this},timeout:function(e){return s.call(this,"timeout",e,r.positiveInteger)},method:function(e){return s.call(this,"method",e,r.method)},queryString:function(e){return s.call(this,"queryString",e,r.queryString)},data:function(e){return s.call(this,"data",e,r.plainObject)},body:function(e){return s.call(this,"body",e,null,function(e){if("object"==typeof e){if(!(e instanceof FormData)){try{e=JSON.stringify(e)}catch(t){throw new TypeError("Unable to stringify body's content : "+t.name)}this.header("Content-Type","application/json")}}else e+="";return e})},into:function(e){return s.call(this,"into",e,r.selector,function(e){return"string"==typeof e?document.querySelectorAll(e):e instanceof HTMLElement?[e]:void 0})},jsonPaddingName:function(e){return s.call(this,"jsonPaddingName",e,r.string)},jsonPadding:function(e){return s.call(this,"jsonPadding",e,r.func)},on:function(e,n){return"function"==typeof n&&(t[e]=t[e]||[],t[e].push(n)),this},off:function(e){return t[e]=[],this},trigger:function(e,n){var r=this,i=function(e,n){t[e]instanceof Array&&t[e].forEach(function(e){e.call(r,n)})};if("undefined"!=typeof e){e+="";var o=/^([0-9])([0-9x])([0-9x])$/i,a=e.match(o);a&&a.length>3?Object.keys(t).forEach(function(e){var t=e.match(o);!(t&&t.length>3&&a[1]===t[1])||"x"!==t[2]&&a[2]!==t[2]||"x"!==t[3]&&a[3]!==t[3]||i(e,n)}):t[e]&&i(e,n)}return this},go:function(){var t=e.type||(e.into?"html":"json"),n=u();return"function"==typeof a[t]?a[t].call(this,n):void 0}},a={json:function(e){var t=this;a._xhr.call(this,e,function(e){if(e)try{e=JSON.parse(e)}catch(n){return t.trigger("error",n),null}return e})},html:function(t){a._xhr.call(this,t,function(t){return e.into&&e.into.length&&[].forEach.call(e.into,function(e){e.innerHTML=t}),t})},_xhr:function(t,n){var r,i,o,a,s,u=this,l=e.method||"get",d=e.sync!==!0,p=new XMLHttpRequest,f=e.data,h=e.body,m=(e.headers||{},this.header("Content-Type")),g=e.timeout;if(!m&&f&&c()&&(this.header("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),m=this.header("Content-Type")),f&&c())if("string"!=typeof h&&(h=""),m.indexOf("json")>-1)try{h=JSON.stringify(f)}catch(y){throw new TypeError("Unable to stringify body's content : "+y.name)}else{a=m&&m.indexOf("x-www-form-urlencoded")>1;for(r in f)h+=a?encodeURIComponent(r)+"="+encodeURIComponent(f[r])+"&":r+"="+f[r]+"\n\r"}s=[l,t,d],e.auth&&(s.push(e.auth.user),s.push(e.auth.passwd)),p.open.apply(p,s);for(i in e.headers)p.setRequestHeader(i,e.headers[i]);p.onprogress=function(e){e.lengthComputable&&u.trigger("progress",e.loaded/e.total)},p.onload=function(){var e=p.responseText;o&&clearTimeout(o),this.status>=200&&this.status<300&&("function"==typeof n&&(e=n(e)),u.trigger("success",e)),u.trigger(this.status,e),u.trigger("end",e)},p.onerror=function(e){o&&clearTimeout(o),u.trigger("error",e,arguments)},g&&(o=setTimeout(function(){u.trigger("timeout",{type:"timeout",expiredAfter:g},p,arguments),p.abort()},g)),p.send(h)},jsonp:function(t){var n,r=this,a=document.querySelector("head"),s=e.sync!==!0,c=e.jsonPaddingName||"callback",u=e.jsonPadding||"_padd"+(new Date).getTime()+Math.floor(1e4*Math.random()),l={};if(o[u])throw new Error("Padding "+u+"  already exists. It must be unique.");/^ajajsonp_/.test(u)||(u="ajajsonp_"+u),window[u]=function(e){r.trigger("success",e),a.removeChild(n),window[u]=void 0},l[c]=u,t=i(t,l),n=document.createElement("script"),n.async=s,n.src=t,n.onerror=function(){r.trigger("error",arguments),a.removeChild(n),window[u]=void 0},a.appendChild(n)},script:function(t){var n,r=this,i=document.querySelector("head")||document.querySelector("body"),o=e.sync!==!0;if(!i)throw new Error("Ok, wait a second, you want to load a script, but you don't have at least a head or body tag...");n=document.createElement("script"),n.async=o,n.src=t,n.onerror=function(){r.trigger("error",arguments),i.removeChild(n)},n.onload=function(){r.trigger("success",arguments)},i.appendChild(n)}},s=function(t,n,i,o){if("undefined"!=typeof n){if("function"==typeof i)try{n=i.call(r,n)}catch(a){throw new TypeError("Failed to set "+t+" : "+a.message)}return"function"==typeof o?e[t]=o.call(this,n):e[t]=n,this}return"undefined"===e[t]?null:e[t]},c=function(){return["delete","patch","post","put"].indexOf(e.method)>-1},u=function(){var t=e.url,n="undefined"!=typeof e.cache?!!e.cache:!0,r=e.queryString||"",o=e.data;return n===!1&&(r+="&ajabuster="+(new Date).getTime()),t=i(t,r),o&&!c()&&(t=i(t,o)),t};return n},r={bool:function(e){return!!e},string:function(e){if("string"!=typeof e)throw new TypeError("a string is expected, but "+e+" ["+typeof e+"] given");return e},positiveInteger:function(e){if(parseInt(e)!==e||0>=e)throw new TypeError("an integer is expected, but "+e+" ["+typeof e+"] given");return e},plainObject:function(e){if("object"!=typeof e||e.constructor!==Object)throw new TypeError("an object is expected, but "+e+"  ["+typeof e+"] given");return e},type:function(t){if(t=this.string(t),e.indexOf(t.toLowerCase())<0)throw new TypeError("a type in ["+e.join(", ")+"] is expected, but "+t+" given");return t.toLowerCase()},method:function(e){if(e=this.string(e),t.indexOf(e.toLowerCase())<0)throw new TypeError("a method in ["+t.join(", ")+"] is expected, but "+e+" given");return e.toLowerCase()},queryString:function(e){var t={};return"string"==typeof e?e.replace("?","").split("&").forEach(function(e){var n=e.split("=");2===n.length&&(t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]))}):t=e,this.plainObject(t)},selector:function(e){if("string"!=typeof e&&!(e instanceof HTMLElement))throw new TypeError("a selector or an HTMLElement is expected, "+e+" ["+typeof e+"] given");return e},func:function(e){if(e=this.string(e),!/^([a-zA-Z_])([a-zA-Z0-9_\-])+$/.test(e))throw new TypeError("a valid function name is expected, "+e+" ["+typeof e+"] given");return e}},i=function(e,t){var n;if(e=e||"",t)if(-1===e.indexOf("?")&&(e+="?"),"string"==typeof t)e+=t;else if("object"==typeof t)for(n in t)e+="&"+encodeURIComponent(n)+"="+encodeURIComponent(t[n]);return e};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof exports?module.exports=n:window.aja=window.aja||n}(),function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],c(e,t(i,this),t(o,this))}function r(e){var t=this;return null===this._state?void this._deferreds.push(e):void l(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void(t._state?e.resolve:e.reject)(t._value);var r;try{r=n(t._value)}catch(i){return void e.reject(i)}e.resolve(r)})}function i(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void c(t(n,e),t(i,this),t(o,this))}this._state=!0,this._value=e,a.call(this)}catch(r){o.call(this,r)}}function o(e){this._state=!1,this._value=e,a.call(this)}function a(){for(var e=0,t=this._deferreds.length;t>e;e++)r.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function c(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(i){if(r)return;r=!0,n(i)}}var u=setTimeout,l="function"==typeof setImmediate&&setImmediate||function(e){u(e,1)},d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var i=this;return new n(function(n,o){r.call(i,new s(e,t,n,o))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&d(arguments[0])?arguments[0]:arguments);return new n(function(t,n){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(o,e)},n)}e[o]=a,0===--i&&t(e)}catch(c){n(c)}}if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)r(o,e[o])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var r=0,i=e.length;i>r;r++)e[r].then(t,n)})},n._setImmediateFn=function(e){l=e},"undefined"!=typeof module&&module.exports?module.exports=n:e.Promise||(e.Promise=n)}(this),function(e,t){"use strict";var n=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var n=function(e,t,r){return 1===arguments.length?n.get(e):n.set(e,t,r)};return n._document=e.document,n._cacheKeyPrefix="cookey.",n._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),n.defaults={path:"/",secure:!1},n.get=function(e){n._cachedDocumentCookie!==n._document.cookie&&n._renewCache();var r=n._cache[n._cacheKeyPrefix+e];return r===t?t:decodeURIComponent(r)},n.set=function(e,r,i){return i=n._getExtendedOptions(i),i.expires=n._getExpiresDate(r===t?-1:i.expires),n._document.cookie=n._generateCookieString(e,r,i),n},n.expire=function(e,r){return n.set(e,t,r)},n._getExtendedOptions=function(e){return{path:e&&e.path||n.defaults.path,domain:e&&e.domain||n.defaults.domain,expires:e&&e.expires||n.defaults.expires,secure:e&&e.secure!==t?e.secure:n.defaults.secure}},n._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},n._getExpiresDate=function(e,t){if(t=t||new Date,"number"==typeof e?e=e===1/0?n._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!n._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},n._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var r=e+"="+t;return r+=n.path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":""},n._getCacheFromString=function(e){for(var r={},i=e?e.split("; "):[],o=0;o<i.length;o++){var a=n._getKeyValuePairFromCookieString(i[o]);r[n._cacheKeyPrefix+a.key]===t&&(r[n._cacheKeyPrefix+a.key]=a.value)}return r},n._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=0>t?e.length:t;var n,r=e.substr(0,t);try{n=decodeURIComponent(r)}catch(i){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+r+'"',i)}return{key:n,value:e.substr(t+1)}},n._renewCache=function(){n._cache=n._getCacheFromString(n._document.cookie),n._cachedDocumentCookie=n._document.cookie},n._areEnabled=function(){var e="cookies.js",t="1"===n.set(e,1).get(e);return n.expire(e),t},n.enabled=n._areEnabled(),n},r="object"==typeof e.document?n(e):n;"function"==typeof define&&define.amd?define(function(){return r}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=r),exports.Cookies=r):e.Cookies=r}("undefined"==typeof window?this:window),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.Stargate=t()}(this,function(){function e(e){u.type=e.type,u.networkState=navigator.connection.type}function t(){u.networkState=navigator.connection.type,"none"===navigator.connection.type?u.type="offline":u.type="online"}function n(){return a.file.readFileAsJSON(cordova.file.applicationDirectory+"www/manifest.json")}function r(){this.initialize=function(e,t,n){f("unimplemented"),n("unimplemented")},this.createBanner=function(e,t,n){f("unimplemented"),n("unimplemented")},this.hideBanner=function(e,t,n){f("unimplemented"),n("unimplemented")},this.removeBanner=function(e,t,n){f("unimplemented"),n("unimplemented")},this.showBannerAtSelectedPosition=function(e,t,n){f("unimplemented"),n("unimplemented")},this.showBannerAtGivenXY=function(e,t,n){f("unimplemented"),n("unimplemented")},this.registerAdEvents=function(e,t,n){f("unimplemented"),n("unimplemented")},this.prepareInterstitial=function(e,t,n){f("unimplemented"),n("unimplemented")},this.showInterstitial=function(e,t,n){f("unimplemented"),n("unimplemented")}}var i="0.2.0",o={},a={};!function(e){function t(e,n){this.level=t.levels[e.toUpperCase()],this.tag=n}t.levels={ALL:5,ERROR:4,WARN:3,INFO:2,DEBUG:1,OFF:0},t.prototype.e=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=t.levels.ERROR&&window.console.error.apply(console,e)},t.prototype.i=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=t.levels.WARN&&window.console.info.apply(console,e)},t.prototype.w=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=t.levels.INFO&&window.console.warn.apply(console,e)},t.prototype.d=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=t.levels.DEBUG&&window.console.log.apply(console,e)},t.prototype.setLevel=function(e){this.level=t.levels[e]},e?e.Logger=t:window.Logger=t}(a),function(e,t){function n(e){var t=e.map(function(e){return{fullPath:e.fullPath,path:e.toURL(),internalURL:e.toInternalURL(),isFile:e.isFile,isDirectory:e.isDirectory}});return 1==t.length?t[0]:t}var r,i={};return i.LOG=r=new t("ALL","[File - module]"),i.ERROR_MAP={1:"NOT_FOUND_ERR",2:"SECURITY_ERR",3:"ABORT_ERR",4:"NOT_READABLE_ERR",5:"ENCODING_ERR",6:"NO_MODIFICATION_ALLOWED_ERR",7:"INVALID_STATE_ERR",8:"SYNTAX_ERR",9:"INVALID_MODIFICATION_ERR",10:"QUOTA_EXCEEDED_ERR",11:"TYPE_MISMATCH_ERR",12:"PATH_EXISTS_ERR"},i.currentFileTransfer=null,i.resolveFS=function(e){return new Promise(function(t,n){window.resolveLocalFileSystemURL(e,t,n)})},i.appendToFile=function(e,t,r){return r=void 0===arguments[2]?!1:arguments[2],i.resolveFS(e).then(function(e){return new Promise(function(i,o){e.createWriter(function(a){r||a.seek(a.length);var s=new Blob([t],{type:"text/plain"});a.write(s),a.onerror=o,a.onabort=o,a.onwriteend=function(){i(n([e]))}},o)})})},i.readFileAsHTML=function(e){return i.readFile(e).then(function(e){return(new window.DOMParser).parseFromString(e,"text/html")})},i.readFileAsJSON=function(e){return i.readFile(e).then(function(e){try{return Promise.resolve(window.JSON.parse(e))}catch(t){return Promise.reject(t)}})},i.removeFile=function(e){return i.resolveFS(e).then(function(e){return new Promise(function(t,n){e.remove(function(e){t(null===e||"OK"===e)},n)})})},i.removeDir=function(e){return i.resolveFS(e).then(function(e){return new Promise(function(t,n){e.removeRecursively(function(e){t(null===e||"OK"===e)},n)})})},i._promiseZip=function(e,t,n){return r.d("PROMISEZIP:",arguments),new Promise(function(r,i){window.zip.unzip(e,t,function(e){0===e?r(!0):i(e)},n)})},i.download=function(e,t,r,o){var a=new window.FileTransfer;return a.onprogress=o,i.currentFileTransfer=a,new Promise(function(o,s){a.download(window.encodeURI(e),t+r,function(e){o(n([e])),i.currentFileTransfer=null},function(e){s(e),i.currentFileTransfer=null},!0)})},i.createDir=function(e,t){return i.resolveFS(e).then(function(e){return new Promise(function(r,i){e.getDirectory(t,{create:!0},function(e){r(n([e]))},i)})})},i.fileExists=function(e){return new Promise(function(t){window.resolveLocalFileSystemURL(e,function(e){t(e.isFile)},function(e){t(1!==e.code)})})},i.dirExists=function(e){return new Promise(function(t){window.resolveLocalFileSystemURL(e,function(e){t(e.isDirectory)},function(e){t(1!=e.code)})})},i.requestFileSystem=function(e,t){return new Promise(function(n,r){window.requestFileSystem(e,t,n,r)})},i.readDir=function(e){return i.resolveFS(e).then(function(e){return new Promise(function(t,r){var i=e.createReader();i.readEntries(function(e){t(n(e))},r)})})},i.readFile=function(e){return i.resolveFS(e).then(function(e){return new Promise(function(t,n){e.file(function(e){var r=new FileReader;r.onerror=n,r.onabort=n,r.onloadend=function(){var e=this.result;t(e)},r.readAsText(e)})})})},i.createFile=function(e,t){return i.resolveFS(e).then(function(e){return new Promise(function(r,i){e.getFile(t,{create:!0},function(e){r(n([e]))},i)})})},i.write=function(e,t){return i.appendToFile(e,t,!0)},i.moveDir=function(e,t){var n=t.substring(t.lastIndexOf("/")+1),o=t.replace(n,"");return r.d("moveDir:",o,n),Promise.all([i.resolveFS(e),i.resolveFS(o)]).then(function(e){
return r.d("moveDir: resolved entries",e),new Promise(function(t,r){e[0].moveTo(e[1],n,t,r)})})},i.copyFile=function(e,t){var n=t.substring(t.lastIndexOf("/")+1),o=t.replace(n,"");return Promise.all([i.resolveFS(e),i.resolveFS(o)]).then(function(e){return r.d("copyFileTo",e),new Promise(function(t,r){e[0].copyTo(e[1],n,t,r)})})},i.copyDir=function(e,t){var n=t.substring(t.lastIndexOf("/")+1),o=t.replace(n,"");return Promise.all([i.resolveFS(e),i.resolveFS(o)]).then(function(i){return r.d("copyDir",e,"in",t),new Promise(function(e,t){i[0].copyTo(i[1],n,e,t)})})},e.file=i,i}(a,a.Logger),function(e,t,n){"use strict";function r(){}function i(t){function r(){var t=e.createDir(g.BASE_DIR,"games"),n=e.createDir(g.BASE_DIR,"scripts");return Promise.all([t,n]).then(function(t){return v.d("GamesDir and ScriptsDir created",t),v.d("Getting SDK from:",y),Promise.all([e.download(y,t[1].path,"gfsdk.min.js"),e.copyDir(g.WWW_DIR+"gameover_template",g.BASE_DIR+"gameover_template"),e.copyDir(g.WWW_DIR+"plugins",g.SDK_DIR+"plugins"),e.copyFile(g.CORDOVAJS,g.SDK_DIR+"cordova.js"),e.copyFile(g.CORDOVA_PLUGINS_JS,g.SDK_DIR+"cordova_plugins.js"),e.copyFile(g.STARGATEJS,g.SDK_DIR+"stargate.js")])})}if(v.d("Initialized called with:",t),!e)return Promise.reject("Missing file module!");try{l=window.cordova.file.applicationStorageDirectory,d=window.cordova.file.cacheDirectory,p=window.cordova.file.tempDirectory,f=window.cordova.file.applicationDirectory+"www/",m=window.cordova.file.applicationDirectory+"www/js/stargate.js",h=window.cordova.file.dataDirectory}catch(i){return v.e(i),Promise.reject(i)}v.i("cordova JS dir to include",g.CORDOVAJS),"ios"==window.device.platform.toLowerCase()&&(l+="Documents/"),"android"==window.device.platform.toLowerCase()&&(p=d),g.SDK_DIR=l+"scripts/",g.SDK_RELATIVE_DIR="../../scripts/",g.GAMEOVER_RELATIVE_DIR="../../gameover_template/",g.GAMES_DIR=l+"games/",g.BASE_DIR=l,g.CACHE_DIR=d,g.TEMP_DIR=p,g.CORDOVAJS=f+"cordova.js",g.CORDOVA_PLUGINS_JS=f+"cordova_plugins.js",g.STARGATEJS=f+"js/stargate.js",g.DATA_DIR=h,g.GAMEOVER_DIR=g.BASE_DIR+"gameover_template/",g.WWW_DIR=f,n.game.GAMES_DIR=g.GAMES_DIR;var o=e.dirExists(g.GAMES_DIR),a=e.fileExists(g.SDK_DIR+"gfsdk.min.js");return Promise.all([o,a]).then(function(e){return e[0]||e[1]?Promise.resolve(!0):r()})}function o(t){return v.d("_getIndexHtmlById",g.GAMES_DIR+t),e.readDir(g.GAMES_DIR+t).then(function(e){return v.d("_getIndexHtmlById readDir",e),e.filter(function(e){var t=new RegExp(/index\.html$/i);return t.test(e.path)})})}function a(e){v.d("_removeRemoteSDK");for(var t,n=e.querySelectorAll("script"),r=0;r<n.length;r++)if(-1!==n[r].src.indexOf("gfsdk")){t=n[r],v.d("_removeRemoteSDK",t),t.parentNode.removeChild(t);break}return e}function s(e,t){e=a(e);var n,r=Array.isArray(t)===!1?[t]:t;v.d("injectScripts",r);var i=document.createElement("meta");i.httpEquiv="Content-Security-Policy",i.content="default-src * data: content: cdvfile: file: http: https: gap: https://ssl.gstatic.com 'unsafe-inline' 'unsafe-eval';style-src * cdvfile: http: https: 'unsafe-inline';",e.head.appendChild(i);for(var o=0;o<r.length;o++)if(r[o].endsWith(".css")){v.d("css inject:",r[o]);var s=e.createElement("link");s.rel="stylesheet",s.href=r[o],e.head.appendChild(s)}else n=document.createElement("script"),n.src=r[o],e.head.appendChild(n);return v.d("Cleaned dom:",e),e}function c(t,n){var r;return o(t).then(function(t){return r=t[0].path,e.readFileAsHTML(t[0].path)}).then(function(e){return v.d("_injectScripts"),v.d(e),s(e,n)}).then(function(e){v.d("Serialize dom");var t=(new XMLSerializer).serializeToString(e),n='<html xmlns="http://www.w3.org/1999/xhtml"';return t=t.replace(n,"<html")}).then(function(t){return v.d("Write dom:",r,t),e.write(r,t)})}function u(e){var t=new RegExp(/index\.html$/i);return t.test(e)}var l,d,p,f,h,m,g={},y="http://s2.motime.com/js/wl/webstore_html5game/gfsdk/dist/gfsdk.js",v=new t("ALL","[Game - module]");r.prototype.download=function(t,n){function r(e){return function(t){var n=Math.round(t.loaded/t.total*100);a({percentage:n,type:e})}}function i(){return s({type:"download"}),v.d("Download:",t.id,t.response_api_dld.binary_url),e.download(t.response_api_dld.binary_url,g.TEMP_DIR,d+".zip",r("download")).then(function(n){return s({type:"unzip"}),v.d("unzip:",t.id,g.TEMP_DIR+d),e._promiseZip(n.path,g.TEMP_DIR+d,r("unzip"))}).then(function(n){v.d("Unzip ended",n),l({type:"unzip"});var r=t.response_api_dld.url_download,i=r.substring(r.lastIndexOf("game"),r.length).split("/"),o="";v.d("Get the right index folder of the game",i);for(var a=0;a<i.length;a++)u(i[a])&&(o=g.TEMP_DIR+[d,i[a-1]].join("/"));return v.d("Copy game folder in games/",o,g.GAMES_DIR+d),e.moveDir(o,g.GAMES_DIR+d)}).then(function(t){return v.d("Remove zip from:",g.TEMP_DIR+d+".zip","last operation result",t),e.removeFile(g.TEMP_DIR+d+".zip")}).then(function(){return v.d("Save meta.json for:",t.id),e.createFile(g.GAMES_DIR+d,"meta.json").then(function(n){return e.write(n.path,JSON.stringify(t))})}).then(function(e){return v.d("result last operation:save meta.json",e),v.d("InjectScripts in game:",t.id,f),c(t.id,[g.GAMEOVER_RELATIVE_DIR+"gameover.css",g.SDK_RELATIVE_DIR+"cordova.js",g.SDK_RELATIVE_DIR+"cordova_plugins.js",g.SDK_RELATIVE_DIR+"gfsdk.min.js",g.SDK_RELATIVE_DIR+"stargate.js"])}).then(function(e){return v.d("injectScripts result",e),l({type:"download"}),t.id})}if(this.isDownloading())return Promise.reject(["Downloading...try later",e.currentFileTransfer]);var o=e.dirExists(g.GAMES_DIR+t.id);n=n?n:{};var a=n.onProgress?n.onProgress:function(){},s=n.onStart?n.onStart:function(){},l=n.onEnd?n.onEnd:function(){},d=t.id;return o.then(function(e){return v.d("Exists",e),e?Promise.reject({12:"AlreadyExists",gameID:t.id}):i()})},r.prototype.play=function(t){v.d("Play",t);var n=g.GAMES_DIR+t;return e.readDir(n).then(function(e){return e.filter(function(e){var t=new RegExp(/index\.html$/i);return t.test(e.path)})}).then(function(e){v.d(e);var t=e[0].internalURL;"ios"==window.device.platform.toLowerCase()?(v.d("Play ios",t),window.location.href=t):(v.d("Play android",t),window.navigator.app.loadUrl(encodeURI(t)))})},r.prototype.remove=function(t){return e.removeDir(g.GAMES_DIR+t)},r.prototype.isDownloading=function(){return null!==e.currentFileTransfer||void 0===e.currentFileTransfer},r.prototype.abortDownload=function(){return this.isDownloading()?(e.currentFileTransfer.abort(),e.currentFileTransfer=null,!0):(v.w("There's not a download operation to abort"),!1)},r.prototype.list=function(){return e.readDir(g.GAMES_DIR).then(function(e){var t=Array.isArray(e)?e:[e];return t.map(function(e){return e.path})}).then(function(t){var n=t.map(function(t){return e.readFileAsJSON(t+"meta.json")});return Promise.all(n).then(function(e){return e})})},r.prototype.buildGameOver=function(t){var n=g.GAMES_DIR+t.content_id+"/meta.json";return t.hasOwnProperty("content_id")?(v.d("Read meta.json:",n),v.d("GAMEOVER_TEMPLATE path",g.GAMEOVER_DIR+"gameover.html"),Promise.all([e.readFileAsJSON(n),e.readFile(g.GAMEOVER_DIR+"gameover.html")]).then(function(e){var n=e[1],r=e[0];return n.replace("{{score}}",t.score).replace("{{url_share}}",r.url_share).replace("{{url_cover}}",r.url_cover).replace("{{startpage_url}}",g.WWW_DIR+"startpage.html")})):Promise.reject("Missing content_id key!")};var w={};w.initialize=i,n.game={_protected:w,_public:new r}}(a.file,a.Logger,a);var s=function(){var e={},t=!1;e.init=function(){if(C.hasOwnProperty("webappsfixes")&&"object"==typeof C.webappsfixes){t=!0;for(var e in C.webappsfixes)if(C.webappsfixes.hasOwnProperty(e))if(n.hasOwnProperty(e)&&"function"==typeof n[e]){p("[webappsFixes] applying fix: "+e);var r=n[e](C.webappsfixes[e]);r&&f("[webappsFixes] fix '"+e+"' failed: "+r)}else f("[webappsFixes] fix implementation not found for: "+e)}return t};var n={};return n.gamifiveSearchBox=function(e){if(!window.cordova||!window.cordova.plugins||!window.cordova.plugins.Keyboard)return"missing ionic-plugin-keyboard";if(e.platforms){if(g()&&!e.platforms.ios)return"fix disabled on iOS";if(m()&&!e.platforms.android)return"fix disabled on Android"}return window.addEventListener("native.keyboardshow",function(){setTimeout(function(){0===document.querySelectorAll("input:focus").length&&(p("[webappsFixes] [gamifiveSearchBox] keyboard show on null input: hiding"),cordova.plugins.Keyboard.close())},1)},!1),p("[webappsFixes] [gamifiveSearchBox] listening on event native.keyboardshow"),""},e}();window.pubKey="",window.forge="";var c;o.initializeOffline=function(e){return c?c:("object"!=typeof e&&(e={}),e.hasOwnProperty("hideSplashScreen")||(e.hideSplashScreen=!0),b=!0,c=new Promise(function(r){document.addEventListener("deviceready",function(){E(),y(),t(),Promise.all([cordova.getAppVersion.getVersionNumber(),n()]).then(function(t){S=t[0],"object"!=typeof t[1]&&(t[1]=JSON.parse(t[1])),l=t[1].start_url,C=t[1].stargateConf,e.hideSplashScreen&&(navigator.splashscreen.hide(),O(!1)),k=!0,p("Stargate.initializeOffline() done"),r(!0)})["catch"](function(e){f("initializeOffline() error: "+e)})})}))},o.conf={},o.conf.getWebappStartUrl=function(){return C.webapp_start_url},o.initialize=function(e,t,n,r){if("function"==typeof t&&"undefined"==typeof n&&"undefined"==typeof r&&(r=t),"function"!=typeof r){f("Stargate.initialize() callback is not a function!");var o=Q.defer();return setTimeout(function(){o.reject(new Error("Stargate.initialize() callback is not a function!"))},1),o.promise}if(w=j(),b){f("Stargate.initialize() already called, executing callback."),r&&r(w);var a=Q.defer();return setTimeout(function(){a.resolve(w)},1),a.promise}if(b=!0,e.country&&(A=e.country),e.hybrid_conf&&(R="object"==typeof e.hybrid_conf?e.hybrid_conf:JSON.parse(decodeURIComponent(e.hybrid_conf))),!w){p("version "+i+" running outside hybrid; loaded from server version: v"+d),r(w);var s=Q.defer();return setTimeout(function(){s.resolve(w)},1),s.promise}return p("initialize() starting up, configuration: ",R),_=r,x=Q.defer(),document.addEventListener("deviceready",D,!1),x.promise},o.isInitialized=function(){return b},o.isOpen=function(){return k},o.isHybrid=function(){return j()},o.openUrl=function(e){return b?void window.open(e,"_system"):f("Stargate not initialized, call Stargate.initialize first!")},o.googleLogin=function(e,t){return b?(f("unimplemented"),void t("unimplemented")):t("Stargate not initialized, call Stargate.initialize first!")};var u={type:"unknown",networkState:"unknown"};window.addEventListener("online",e,!1),window.addEventListener("offline",e,!1),o.checkConnection=function(){var e=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0],t=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return b?"function"!=typeof navigator.connection.getInfo?(t("Missing cordova plugin"),console.warn("Cordova Network Information module missing"),!1):(e(u),u):(t("Stargate not initialized, call Stargate.initialize first!"),!1)},o.getDeviceID=function(e,t){if(!b)return t("Stargate not initialized, call Stargate.initialize first!");var n=h.uuid;e({deviceID:n})},o.setStatusbarVisibility=function(e,t,n){return b?"undefined"==typeof window.StatusBar?(f("[StatusBar] missing cordova plugin"),n("missing cordova plugin")):e?(window.StatusBar.show(),t("statusbar shown")):(window.StatusBar.hide(),t("statusbar hided")):n("Stargate not initialized, call Stargate.initialize first!")},o.getVersion=function(){return i},o.ad=new r;var l,d="2",p=console.log.bind(window.console,"[Stargate] "),f=console.error.bind(window.console,"[Stargate] "),h={available:!1,cordova:"",manufacturer:"",model:"",platform:"",uuid:"",version:""},m=function(){return"Android"==h.platform},g=function(){return"iOS"==h.platform},y=function(){if("undefined"==typeof window.device)return f("Missing cordova device plugin");for(var e in h)window.device.hasOwnProperty(e)&&(h[e]=window.device[e]);return!0},v=function(e){p("launchUrl: "+e),document.location.href=e},w=!1,b=!1,k=!1,_=null,x=null,S="",A="",R={},I=function(){if("undefined"==typeof window.StatusBar)return f("[StatusBar] missing cordova plugin");if("undefined"!=typeof C.statusbar&&"undefined"!=typeof C.statusbar.hideOnUrlPattern&&C.statusbar.hideOnUrlPattern.constructor===Array){for(var e=document.location.href,t=!1,n=0;n<C.statusbar.hideOnUrlPattern.length;n++){var r=new RegExp(C.statusbar.hideOnUrlPattern[n]);if(r.test(e)){t=!0;break}}t?window.StatusBar.hide():window.StatusBar.show()}},E=function(){window.Cookies.set("hybrid","1"),window.Cookies.set("stargateVersion",d),window.localStorage.getItem("hybrid")||window.localStorage.setItem("hybrid",1),window.localStorage.getItem("stargateVersion")||window.localStorage.setItem("stargateVersion",d)},P=function(){if(document.title=C.title,g()&&"undefined"!=typeof window.cordova&&cordova.require){var e=cordova.require("cordova/exec");e.setJsToNativeBridgeMode(e.jsToNativeModes.IFRAME_NAV)}I(),U("mfp")&&F.check(),U("deltadna")&&window.deltadna.startSDK(C.deltadna.environmentKey,C.deltadna.collectApi,C.deltadna.engageApi,V,G,C.deltadna.settings),navigator.splashscreen.hide(),O(!1),B.initialize(),$.init(),s.init(),U("game")&&a.game&&a.game._protected.initialize({}),k=!0,p("version "+i+" ready; loaded from server version: v"+d+" running in package version: "+S),_(!0),p("Stargate.initialize() done"),x.resolve(!0)},D=function(){E(),y(),t(),Q.all([cordova.getAppVersion.getVersionNumber(),n()]).then(function(e){S=e[0],"object"!=typeof e[1]&&(e[1]=JSON.parse(e[1])),l=e[1].start_url,C=e[1].stargateConf,P()}).fail(function(e){f("onDeviceReady() error: "+e)})},j=function(){var e=window.URI(document.location.href);return e.hasQuery("hybrid")?!0:window.Cookies.get("hybrid")?!0:window.localStorage.getItem("hybrid")?!0:!1},T=!1,O=function(e){e?(T=!0,L()):(T=!1,M())},C={features:{}},U=function(e){return"undefined"!=typeof C.features[e]&&C.features[e]},F=function(){var e={};return e.check=function(){return A?void e.get(A):f("Country not defined!")},e.getContents=function(e,t,n,r){var i={};i.api_country=n,i.country=e,i.fpnamespace=t,r&&(i.extData=r);var o=JSON.stringify(i);return o},e.getPonyValue=function(e){try{return e.split("=")[1]}catch(t){f(t)}return""},e.setSession=function(t){var n=l;window.localStorage.getItem("appUrl")&&(n=window.localStorage.getItem("appUrl"));var r=new URI(l),i=r.hostname(),o=URITemplate(C.api.mfpSetUriTemplate).expand({protocol:r.protocol(),hostname:i,url:n,domain:i,_PONY:e.getPonyValue(t)});p("[MobileFingerPrint] going to url: ",o),v(o)},e.get=function(t){var n="",r=URITemplate(C.api.mfpGetUriTemplate).expand({apikey:C.motime_apikey,contents_inapp:e.getContents(t,C.namespace,C.label),country:t,expire:n});window.aja().url(r).type("jsonp").on("success",function(t){p("[MobileFingerPrint] get() response: ",t);var n="";if(t.content.inappInfo){var r=JSON.parse(t.content.inappInfo);r.extData&&(r.extData.ponyUrl&&(n=r.extData.ponyUrl),r.extData.return_url&&window.localStorage.setItem("appUrl",r.extData.return_url),r.extData.session_mfp&&J.track({page:"hybrid_initialize",action:"MFP_get",session_mfp:r.extData.session_mfp})),e.setSession(n)}else p("[MobileFingerPrint] get(): Empty session")}).on("error",function(e){f("[MobileFingerPrint] get() error: ",e)}).go()},{check:e.check}}(),z=function(){"use strict";function e(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function t(e,t){return e<<t|e>>>32-t}function n(n,r,i,o,a,s){return e(t(e(e(r,n),e(o,s)),a),i)}function r(e,t,r,i,o,a,s){return n(t&r|~t&i,e,t,o,a,s)}function i(e,t,r,i,o,a,s){return n(t&i|r&~i,e,t,o,a,s)}function o(e,t,r,i,o,a,s){return n(t^r^i,e,t,o,a,s)}function a(e,t,r,i,o,a,s){return n(r^(t|~i),e,t,o,a,s)}function s(t,n){t[n>>5]|=128<<n%32,t[(n+64>>>9<<4)+14]=n;var s,c,u,l,d,p=1732584193,f=-271733879,h=-1732584194,m=271733878;for(s=0;s<t.length;s+=16)c=p,u=f,l=h,d=m,p=r(p,f,h,m,t[s],7,-680876936),m=r(m,p,f,h,t[s+1],12,-389564586),h=r(h,m,p,f,t[s+2],17,606105819),f=r(f,h,m,p,t[s+3],22,-1044525330),p=r(p,f,h,m,t[s+4],7,-176418897),m=r(m,p,f,h,t[s+5],12,1200080426),h=r(h,m,p,f,t[s+6],17,-1473231341),f=r(f,h,m,p,t[s+7],22,-45705983),p=r(p,f,h,m,t[s+8],7,1770035416),m=r(m,p,f,h,t[s+9],12,-1958414417),h=r(h,m,p,f,t[s+10],17,-42063),f=r(f,h,m,p,t[s+11],22,-1990404162),p=r(p,f,h,m,t[s+12],7,1804603682),m=r(m,p,f,h,t[s+13],12,-40341101),h=r(h,m,p,f,t[s+14],17,-1502002290),f=r(f,h,m,p,t[s+15],22,1236535329),p=i(p,f,h,m,t[s+1],5,-165796510),m=i(m,p,f,h,t[s+6],9,-1069501632),h=i(h,m,p,f,t[s+11],14,643717713),f=i(f,h,m,p,t[s],20,-373897302),p=i(p,f,h,m,t[s+5],5,-701558691),m=i(m,p,f,h,t[s+10],9,38016083),h=i(h,m,p,f,t[s+15],14,-660478335),f=i(f,h,m,p,t[s+4],20,-405537848),p=i(p,f,h,m,t[s+9],5,568446438),m=i(m,p,f,h,t[s+14],9,-1019803690),h=i(h,m,p,f,t[s+3],14,-187363961),f=i(f,h,m,p,t[s+8],20,1163531501),p=i(p,f,h,m,t[s+13],5,-1444681467),m=i(m,p,f,h,t[s+2],9,-51403784),h=i(h,m,p,f,t[s+7],14,1735328473),f=i(f,h,m,p,t[s+12],20,-1926607734),p=o(p,f,h,m,t[s+5],4,-378558),m=o(m,p,f,h,t[s+8],11,-2022574463),h=o(h,m,p,f,t[s+11],16,1839030562),f=o(f,h,m,p,t[s+14],23,-35309556),p=o(p,f,h,m,t[s+1],4,-1530992060),m=o(m,p,f,h,t[s+4],11,1272893353),h=o(h,m,p,f,t[s+7],16,-155497632),f=o(f,h,m,p,t[s+10],23,-1094730640),p=o(p,f,h,m,t[s+13],4,681279174),m=o(m,p,f,h,t[s],11,-358537222),h=o(h,m,p,f,t[s+3],16,-722521979),f=o(f,h,m,p,t[s+6],23,76029189),p=o(p,f,h,m,t[s+9],4,-640364487),m=o(m,p,f,h,t[s+12],11,-421815835),h=o(h,m,p,f,t[s+15],16,530742520),f=o(f,h,m,p,t[s+2],23,-995338651),p=a(p,f,h,m,t[s],6,-198630844),m=a(m,p,f,h,t[s+7],10,1126891415),h=a(h,m,p,f,t[s+14],15,-1416354905),f=a(f,h,m,p,t[s+5],21,-57434055),p=a(p,f,h,m,t[s+12],6,1700485571),m=a(m,p,f,h,t[s+3],10,-1894986606),h=a(h,m,p,f,t[s+10],15,-1051523),f=a(f,h,m,p,t[s+1],21,-2054922799),p=a(p,f,h,m,t[s+8],6,1873313359),m=a(m,p,f,h,t[s+15],10,-30611744),h=a(h,m,p,f,t[s+6],15,-1560198380),f=a(f,h,m,p,t[s+13],21,1309151649),p=a(p,f,h,m,t[s+4],6,-145523070),m=a(m,p,f,h,t[s+11],10,-1120210379),h=a(h,m,p,f,t[s+2],15,718787259),f=a(f,h,m,p,t[s+9],21,-343485551),p=e(p,c),f=e(f,u),h=e(h,l),m=e(m,d);return[p,f,h,m]}function c(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function l(e){return c(s(u(e),8*e.length))}function d(e,t){var n,r,i=u(e),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=s(i,8*e.length)),n=0;16>n;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=s(o.concat(u(t)),512+8*t.length),c(s(a.concat(r),640))}function p(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function f(e){return unescape(encodeURIComponent(e))}function h(e){return l(f(e))}function m(e){return p(h(e))}function g(e,t){return d(f(e),f(t))}function y(e,t){return p(g(e,t))}function v(e,t,n){return t?n?g(t,e):y(t,e):n?h(e):m(e)}return v}(),N=function(){function e(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.setAttribute("type","text/css"),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}var t="#holdon-overlay {\n    filter: alpha(opacity=80);\n    position:fixed; \n    width:100%; \n    height:100%;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    background: #000;\n    opacity: 0;\n    z-index: 9999;\n    transition: opacity 300ms linear;\n    -moz-transition: opacity 300ms linear;\n    -webkit-transition: opacity 300ms linear;\n}\n#holdon-overlay.show {\n  opacity: 0.8;\n}\n#holdon-content-container{\n    width: 100%;\n    padding: 0;\n    vertical-align: middle;\n    display: table-cell !important;\n    margin: 0;\n    text-align: center;\n}\n#holdon-content {\n    text-align: center;\n    width: 50px;\n    height: 57px;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: -28px 0 0 -25px;\n}\n#holdon-message {\n    width:100%;\n    text-align: center;\n    position: absolute;\n    top: 55%;\n    color:white;\n}\n.sk-rect {\n  width: 50px;\n  height: 40px;\n  text-align: center;\n  font-size: 10px;\n}\n.sk-rect > div {\n  background-color: #333;\n  height: 100%;\n  width: 6px;\n  display: inline-block;\n  -webkit-animation: sk-rect-anim 1.2s infinite ease-in-out;\n  animation: sk-rect-anim 1.2s infinite ease-in-out;\n}\n.sk-rect .rect2 {\n  -webkit-animation-delay: -1.1s;\n  animation-delay: -1.1s;\n}\n.sk-rect .rect3 {\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n.sk-rect .rect4 {\n  -webkit-animation-delay: -0.9s;\n  animation-delay: -0.9s;\n}\n.sk-rect .rect5 {\n  -webkit-animation-delay: -0.8s;\n  animation-delay: -0.8s;\n}\n@-webkit-keyframes sk-rect-anim {\n  0%, 40%, 100% { -webkit-transform: scaleY(0.4) }  \n  20% { -webkit-transform: scaleY(1.0) }\n}\n@keyframes sk-rect-anim {\n  0%, 40%, 100% { \n    transform: scaleY(0.4);\n    -webkit-transform: scaleY(0.4);\n  }  20% { \n    transform: scaleY(1.0);\n    -webkit-transform: scaleY(1.0);\n  }\n}\n.sk-cube {\n  width: 50px;\n  height: 40px;\n  text-align: center;\n  font-size: 10px;\n}\n.sk-cube1, .sk-cube2 {\n  background-color: #333;\n  width: 15px;\n  height: 15px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  \n  -webkit-animation: sk-cube 1.8s infinite ease-in-out;\n  animation: sk-cube 1.8s infinite ease-in-out;\n}\n.sk-cube2 {\n  -webkit-animation-delay: -0.9s;\n  animation-delay: -0.9s;\n}\n@-webkit-keyframes sk-cube {\n  25% { -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5) }\n  50% { -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg) }\n  75% { -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5) }\n  100% { -webkit-transform: rotate(-360deg) }\n}\n@keyframes sk-cube {\n  25% { \n    transform: translateX(42px) rotate(-90deg) scale(0.5);\n    -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5);\n  } 50% { \n    transform: translateX(42px) translateY(42px) rotate(-179deg);\n    -webkit-transform: translateX(42px) translateY(42px) rotate(-179deg);\n  } 50.1% { \n    transform: translateX(42px) translateY(42px) rotate(-180deg);\n    -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg);\n  } 75% { \n    transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n    -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n  } 100% { \n    transform: rotate(-360deg);\n    -webkit-transform: rotate(-360deg);\n  }\n}\n.sk-dot {\n    width: 50px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n    -webkit-animation: sk-dot-rotate 2.0s infinite linear;\n    animation: sk-dot-rotate 2.0s infinite linear;\n}\n.sk-dot1, .sk-dot2 {\n  width: 60%;\n  height: 60%;\n  display: inline-block;\n  position: absolute;\n  top: 0;\n  background-color: #333;\n  border-radius: 100%;\n  \n  -webkit-animation: sk-dot-bounce 2.0s infinite ease-in-out;\n  animation: sk-dot-bounce 2.0s infinite ease-in-out;\n}\n.sk-dot2 {\n  top: auto;\n  bottom: 0;\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n@-webkit-keyframes sk-dot-rotate { 100% { -webkit-transform: rotate(360deg) }}\n@keyframes sk-dot-rotate { 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg) }}\n@-webkit-keyframes sk-dot-bounce {\n  0%, 100% { -webkit-transform: scale(0.0) }\n  50% { -webkit-transform: scale(1.0) }\n}\n@keyframes sk-dot-bounce {\n  0%, 100% { \n    transform: scale(0.0);\n    -webkit-transform: scale(0.0);\n  } 50% { \n    transform: scale(1.0);\n    -webkit-transform: scale(1.0);\n  }\n}\n.sk-bounce {\n    width: 60px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-bounce > div {\n  width: 18px;\n  height: 18px;\n  background-color: #333;\n  border-radius: 100%;\n  display: inline-block;\n  -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n  animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n}\n.sk-bounce .bounce1 {\n    -webkit-animation-delay: -0.32s;\n    animation-delay: -0.32s;\n}\n.sk-bounce .bounce2 {\n  -webkit-animation-delay: -0.16s;\n  animation-delay: -0.16s;\n}\n@-webkit-keyframes sk-bouncedelay {\n  0%, 80%, 100% { -webkit-transform: scale(0) }\n  40% { -webkit-transform: scale(1.0) }\n}\n@keyframes sk-bouncedelay {\n  0%, 80%, 100% { \n    -webkit-transform: scale(0);\n    transform: scale(0);\n  } 40% { \n    -webkit-transform: scale(1.0);\n    transform: scale(1.0);\n  }\n}\n.sk-circle {\n    width: 60px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-circle .sk-child {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.sk-circle .sk-child:before {\n  content: '';\n  display: block;\n  margin: 0 auto;\n  width: 15%;\n  height: 15%;\n  background-color: #333;\n  border-radius: 100%;\n  -webkit-animation: sk-circleBounceDelay 1.2s infinite ease-in-out both;\n          animation: sk-circleBounceDelay 1.2s infinite ease-in-out both;\n}\n.sk-circle .sk-circle2 {\n  -webkit-transform: rotate(30deg);\n      -ms-transform: rotate(30deg);\n          transform: rotate(30deg); }\n.sk-circle .sk-circle3 {\n  -webkit-transform: rotate(60deg);\n      -ms-transform: rotate(60deg);\n          transform: rotate(60deg); }\n.sk-circle .sk-circle4 {\n  -webkit-transform: rotate(90deg);\n      -ms-transform: rotate(90deg);\n          transform: rotate(90deg); }\n.sk-circle .sk-circle5 {\n  -webkit-transform: rotate(120deg);\n      -ms-transform: rotate(120deg);\n          transform: rotate(120deg); }\n.sk-circle .sk-circle6 {\n  -webkit-transform: rotate(150deg);\n      -ms-transform: rotate(150deg);\n          transform: rotate(150deg); }\n.sk-circle .sk-circle7 {\n  -webkit-transform: rotate(180deg);\n      -ms-transform: rotate(180deg);\n          transform: rotate(180deg); }\n.sk-circle .sk-circle8 {\n  -webkit-transform: rotate(210deg);\n      -ms-transform: rotate(210deg);\n          transform: rotate(210deg); }\n.sk-circle .sk-circle9 {\n  -webkit-transform: rotate(240deg);\n      -ms-transform: rotate(240deg);\n          transform: rotate(240deg); }\n.sk-circle .sk-circle10 {\n  -webkit-transform: rotate(270deg);\n      -ms-transform: rotate(270deg);\n          transform: rotate(270deg); }\n.sk-circle .sk-circle11 {\n  -webkit-transform: rotate(300deg);\n      -ms-transform: rotate(300deg);\n          transform: rotate(300deg); }\n.sk-circle .sk-circle12 {\n  -webkit-transform: rotate(330deg);\n      -ms-transform: rotate(330deg);\n          transform: rotate(330deg); }\n.sk-circle .sk-circle2:before {\n  -webkit-animation-delay: -1.1s;\n          animation-delay: -1.1s; }\n.sk-circle .sk-circle3:before {\n  -webkit-animation-delay: -1s;\n          animation-delay: -1s; }\n.sk-circle .sk-circle4:before {\n  -webkit-animation-delay: -0.9s;\n          animation-delay: -0.9s; }\n.sk-circle .sk-circle5:before {\n  -webkit-animation-delay: -0.8s;\n          animation-delay: -0.8s; }\n.sk-circle .sk-circle6:before {\n  -webkit-animation-delay: -0.7s;\n          animation-delay: -0.7s; }\n.sk-circle .sk-circle7:before {\n  -webkit-animation-delay: -0.6s;\n          animation-delay: -0.6s; }\n.sk-circle .sk-circle8:before {\n  -webkit-animation-delay: -0.5s;\n          animation-delay: -0.5s; }\n.sk-circle .sk-circle9:before {\n  -webkit-animation-delay: -0.4s;\n          animation-delay: -0.4s; }\n.sk-circle .sk-circle10:before {\n  -webkit-animation-delay: -0.3s;\n          animation-delay: -0.3s; }\n.sk-circle .sk-circle11:before {\n  -webkit-animation-delay: -0.2s;\n          animation-delay: -0.2s; }\n.sk-circle .sk-circle12:before {\n  -webkit-animation-delay: -0.1s;\n          animation-delay: -0.1s; }\n@-webkit-keyframes sk-circleBounceDelay {\n  0%, 80%, 100% {\n    -webkit-transform: scale(0);\n            transform: scale(0);\n  } 40% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n}\n@keyframes sk-circleBounceDelay {\n  0%, 80%, 100% {\n    -webkit-transform: scale(0);\n            transform: scale(0);\n  } 40% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n}\n.sk-cube-grid {\n    width: 60px;\n    height: 60px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-cube-grid .sk-cube-child {\n  width: 33%;\n  height: 33%;\n  background-color: #333;\n  float: left;\n  -webkit-animation: sk-cubeGridScaleDelay 1.3s infinite ease-in-out;\n          animation: sk-cubeGridScaleDelay 1.3s infinite ease-in-out; \n}\n.sk-cube-grid .sk-cube-grid1 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n.sk-cube-grid .sk-cube-grid2 {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s; }\n.sk-cube-grid .sk-cube-grid3 {\n  -webkit-animation-delay: 0.4s;\n          animation-delay: 0.4s; }\n.sk-cube-grid .sk-cube-grid4 {\n  -webkit-animation-delay: 0.1s;\n          animation-delay: 0.1s; }\n.sk-cube-grid .sk-cube-grid5 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n.sk-cube-grid .sk-cube-grid6 {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s; }\n.sk-cube-grid .sk-cube-grid7 {\n  -webkit-animation-delay: 0s;\n          animation-delay: 0s; }\n.sk-cube-grid .sk-cube-grid8 {\n  -webkit-animation-delay: 0.1s;\n          animation-delay: 0.1s; }\n.sk-cube-grid .sk-cube-grid9 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n@-webkit-keyframes sk-cubeGridScaleDelay {\n  0%, 70%, 100% {\n    -webkit-transform: scale3D(1, 1, 1);\n            transform: scale3D(1, 1, 1);\n  } 35% {\n    -webkit-transform: scale3D(0, 0, 1);\n            transform: scale3D(0, 0, 1); \n  }\n}\n@keyframes sk-cubeGridScaleDelay {\n  0%, 70%, 100% {\n    -webkit-transform: scale3D(1, 1, 1);\n            transform: scale3D(1, 1, 1);\n  } 35% {\n    -webkit-transform: scale3D(0, 0, 1);\n            transform: scale3D(0, 0, 1);\n  } \n}\n.sk-folding-cube {\n  margin: 20px auto;\n  width: 40px;\n  height: 40px;\n  position: relative;\n  -webkit-transform: rotateZ(45deg);\n          transform: rotateZ(45deg);\n}\n.sk-folding-cube .sk-cube-parent {\n  float: left;\n  width: 50%;\n  height: 50%;\n  position: relative;\n  -webkit-transform: scale(1.1);\n      -ms-transform: scale(1.1);\n          transform: scale(1.1); \n}\n.sk-folding-cube .sk-cube-parent:before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: #333;\n  -webkit-animation: sk-foldCubeAngle 2.4s infinite linear both;\n          animation: sk-foldCubeAngle 2.4s infinite linear both;\n  -webkit-transform-origin: 100% 100%;\n      -ms-transform-origin: 100% 100%;\n          transform-origin: 100% 100%;\n}\n.sk-folding-cube .sk-cubechild2 {\n  -webkit-transform: scale(1.1) rotateZ(90deg);\n          transform: scale(1.1) rotateZ(90deg);\n}\n.sk-folding-cube .sk-cubechild3 {\n  -webkit-transform: scale(1.1) rotateZ(180deg);\n          transform: scale(1.1) rotateZ(180deg);\n}\n.sk-folding-cube .sk-cubechild4 {\n  -webkit-transform: scale(1.1) rotateZ(270deg);\n          transform: scale(1.1) rotateZ(270deg);\n}\n.sk-folding-cube .sk-cubechild2:before {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s;\n}\n.sk-folding-cube .sk-cubechild3:before {\n  -webkit-animation-delay: 0.6s;\n          animation-delay: 0.6s; \n}\n.sk-folding-cube .sk-cubechild4:before {\n  -webkit-animation-delay: 0.9s;\n          animation-delay: 0.9s;\n}\n@-webkit-keyframes sk-foldCubeAngle {\n  0%, 10% {\n    -webkit-transform: perspective(140px) rotateX(-180deg);\n            transform: perspective(140px) rotateX(-180deg);\n    opacity: 0; \n  } 25%, 75% {\n    -webkit-transform: perspective(140px) rotateX(0deg);\n            transform: perspective(140px) rotateX(0deg);\n    opacity: 1; \n  } 90%, 100% {\n    -webkit-transform: perspective(140px) rotateY(180deg);\n            transform: perspective(140px) rotateY(180deg);\n    opacity: 0; \n  } \n}\n@keyframes sk-foldCubeAngle {\n  0%, 10% {\n    -webkit-transform: perspective(140px) rotateX(-180deg);\n            transform: perspective(140px) rotateX(-180deg);\n    opacity: 0; \n  } 25%, 75% {\n    -webkit-transform: perspective(140px) rotateX(0deg);\n            transform: perspective(140px) rotateX(0deg);\n    opacity: 1; \n  } 90%, 100% {\n    -webkit-transform: perspective(140px) rotateY(180deg);\n            transform: perspective(140px) rotateY(180deg);\n    opacity: 0; \n  }\n}\n",n=!1,r=function(e){
var t=document.createElement("div");return t.innerHTML=e,t.firstChild},i={};return i.start=function(i){n||(e(t),n=!0);var o=document.querySelector("#holdon-overlay");o&&(o.parentNode.removeChild(o),o=null);var a="sk-rect",s="",c="";switch(i&&(i.hasOwnProperty("theme")&&(a=i.theme),i.hasOwnProperty("message")&&(c=i.message)),a){case"custom":s='<div style="text-align: center;">'+i.content+"</div>";break;case"sk-dot":s='<div class="sk-dot"> <div class="sk-dot1"></div> <div class="sk-dot2"></div> </div>';break;case"sk-rect":s='<div class="sk-rect"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>';break;case"sk-cube":s='<div class="sk-cube"> <div class="sk-cube1"></div> <div class="sk-cube2"></div> </div>';break;case"sk-bounce":s='<div class="sk-bounce"> <div class="bounce1"></div> <div class="bounce2"></div> <div class="bounce3"></div> </div>';break;case"sk-circle":s='<div class="sk-circle"> <div class="sk-circle1 sk-child"></div> <div class="sk-circle2 sk-child"></div> <div class="sk-circle3 sk-child"></div> <div class="sk-circle4 sk-child"></div> <div class="sk-circle5 sk-child"></div> <div class="sk-circle6 sk-child"></div> <div class="sk-circle7 sk-child"></div> <div class="sk-circle8 sk-child"></div> <div class="sk-circle9 sk-child"></div> <div class="sk-circle10 sk-child"></div> <div class="sk-circle11 sk-child"></div> <div class="sk-circle12 sk-child"></div> </div>';break;case"sk-cube-grid":s='<div class="sk-cube-grid"> <div class="sk-cube-child sk-cube-grid1"></div> <div class="sk-cube-child sk-cube-grid2"></div> <div class="sk-cube-child sk-cube-grid3"></div> <div class="sk-cube-child sk-cube-grid4"></div> <div class="sk-cube-child sk-cube-grid5"></div> <div class="sk-cube-child sk-cube-grid6"></div> <div class="sk-cube-child sk-cube-grid7"></div> <div class="sk-cube-child sk-cube-grid8"></div> <div class="sk-cube-child sk-cube-grid9"></div> </div>';break;case"sk-folding-cube":s='<div class="sk-folding-cube"> <div class="sk-cubechild1 sk-cube-parent"></div> <div class="sk-cubechild2 sk-cube-parent"></div> <div class="sk-cubechild4 sk-cube-parent"></div> <div class="sk-cubechild3 sk-cube-parent"></div> </div>';break;default:s='<div class="sk-rect"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>',f("[loading] "+a+" doesn't exist")}var u='<div id="holdon-overlay">\n   <div id="holdon-content-container">\n       <div id="holdon-content">'+s+'</div>\n       <div id="holdon-message">'+c+"</div>\n   </div>\n</div>",l=document.getElementsByTagName("body")[0],d=r(u);i&&i.backgroundColor&&(d.style.backgroundColor=i.backgroundColor,d.querySelector("#holdon-message").style.color=i.textColor),l.appendChild(d),d=null,setTimeout(function(){var e=document.getElementById("holdon-overlay");e.classList.add("show")},1)},i.stop=function(){var e=document.querySelector("#holdon-overlay");e&&(e.classList.remove("show"),setTimeout(function(){e.parentNode.removeChild(e),e=null},500))},i}(),L=function(e){"object"!=typeof e&&(e={}),e.theme||(e.theme="sk-circle"),N.start(e)},M=function(){N.stop()},q=function(e){var t=document.querySelector("#holdon-message");return t?(t.textContent=e,!0):!1};"object"!=typeof o.test&&(o.test={}),"object"!=typeof o.test.loading&&(o.test.loading={}),o.test.loading.start=L,o.test.loading.stop=M,o.test.loading.change=q,window.startLoading=L,window.stopLoading=M;var B={id:"",alias:"",type:"",verbosity:"",paymethod:"",subscribeMethod:"stargate",returnUrl:"",callbackSuccess:function(){p("[IAP] Undefined callbackSuccess")},callbackError:function(){p("[IAP] Undefined callbackError")},refreshDone:!1,lastCreateuserUrl:"",lastCreateuserData:"",createUserAttempt:0,maxCreateUserAttempt:6,initialize:function(){return window.store?(B.returnUrl=document.location.href,R.IAP.id&&(B.id=R.IAP.id),R.IAP.alias&&(B.alias=R.IAP.alias),R.IAP.type&&(B.type=R.IAP.type),B.verbosity="INFO",B.paymethod=m()?"gwallet":"itunes",p("IAP initialize id: "+B.id),m()&&B.getGoogleAccount(),window.store.verbosity=window.store[B.verbosity],window.store.register({id:B.id,alias:B.alias,type:window.store[B.type]}),window.store.when(B.alias).approved(function(e){B.onPurchaseApproved(e)}),window.store.when(B.alias).verified(function(e){B.onPurchaseVerified(e)}),window.store.when(B.alias).updated(function(e){B.onProductUpdate(e)}),window.store.when(B.alias).owned(function(e){B.onProductOwned(e)}),window.store.when(B.alias).cancelled(function(e){B.onCancelledProduct(e)}),window.store.when(B.alias).error(function(e){B.error(JSON.stringify(e))}),window.store.ready(function(){B.onStoreReady()}),void window.store.when("order "+B.id).approved(function(e){B.onOrderApproved(e)})):void f("Store not available")},doRefresh:function(e){(!B.refreshDone||e)&&(window.store.refresh(),B.refreshDone=!0)},getPassword:function(e){return z("iap."+e+".playme").substr(0,8)},getGoogleAccount:function(){window.accountmanager.getAccounts(B.checkGoogleAccount,B.error,"com.google")},checkGoogleAccount:function(e){if(e){p("[IAP] accounts"),p(e);for(var t in e)return window.localStorage.setItem("googleAccount",e[t].email),e[t].email}},onProductUpdate:function(e){p("IAP> Product updated."),p(JSON.stringify(e)),p(e.owned?"[IAP] Subscribed!":"[IAP] Not Subscribed")},onPurchaseApproved:function(e){p("IAP> Purchase approved."),p(JSON.stringify(e)),e.finish()},onPurchaseVerified:function(e){p("subscription verified ",e)},onStoreReady:function(){p("\\o/ STORE READY \\o/")},onProductOwned:function(e){if(p("[IAP] > Product Owned."),!e.transaction.id&&g())return p("[IAP] > no transaction id"),!1;if(window.localStorage.setItem("product",e),g()&&window.localStorage.setItem("transaction_id",e.transaction.id),m()){var t=e.transaction.purchaseToken+"|"+C.id+"|"+B.id;p("[IAP] Purchase Token: "+t),window.localStorage.getItem("user_account")||B.createUser(e,t)}else window.storekit.loadReceipts(function(t){window.localStorage.getItem("user_account")||(t.appStoreReceipt?(p("[IAP] appStoreReceipt: "+t.appStoreReceipt),B.createUser(e,t.appStoreReceipt)):p("[IAP] appStoreReceipt empty, ignoring request"))})},onCancelledProduct:function(e){O(!1),B.callbackError({iap_cancelled:1,return_url:B.returnUrl}),p("[IAP] > Purchase cancelled ##################################",e)},onOrderApproved:function(e){p("[IAP] ORDER APPROVED "+B.id),e.finish()},error:function(e){O(!1),B.callbackError({iap_error:1,return_url:B.returnUrl}),f("[IAP] error: "+e)},createUser:function(e,t){p("[IAP] createUser start "),window.localStorage.setItem("user_account",m()?window.localStorage.getItem("googleAccount")?window.localStorage.getItem("googleAccount"):t+"@google.com":e.transaction.id+"@itunes.com");var n=B.subscribeMethod,r={paymethod:B.paymethod,user_account:window.localStorage.getItem("user_account"),purchase_token:t,return_url:B.returnUrl,inapp_pwd:B.getPassword(t),hybrid:1};B.lastCreateuserUrl=n,B.lastCreateuserData=r;var i=function(e){if(B.createUserAttempt<=B.maxCreateUserAttempt)f("[IAP] createUser failed "+B.createUserAttempt+" times, trying again... last error: "+JSON.stringify(e)),s();else{p("[IAP] createUser onCreateError: removing user_account"),window.localStorage.removeItem("user_account");var t={iap_error:"1",return_url:B.returnUrl};O(!1),B.callbackError(t)}},o=function(e){p("[IAP] createUser success ",e);try{e.device_id=h.uuid,window.localStorage.getItem("transaction_id")&&(e.transaction_id=window.localStorage.getItem("transaction_id")),O(!1),B.callbackSuccess(e)}catch(t){i(t)}},a=10,s=function(){setTimeout(function(){B.createUserAttempt=B.createUserAttempt+1,p("[IAP] createUser attempt: "+B.createUserAttempt+" with timeout: "+a+"sec."),window.aja().method("POST").url(B.lastCreateuserUrl).cache(!1).timeout(1e3*a).data(B.lastCreateuserData).on("success",function(e){o(e)}).on("error",function(e){i(e)}).on("4**",function(e){i(e)}).on("5**",function(e){i(e)}).on("timeout",function(){i("timeout")}).on("end",function(){p("[IAP] createUser end"),O(!1)}).go(),a+=5},10)};B.createUserAttempt=0,s()}};o.inAppPurchaseSubscription=function(e,t,n,r){return b?(O(!0),"undefined"!=typeof r&&(B.returnUrl=r),"undefined"!=typeof n&&(B.subscribeMethod=n),B.callbackSuccess=e,B.callbackError=t,B.doRefresh(),void window.store.order(B.id)):t("Stargate not initialized, call Stargate.initialize first!")},o.inAppRestore=function(e,t,n,r){return b?("undefined"!=typeof n&&(B.subscribeMethod=n),"undefined"!=typeof r&&(B.returnUrl=r),B.callbackSuccess=e,B.callbackError=t,void B.doRefresh(!0)):t("Stargate not initialized, call Stargate.initialize first!")},o.facebookLogin=function(e,t,n){return b?void facebookConnectPlugin.login(e.split(","),function(e){p("[facebook] got userdata: ",e),facebookConnectPlugin.getAccessToken(function(e){t({accessToken:e})},function(e){n({error:e})})},function(e){f("Got FB login error:",e),n({error:e})}):n("Stargate not initialized, call Stargate.initialize first!")},o.facebookShare=function(e,t,n){if(!b)return n("Stargate not initialized, call Stargate.initialize first!");var r={method:"share",href:e};facebookConnectPlugin.showDialog(r,function(e){t({message:e})},function(e){f("Got FB share error:",e),n({error:e})})};var V=function(){deltadna.registerPushCallback(H)},G=function(e){f("[DeltaDNA] error: "+e)},H=function(e){return m()&&e.payload&&e.payload.url&&!e.foreground?v(e.payload.url):g()&&e.url?v(e.url):void 0},$=function(){var e,t={},n={};return t.init=function(){if(!window.plugins||!window.plugins.appsFlyer)return f("[appsflyer] missing cordova plugin");if("undefined"==typeof C.appstore_appid)return f("[appsflyer] missing manifest configuration: appstore_appid");if("undefined"==typeof C.appsflyer_devkey)return f("[appsflyer] missing manifest configuration: appsflyer_devkey");var t=[C.appsflyer_devkey];g()&&t.push(C.appstore_appid),document.addEventListener("onInstallConversionDataLoaded",function(t){if(n=t.detail,"function"!=typeof e)return p("[appsflyer] callback not set!");try{e(n),p("[appsflyer] parameters sent to webapp callback: "+JSON.stringify(n))}catch(r){f("[appsflyer] callback error: "+r,r)}},!1),window.plugins.appsFlyer.initSdk(t)},t.setCallback=function(t){e=t},t}();o.setConversionDataCallback=function(e){$.setCallback(e)};var J=function(){var e,t={};return t.track=function(t){if("function"!=typeof e)return p("[analytics] callback not set!");try{e(t)}catch(n){f("[analytics] callback error: "+n,n)}},t.setCallback=function(t){e=t},t}();o.setAnalyticsCallback=function(e){J.setCallback(e)};return o.game=a.game._public,o.file=a.file,o});