/*!
 * StargateJS Apps
 * v0.2.0
 * Copyright 2015 DMobileLab. http://buongiorno.com/
 * See LICENSE in this repository for license information
 */
!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():e.Stargate=n()}(this,function(){function e(e){l.type=e.type,l.networkState=navigator.connection.type}function n(){l.networkState=navigator.connection.type,"none"===navigator.connection.type?l.type="offline":l.type="online"}function t(){return a.file.readFileAsJSON(cordova.file.applicationDirectory+"www/manifest.json")}function i(){this.initialize=function(e,n,t){p("unimplemented"),t("unimplemented")},this.createBanner=function(e,n,t){p("unimplemented"),t("unimplemented")},this.hideBanner=function(e,n,t){p("unimplemented"),t("unimplemented")},this.removeBanner=function(e,n,t){p("unimplemented"),t("unimplemented")},this.showBannerAtSelectedPosition=function(e,n,t){p("unimplemented"),t("unimplemented")},this.showBannerAtGivenXY=function(e,n,t){p("unimplemented"),t("unimplemented")},this.registerAdEvents=function(e,n,t){p("unimplemented"),t("unimplemented")},this.prepareInterstitial=function(e,n,t){p("unimplemented"),t("unimplemented")},this.showInterstitial=function(e,n,t){p("unimplemented"),t("unimplemented")}}var r="0.2.0",o={},a={};!function(e){function n(e,t){this.level=n.levels[e.toUpperCase()],this.tag=t}n.levels={ALL:5,ERROR:4,WARN:3,INFO:2,DEBUG:1,OFF:0},n.prototype.e=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=n.levels.ERROR&&window.console.error.apply(console,e)},n.prototype.i=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=n.levels.WARN&&window.console.info.apply(console,e)},n.prototype.w=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=n.levels.INFO&&window.console.warn.apply(console,e)},n.prototype.d=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.tag),0!==this.level&&this.level>=n.levels.DEBUG&&window.console.log.apply(console,e)},n.prototype.setLevel=function(e){this.level=n.levels[e]},e?e.Logger=n:window.Logger=n}(a),function(e,n){function t(e){var n=e.map(function(e){return{fullPath:e.fullPath,path:e.toURL(),internalURL:e.toInternalURL(),isFile:e.isFile,isDirectory:e.isDirectory}});return 1==n.length?n[0]:n}var i,r={};return r.LOG=i=new n("ALL","[File - module]"),r.ERROR_MAP={1:"NOT_FOUND_ERR",2:"SECURITY_ERR",3:"ABORT_ERR",4:"NOT_READABLE_ERR",5:"ENCODING_ERR",6:"NO_MODIFICATION_ALLOWED_ERR",7:"INVALID_STATE_ERR",8:"SYNTAX_ERR",9:"INVALID_MODIFICATION_ERR",10:"QUOTA_EXCEEDED_ERR",11:"TYPE_MISMATCH_ERR",12:"PATH_EXISTS_ERR"},r.currentFileTransfer=null,r.resolveFS=function(e){return new Promise(function(n,t){window.resolveLocalFileSystemURL(e,n,t)})},r.appendToFile=function(e,n,i){return i=void 0===arguments[2]?!1:arguments[2],r.resolveFS(e).then(function(e){return new Promise(function(r,o){e.createWriter(function(a){i||a.seek(a.length);var s=new Blob([n],{type:"text/plain"});a.write(s),a.onerror=o,a.onabort=o,a.onwriteend=function(){r(t([e]))}},o)})})},r.readFileAsHTML=function(e){return r.readFile(e).then(function(e){return(new window.DOMParser).parseFromString(e,"text/html")})},r.readFileAsJSON=function(e){return r.readFile(e).then(function(e){try{return Promise.resolve(window.JSON.parse(e))}catch(n){return Promise.reject(n)}})},r.removeFile=function(e){return r.resolveFS(e).then(function(e){return new Promise(function(n,t){e.remove(function(e){n(null===e||"OK"===e)},t)})})},r.removeDir=function(e){return r.resolveFS(e).then(function(e){return new Promise(function(n,t){e.removeRecursively(function(e){n(null===e||"OK"===e)},t)})})},r._promiseZip=function(e,n,t){return i.d("PROMISEZIP:",arguments),new Promise(function(i,r){window.zip.unzip(e,n,function(e){0===e?i(!0):r(e)},t)})},r.download=function(e,n,i,o){var a=new window.FileTransfer;return a.onprogress=o,r.currentFileTransfer=a,new Promise(function(o,s){a.download(window.encodeURI(e),n+i,function(e){o(t([e])),r.currentFileTransfer=null},function(e){s(e),r.currentFileTransfer=null},!0)})},r.createDir=function(e,n){return r.resolveFS(e).then(function(e){return new Promise(function(i,r){e.getDirectory(n,{create:!0},function(e){i(t([e]))},r)})})},r.fileExists=function(e){return new Promise(function(n){window.resolveLocalFileSystemURL(e,function(e){n(e.isFile)},function(e){n(1!==e.code)})})},r.dirExists=function(e){return new Promise(function(n){window.resolveLocalFileSystemURL(e,function(e){n(e.isDirectory)},function(e){n(1!=e.code)})})},r.requestFileSystem=function(e,n){return new Promise(function(t,i){window.requestFileSystem(e,n,t,i)})},r.readDir=function(e){return r.resolveFS(e).then(function(e){return new Promise(function(n,i){var r=e.createReader();r.readEntries(function(e){n(t(e))},i)})})},r.readFile=function(e){return r.resolveFS(e).then(function(e){return new Promise(function(n,t){e.file(function(e){var i=new FileReader;i.onerror=t,i.onabort=t,i.onloadend=function(){var e=this.result;n(e)},i.readAsText(e)})})})},r.createFile=function(e,n){return r.resolveFS(e).then(function(e){return new Promise(function(i,r){e.getFile(n,{create:!0},function(e){i(t([e]))},r)})})},r.write=function(e,n){return r.appendToFile(e,n,!0)},r.moveDir=function(e,n){var t=n.substring(n.lastIndexOf("/")+1),o=n.replace(t,"");return i.d("moveDir:",o,t),Promise.all([r.resolveFS(e),r.resolveFS(o)]).then(function(e){return i.d("moveDir: resolved entries",e),new Promise(function(n,i){e[0].moveTo(e[1],t,n,i)})})},r.copyFile=function(e,n){var t=n.substring(n.lastIndexOf("/")+1),o=n.replace(t,"");return Promise.all([r.resolveFS(e),r.resolveFS(o)]).then(function(e){return i.d("copyFileTo",e),new Promise(function(n,i){e[0].copyTo(e[1],t,n,i)})})},r.copyDir=function(e,n){var t=n.substring(n.lastIndexOf("/")+1),o=n.replace(t,"");return Promise.all([r.resolveFS(e),r.resolveFS(o)]).then(function(r){return i.d("copyDir",e,"in",n),new Promise(function(e,n){r[0].copyTo(r[1],t,e,n)})})},e.file=r,r}(a,a.Logger),function(e,n,t){"use strict";function i(){}function r(n){function i(){var n=e.createDir(w.BASE_DIR,"games"),t=e.createDir(w.BASE_DIR,"scripts");return Promise.all([n,t]).then(function(n){return v.d("GamesDir and ScriptsDir created",n),v.d("Getting SDK from:",k),Promise.all([e.download(k,n[1].path,"gfsdk.min.js"),e.copyDir(w.WWW_DIR+"gameover_template",w.BASE_DIR+"gameover_template"),e.copyDir(w.WWW_DIR+"plugins",w.SDK_DIR+"plugins"),e.copyFile(w.CORDOVAJS,w.SDK_DIR+"cordova.js"),e.copyFile(w.CORDOVA_PLUGINS_JS,w.SDK_DIR+"cordova_plugins.js"),e.copyFile(w.STARGATEJS,w.SDK_DIR+"stargate.js")])})}if(v.d("Initialized called with:",n),!e)return Promise.reject("Missing file module!");try{d=window.cordova.file.applicationStorageDirectory,u=window.cordova.file.cacheDirectory,f=window.cordova.file.tempDirectory,p=window.cordova.file.applicationDirectory+"www/",g=window.cordova.file.applicationDirectory+"www/js/stargate.js",m=window.cordova.file.dataDirectory}catch(r){return v.e(r),Promise.reject(r)}v.i("cordova JS dir to include",w.CORDOVAJS),"ios"==window.device.platform.toLowerCase()&&(d+="Documents/"),"android"==window.device.platform.toLowerCase()&&(f=u),w.SDK_DIR=d+"scripts/",w.SDK_RELATIVE_DIR="../../scripts/",w.GAMEOVER_RELATIVE_DIR="../../gameover_template/",w.GAMES_DIR=d+"games/",w.BASE_DIR=d,w.CACHE_DIR=u,w.TEMP_DIR=f,w.CORDOVAJS=p+"cordova.js",w.CORDOVA_PLUGINS_JS=p+"cordova_plugins.js",w.STARGATEJS=p+"js/stargate.js",w.DATA_DIR=m,w.GAMEOVER_DIR=w.BASE_DIR+"gameover_template/",w.WWW_DIR=p,t.game.GAMES_DIR=w.GAMES_DIR;var o=e.dirExists(w.GAMES_DIR),a=e.fileExists(w.SDK_DIR+"gfsdk.min.js");return Promise.all([o,a]).then(function(e){return e[0]||e[1]?Promise.resolve(!0):i()})}function o(n){return v.d("_getIndexHtmlById",w.GAMES_DIR+n),e.readDir(w.GAMES_DIR+n).then(function(e){return v.d("_getIndexHtmlById readDir",e),e.filter(function(e){var n=new RegExp(/index\.html$/i);return n.test(e.path)})})}function a(e){v.d("_removeRemoteSDK");for(var n,t=e.querySelectorAll("script"),i=0;i<t.length;i++)if(-1!==t[i].src.indexOf("gfsdk")){n=t[i],v.d("_removeRemoteSDK",n),n.parentNode.removeChild(n);break}return e}function s(e,n){e=a(e);var t,i=Array.isArray(n)===!1?[n]:n;v.d("injectScripts",i);var r=document.createElement("meta");r.httpEquiv="Content-Security-Policy",r.content="default-src * data: content: cdvfile: file: http: https: gap: https://ssl.gstatic.com 'unsafe-inline' 'unsafe-eval';style-src * cdvfile: http: https: 'unsafe-inline';",e.head.appendChild(r);for(var o=0;o<i.length;o++)if(i[o].endsWith(".css")){v.d("css inject:",i[o]);var s=e.createElement("link");s.rel="stylesheet",s.href=i[o],e.head.appendChild(s)}else t=document.createElement("script"),t.src=i[o],e.head.appendChild(t);return v.d("Cleaned dom:",e),e}function c(n,t){var i;return o(n).then(function(n){return i=n[0].path,e.readFileAsHTML(n[0].path)}).then(function(e){return v.d("_injectScripts"),v.d(e),s(e,t)}).then(function(e){v.d("Serialize dom");var n=(new XMLSerializer).serializeToString(e),t='<html xmlns="http://www.w3.org/1999/xhtml"';return n=n.replace(t,"<html")}).then(function(n){return v.d("Write dom:",i,n),e.write(i,n)})}function l(e){var n=new RegExp(/index\.html$/i);return n.test(e)}var d,u,f,p,m,g,w={},k="http://s2.motime.com/js/wl/webstore_html5game/gfsdk/dist/gfsdk.js",v=new n("ALL","[Game - module]");i.prototype.download=function(n,t){function i(e){return function(n){var t=Math.round(n.loaded/n.total*100);a({percentage:t,type:e})}}function r(){return s({type:"download"}),v.d("Download:",n.id,n.response_api_dld.binary_url),e.download(n.response_api_dld.binary_url,w.TEMP_DIR,u+".zip",i("download")).then(function(t){return s({type:"unzip"}),v.d("unzip:",n.id,w.TEMP_DIR+u),e._promiseZip(t.path,w.TEMP_DIR+u,i("unzip"))}).then(function(t){v.d("Unzip ended",t),d({type:"unzip"});var i=n.response_api_dld.url_download,r=i.substring(i.lastIndexOf("game"),i.length).split("/"),o="";v.d("Get the right index folder of the game",r);for(var a=0;a<r.length;a++)l(r[a])&&(o=w.TEMP_DIR+[u,r[a-1]].join("/"));return v.d("Copy game folder in games/",o,w.GAMES_DIR+u),e.moveDir(o,w.GAMES_DIR+u)}).then(function(n){return v.d("Remove zip from:",w.TEMP_DIR+u+".zip","last operation result",n),e.removeFile(w.TEMP_DIR+u+".zip")}).then(function(){return v.d("Save meta.json for:",n.id),e.createFile(w.GAMES_DIR+u,"meta.json").then(function(t){return e.write(t.path,JSON.stringify(n))})}).then(function(e){return v.d("result last operation:save meta.json",e),v.d("InjectScripts in game:",n.id,p),c(n.id,[w.GAMEOVER_RELATIVE_DIR+"gameover.css",w.SDK_RELATIVE_DIR+"cordova.js",w.SDK_RELATIVE_DIR+"cordova_plugins.js",w.SDK_RELATIVE_DIR+"gfsdk.min.js",w.SDK_RELATIVE_DIR+"stargate.js"])}).then(function(e){return d({type:"download"}),n.id})}if(this.isDownloading())return Promise.reject(["Downloading...try later",e.currentFileTransfer]);var o=e.dirExists(w.GAMES_DIR+n.id);t=t?t:{};var a=t.onProgress?t.onProgress:function(){},s=t.onStart?t.onStart:function(){},d=t.onEnd?t.onEnd:function(){},u=n.id;return o.then(function(e){return v.d("Exists",e),e?Promise.reject({12:"AlreadyExists",gameID:n.id}):r()})},i.prototype.play=function(n){v.d("Play",n);var t=w.GAMES_DIR+n;return e.readDir(t).then(function(e){return e.filter(function(e){var n=new RegExp(/index\.html$/i);return n.test(e.path)})}).then(function(e){v.d(e);var n=e[0].internalURL;"ios"==window.device.platform.toLowerCase()?(v.d("Play ios",n),window.location.href=n):(v.d("Play android",n),window.navigator.app.loadUrl(encodeURI(n)))})},i.prototype.remove=function(n){return e.removeDir(w.GAMES_DIR+n)},i.prototype.isDownloading=function(){return null!==e.currentFileTransfer||void 0===e.currentFileTransfer},i.prototype.abortDownload=function(){return this.isDownloading()?(e.currentFileTransfer.abort(),e.currentFileTransfer=null,!0):(v.w("There's not a download operation to abort"),!1)},i.prototype.list=function(){return e.readDir(w.GAMES_DIR).then(function(e){var n=Array.isArray(e)?e:[e];return n.map(function(e){return e.path})}).then(function(n){var t=n.map(function(n){return e.readFileAsJSON(n+"meta.json")});return Promise.all(t).then(function(e){return e})})},i.prototype.buildGameOver=function(n){var t=w.GAMES_DIR+n.content_id+"/meta.json";return n.hasOwnProperty("content_id")?(v.d("Read meta.json:",t),v.d("GAMEOVER_TEMPLATE path",w.GAMEOVER_DIR+"gameover.html"),Promise.all([e.readFileAsJSON(t),e.readFile(w.GAMEOVER_DIR+"gameover.html")]).then(function(e){var t=e[1],i=e[0];return t.replace("{{score}}",n.score).replace("{{url_share}}",i.url_share).replace("{{url_cover}}",i.url_cover).replace("{{startpage_url}}",w.WWW_DIR+"startpage.html")})):Promise.reject("Missing content_id key!")};var b={};b.initialize=r,t.game={_protected:b,_public:new i}}(a.file,a.Logger,a);var s=function(){var e={},n=!1;e.init=function(){if(C.hasOwnProperty("webappsfixes")&&"object"==typeof C.webappsfixes){n=!0;for(var e in C.webappsfixes)if(C.webappsfixes.hasOwnProperty(e))if(t.hasOwnProperty(e)&&"function"==typeof t[e]){f("[webappsFixes] applying fix: "+e);var i=t[e](C.webappsfixes[e]);i&&p("[webappsFixes] fix '"+e+"' failed: "+i)}else p("[webappsFixes] fix implementation not found for: "+e)}return n};var t={};return t.gamifiveSearchBox=function(e){if(!window.cordova||!window.cordova.plugins||!window.cordova.plugins.Keyboard)return"missing ionic-plugin-keyboard";if(e.platforms){if(w()&&!e.platforms.ios)return"fix disabled on iOS";if(g()&&!e.platforms.android)return"fix disabled on Android"}return window.addEventListener("native.keyboardshow",function(){setTimeout(function(){0===document.querySelectorAll("input:focus").length&&(f("[webappsFixes] [gamifiveSearchBox] keyboard show on null input: hiding"),cordova.plugins.Keyboard.close())},1)},!1),f("[webappsFixes] [gamifiveSearchBox] listening on event native.keyboardshow"),""},e}();window.pubKey="",window.forge="";var c;o.initializeOffline=function(e){return c?c:("object"!=typeof e&&(e={}),e.hasOwnProperty("hideSplashScreen")||(e.hideSplashScreen=!0),h=!0,c=new Promise(function(i){document.addEventListener("deviceready",function(){x(),k(),n(),Promise.all([cordova.getAppVersion.getVersionNumber(),t()]).then(function(n){D=n[0],"object"!=typeof n[1]&&(n[1]=JSON.parse(n[1])),d=n[1].start_url,C=n[1].stargateConf,e.hideSplashScreen&&(navigator.splashscreen.hide(),T(!1)),y=!0,f("Stargate.initializeOffline() done"),i(!0)})["catch"](function(e){p("initializeOffline() error: "+e)})})}))},o.conf={},o.conf.getWebappStartUrl=function(){return C.webapp_start_url},o.initialize=function(e,n,t,i){if("function"==typeof n&&"undefined"==typeof t&&"undefined"==typeof i&&(i=n),"function"!=typeof i){p("Stargate.initialize() callback is not a function!");var o=Q.defer();return setTimeout(function(){o.reject(new Error("Stargate.initialize() callback is not a function!"))},1),o.promise}if(b=O(),h){p("Stargate.initialize() already called, executing callback."),i&&i(b);var a=Q.defer();return setTimeout(function(){a.resolve(b)},1),a.promise}if(h=!0,e.country&&(A=e.country),e.hybrid_conf&&(I="object"==typeof e.hybrid_conf?e.hybrid_conf:JSON.parse(decodeURIComponent(e.hybrid_conf))),!b){f("version "+r+" running outside hybrid; loaded from server version: v"+u),i(b);var s=Q.defer();return setTimeout(function(){s.resolve(b)},1),s.promise}return f("initialize() starting up, configuration: ",I),S=i,_=Q.defer(),document.addEventListener("deviceready",P,!1),_.promise},o.isInitialized=function(){return h},o.isOpen=function(){return y},o.isHybrid=function(){return O()},o.openUrl=function(e){return h?void window.open(e,"_system"):p("Stargate not initialized, call Stargate.initialize first!")},o.googleLogin=function(e,n){return h?(p("unimplemented"),void n("unimplemented")):n("Stargate not initialized, call Stargate.initialize first!")};var l={type:"unknown",networkState:"unknown"};window.addEventListener("online",e,!1),window.addEventListener("offline",e,!1),o.checkConnection=function(){var e=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return h?"function"!=typeof navigator.connection.getInfo?(n("Missing cordova plugin"),console.warn("Cordova Network Information module missing"),!1):(e(l),l):(n("Stargate not initialized, call Stargate.initialize first!"),!1)},o.getDeviceID=function(e,n){if(!h)return n("Stargate not initialized, call Stargate.initialize first!");var t=m.uuid;e({deviceID:t})},o.setStatusbarVisibility=function(e,n,t){return h?"undefined"==typeof window.StatusBar?(p("[StatusBar] missing cordova plugin"),t("missing cordova plugin")):e?(window.StatusBar.show(),n("statusbar shown")):(window.StatusBar.hide(),n("statusbar hided")):t("Stargate not initialized, call Stargate.initialize first!")},o.getVersion=function(){return r},o.ad=new i;var d,u="2",f=console.log.bind(window.console,"[Stargate] "),p=console.error.bind(window.console,"[Stargate] "),m={available:!1,cordova:"",manufacturer:"",model:"",platform:"",uuid:"",version:""},g=function(){return"Android"==m.platform},w=function(){return"iOS"==m.platform},k=function(){if("undefined"==typeof window.device)return p("Missing cordova device plugin");for(var e in m)window.device.hasOwnProperty(e)&&(m[e]=window.device[e]);return!0},v=function(e){f("launchUrl: "+e),document.location.href=e},b=!1,h=!1,y=!1,S=null,_=null,D="",A="",I={},R=function(){if("undefined"==typeof window.StatusBar)return p("[StatusBar] missing cordova plugin");if("undefined"!=typeof C.statusbar&&"undefined"!=typeof C.statusbar.hideOnUrlPattern&&C.statusbar.hideOnUrlPattern.constructor===Array){for(var e=document.location.href,n=!1,t=0;t<C.statusbar.hideOnUrlPattern.length;t++){var i=new RegExp(C.statusbar.hideOnUrlPattern[t]);if(i.test(e)){n=!0;break}}n?window.StatusBar.hide():window.StatusBar.show()}},x=function(){window.Cookies.set("hybrid","1"),window.Cookies.set("stargateVersion",u),window.localStorage.getItem("hybrid")||window.localStorage.setItem("hybrid",1),window.localStorage.getItem("stargateVersion")||window.localStorage.setItem("stargateVersion",u)},E=function(){if(document.title=C.title,w()&&"undefined"!=typeof window.cordova&&cordova.require){var e=cordova.require("cordova/exec");e.setJsToNativeBridgeMode(e.jsToNativeModes.IFRAME_NAV)}R(),U("mfp")&&z.check(),U("deltadna")&&window.deltadna.startSDK(C.deltadna.environmentKey,C.deltadna.collectApi,C.deltadna.engageApi,V,J,C.deltadna.settings),navigator.splashscreen.hide(),T(!1),B.initialize(),Y.init(),s.init(),U("game")&&a.game&&a.game._protected.initialize({}),y=!0,f("version "+r+" ready; loaded from server version: v"+u+" running in package version: "+D),S(!0),f("Stargate.initialize() done"),_.resolve(!0)},P=function(){x(),k(),n(),Q.all([cordova.getAppVersion.getVersionNumber(),t()]).then(function(e){D=e[0],"object"!=typeof e[1]&&(e[1]=JSON.parse(e[1])),d=e[1].start_url,C=e[1].stargateConf,E()}).fail(function(e){p("onDeviceReady() error: "+e)})},O=function(){var e=window.URI(document.location.href);return e.hasQuery("hybrid")?!0:window.Cookies.get("hybrid")?!0:window.localStorage.getItem("hybrid")?!0:!1},F=!1,T=function(e){e?(F=!0,j()):(F=!1,N())},C={features:{}},U=function(e){return"undefined"!=typeof C.features[e]&&C.features[e]},z=function(){var e={};return e.check=function(){return A?void e.get(A):p("Country not defined!")},e.getContents=function(e,n,t,i){var r={};r.api_country=t,r.country=e,r.fpnamespace=n,i&&(r.extData=i);var o=JSON.stringify(r);return o},e.getPonyValue=function(e){try{return e.split("=")[1]}catch(n){p(n)}return""},e.setSession=function(n){var t=d;window.localStorage.getItem("appUrl")&&(t=window.localStorage.getItem("appUrl"));var i=new URI(d),r=i.hostname(),o=URITemplate(C.api.mfpSetUriTemplate).expand({protocol:i.protocol(),hostname:r,url:t,domain:r,_PONY:e.getPonyValue(n)});f("[MobileFingerPrint] going to url: ",o),v(o)},e.get=function(n){var t="",i=URITemplate(C.api.mfpGetUriTemplate).expand({apikey:C.motime_apikey,contents_inapp:e.getContents(n,C.namespace,C.label),country:n,expire:t});window.aja().url(i).type("jsonp").on("success",function(n){f("[MobileFingerPrint] get() response: ",n);var t="";if(n.content.inappInfo){var i=JSON.parse(n.content.inappInfo);i.extData&&(i.extData.ponyUrl&&(t=i.extData.ponyUrl),i.extData.return_url&&window.localStorage.setItem("appUrl",i.extData.return_url),i.extData.session_mfp&&K.track({page:"hybrid_initialize",action:"MFP_get",session_mfp:i.extData.session_mfp})),e.setSession(t)}else f("[MobileFingerPrint] get(): Empty session")}).on("error",function(e){p("[MobileFingerPrint] get() error: ",e)}).go()},{check:e.check}}(),L=function(){"use strict";function e(e,n){var t=(65535&e)+(65535&n),i=(e>>16)+(n>>16)+(t>>16);return i<<16|65535&t}function n(e,n){return e<<n|e>>>32-n}function t(t,i,r,o,a,s){return e(n(e(e(i,t),e(o,s)),a),r)}function i(e,n,i,r,o,a,s){return t(n&i|~n&r,e,n,o,a,s)}function r(e,n,i,r,o,a,s){return t(n&r|i&~r,e,n,o,a,s)}function o(e,n,i,r,o,a,s){return t(n^i^r,e,n,o,a,s)}function a(e,n,i,r,o,a,s){return t(i^(n|~r),e,n,o,a,s)}function s(n,t){n[t>>5]|=128<<t%32,n[(t+64>>>9<<4)+14]=t;var s,c,l,d,u,f=1732584193,p=-271733879,m=-1732584194,g=271733878;for(s=0;s<n.length;s+=16)c=f,l=p,d=m,u=g,f=i(f,p,m,g,n[s],7,-680876936),g=i(g,f,p,m,n[s+1],12,-389564586),m=i(m,g,f,p,n[s+2],17,606105819),p=i(p,m,g,f,n[s+3],22,-1044525330),f=i(f,p,m,g,n[s+4],7,-176418897),g=i(g,f,p,m,n[s+5],12,1200080426),m=i(m,g,f,p,n[s+6],17,-1473231341),p=i(p,m,g,f,n[s+7],22,-45705983),f=i(f,p,m,g,n[s+8],7,1770035416),g=i(g,f,p,m,n[s+9],12,-1958414417),m=i(m,g,f,p,n[s+10],17,-42063),p=i(p,m,g,f,n[s+11],22,-1990404162),f=i(f,p,m,g,n[s+12],7,1804603682),g=i(g,f,p,m,n[s+13],12,-40341101),m=i(m,g,f,p,n[s+14],17,-1502002290),p=i(p,m,g,f,n[s+15],22,1236535329),f=r(f,p,m,g,n[s+1],5,-165796510),g=r(g,f,p,m,n[s+6],9,-1069501632),m=r(m,g,f,p,n[s+11],14,643717713),p=r(p,m,g,f,n[s],20,-373897302),f=r(f,p,m,g,n[s+5],5,-701558691),g=r(g,f,p,m,n[s+10],9,38016083),m=r(m,g,f,p,n[s+15],14,-660478335),p=r(p,m,g,f,n[s+4],20,-405537848),f=r(f,p,m,g,n[s+9],5,568446438),g=r(g,f,p,m,n[s+14],9,-1019803690),m=r(m,g,f,p,n[s+3],14,-187363961),p=r(p,m,g,f,n[s+8],20,1163531501),f=r(f,p,m,g,n[s+13],5,-1444681467),g=r(g,f,p,m,n[s+2],9,-51403784),m=r(m,g,f,p,n[s+7],14,1735328473),p=r(p,m,g,f,n[s+12],20,-1926607734),f=o(f,p,m,g,n[s+5],4,-378558),g=o(g,f,p,m,n[s+8],11,-2022574463),m=o(m,g,f,p,n[s+11],16,1839030562),p=o(p,m,g,f,n[s+14],23,-35309556),f=o(f,p,m,g,n[s+1],4,-1530992060),g=o(g,f,p,m,n[s+4],11,1272893353),m=o(m,g,f,p,n[s+7],16,-155497632),p=o(p,m,g,f,n[s+10],23,-1094730640),f=o(f,p,m,g,n[s+13],4,681279174),g=o(g,f,p,m,n[s],11,-358537222),m=o(m,g,f,p,n[s+3],16,-722521979),p=o(p,m,g,f,n[s+6],23,76029189),f=o(f,p,m,g,n[s+9],4,-640364487),g=o(g,f,p,m,n[s+12],11,-421815835),m=o(m,g,f,p,n[s+15],16,530742520),p=o(p,m,g,f,n[s+2],23,-995338651),f=a(f,p,m,g,n[s],6,-198630844),g=a(g,f,p,m,n[s+7],10,1126891415),m=a(m,g,f,p,n[s+14],15,-1416354905),p=a(p,m,g,f,n[s+5],21,-57434055),f=a(f,p,m,g,n[s+12],6,1700485571),g=a(g,f,p,m,n[s+3],10,-1894986606),m=a(m,g,f,p,n[s+10],15,-1051523),p=a(p,m,g,f,n[s+1],21,-2054922799),f=a(f,p,m,g,n[s+8],6,1873313359),g=a(g,f,p,m,n[s+15],10,-30611744),m=a(m,g,f,p,n[s+6],15,-1560198380),p=a(p,m,g,f,n[s+13],21,1309151649),f=a(f,p,m,g,n[s+4],6,-145523070),g=a(g,f,p,m,n[s+11],10,-1120210379),m=a(m,g,f,p,n[s+2],15,718787259),p=a(p,m,g,f,n[s+9],21,-343485551),f=e(f,c),p=e(p,l),m=e(m,d),g=e(g,u);return[f,p,m,g]}function c(e){var n,t="";for(n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function l(e){var n,t=[];for(t[(e.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;for(n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function d(e){return c(s(l(e),8*e.length))}function u(e,n){var t,i,r=l(e),o=[],a=[];for(o[15]=a[15]=void 0,r.length>16&&(r=s(r,8*e.length)),t=0;16>t;t+=1)o[t]=909522486^r[t],a[t]=1549556828^r[t];return i=s(o.concat(l(n)),512+8*n.length),c(s(a.concat(i),640))}function f(e){var n,t,i="0123456789abcdef",r="";for(t=0;t<e.length;t+=1)n=e.charCodeAt(t),r+=i.charAt(n>>>4&15)+i.charAt(15&n);return r}function p(e){return unescape(encodeURIComponent(e))}function m(e){return d(p(e))}function g(e){return f(m(e))}function w(e,n){return u(p(e),p(n))}function k(e,n){return f(w(e,n))}function v(e,n,t){return n?t?w(n,e):k(n,e):t?m(e):g(e)}return v}(),M=function(){function e(e){var n=document.getElementsByTagName("head")[0],t=document.createElement("style");t.setAttribute("type","text/css"),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),n.appendChild(t)}var n="#holdon-overlay {\n    filter: alpha(opacity=80);\n    position:fixed; \n    width:100%; \n    height:100%;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    background: #000;\n    opacity: 0;\n    z-index: 9999;\n    transition: opacity 300ms linear;\n    -moz-transition: opacity 300ms linear;\n    -webkit-transition: opacity 300ms linear;\n}\n#holdon-overlay.show {\n  opacity: 0.8;\n}\n#holdon-content-container{\n    width: 100%;\n    padding: 0;\n    vertical-align: middle;\n    display: table-cell !important;\n    margin: 0;\n    text-align: center;\n}\n#holdon-content {\n    text-align: center;\n    width: 50px;\n    height: 57px;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: -28px 0 0 -25px;\n}\n#holdon-message {\n    width:100%;\n    text-align: center;\n    position: absolute;\n    top: 55%;\n    color:white;\n}\n.sk-rect {\n  width: 50px;\n  height: 40px;\n  text-align: center;\n  font-size: 10px;\n}\n.sk-rect > div {\n  background-color: #333;\n  height: 100%;\n  width: 6px;\n  display: inline-block;\n  -webkit-animation: sk-rect-anim 1.2s infinite ease-in-out;\n  animation: sk-rect-anim 1.2s infinite ease-in-out;\n}\n.sk-rect .rect2 {\n  -webkit-animation-delay: -1.1s;\n  animation-delay: -1.1s;\n}\n.sk-rect .rect3 {\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n.sk-rect .rect4 {\n  -webkit-animation-delay: -0.9s;\n  animation-delay: -0.9s;\n}\n.sk-rect .rect5 {\n  -webkit-animation-delay: -0.8s;\n  animation-delay: -0.8s;\n}\n@-webkit-keyframes sk-rect-anim {\n  0%, 40%, 100% { -webkit-transform: scaleY(0.4) }  \n  20% { -webkit-transform: scaleY(1.0) }\n}\n@keyframes sk-rect-anim {\n  0%, 40%, 100% { \n    transform: scaleY(0.4);\n    -webkit-transform: scaleY(0.4);\n  }  20% { \n    transform: scaleY(1.0);\n    -webkit-transform: scaleY(1.0);\n  }\n}\n.sk-cube {\n  width: 50px;\n  height: 40px;\n  text-align: center;\n  font-size: 10px;\n}\n.sk-cube1, .sk-cube2 {\n  background-color: #333;\n  width: 15px;\n  height: 15px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  \n  -webkit-animation: sk-cube 1.8s infinite ease-in-out;\n  animation: sk-cube 1.8s infinite ease-in-out;\n}\n.sk-cube2 {\n  -webkit-animation-delay: -0.9s;\n  animation-delay: -0.9s;\n}\n@-webkit-keyframes sk-cube {\n  25% { -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5) }\n  50% { -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg) }\n  75% { -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5) }\n  100% { -webkit-transform: rotate(-360deg) }\n}\n@keyframes sk-cube {\n  25% { \n    transform: translateX(42px) rotate(-90deg) scale(0.5);\n    -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5);\n  } 50% { \n    transform: translateX(42px) translateY(42px) rotate(-179deg);\n    -webkit-transform: translateX(42px) translateY(42px) rotate(-179deg);\n  } 50.1% { \n    transform: translateX(42px) translateY(42px) rotate(-180deg);\n    -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg);\n  } 75% { \n    transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n    -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n  } 100% { \n    transform: rotate(-360deg);\n    -webkit-transform: rotate(-360deg);\n  }\n}\n.sk-dot {\n    width: 50px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n    -webkit-animation: sk-dot-rotate 2.0s infinite linear;\n    animation: sk-dot-rotate 2.0s infinite linear;\n}\n.sk-dot1, .sk-dot2 {\n  width: 60%;\n  height: 60%;\n  display: inline-block;\n  position: absolute;\n  top: 0;\n  background-color: #333;\n  border-radius: 100%;\n  \n  -webkit-animation: sk-dot-bounce 2.0s infinite ease-in-out;\n  animation: sk-dot-bounce 2.0s infinite ease-in-out;\n}\n.sk-dot2 {\n  top: auto;\n  bottom: 0;\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n@-webkit-keyframes sk-dot-rotate { 100% { -webkit-transform: rotate(360deg) }}\n@keyframes sk-dot-rotate { 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg) }}\n@-webkit-keyframes sk-dot-bounce {\n  0%, 100% { -webkit-transform: scale(0.0) }\n  50% { -webkit-transform: scale(1.0) }\n}\n@keyframes sk-dot-bounce {\n  0%, 100% { \n    transform: scale(0.0);\n    -webkit-transform: scale(0.0);\n  } 50% { \n    transform: scale(1.0);\n    -webkit-transform: scale(1.0);\n  }\n}\n.sk-bounce {\n    width: 60px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-bounce > div {\n  width: 18px;\n  height: 18px;\n  background-color: #333;\n  border-radius: 100%;\n  display: inline-block;\n  -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n  animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n}\n.sk-bounce .bounce1 {\n    -webkit-animation-delay: -0.32s;\n    animation-delay: -0.32s;\n}\n.sk-bounce .bounce2 {\n  -webkit-animation-delay: -0.16s;\n  animation-delay: -0.16s;\n}\n@-webkit-keyframes sk-bouncedelay {\n  0%, 80%, 100% { -webkit-transform: scale(0) }\n  40% { -webkit-transform: scale(1.0) }\n}\n@keyframes sk-bouncedelay {\n  0%, 80%, 100% { \n    -webkit-transform: scale(0);\n    transform: scale(0);\n  } 40% { \n    -webkit-transform: scale(1.0);\n    transform: scale(1.0);\n  }\n}\n.sk-circle {\n    width: 60px;\n    height: 40px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-circle .sk-child {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.sk-circle .sk-child:before {\n  content: '';\n  display: block;\n  margin: 0 auto;\n  width: 15%;\n  height: 15%;\n  background-color: #333;\n  border-radius: 100%;\n  -webkit-animation: sk-circleBounceDelay 1.2s infinite ease-in-out both;\n          animation: sk-circleBounceDelay 1.2s infinite ease-in-out both;\n}\n.sk-circle .sk-circle2 {\n  -webkit-transform: rotate(30deg);\n      -ms-transform: rotate(30deg);\n          transform: rotate(30deg); }\n.sk-circle .sk-circle3 {\n  -webkit-transform: rotate(60deg);\n      -ms-transform: rotate(60deg);\n          transform: rotate(60deg); }\n.sk-circle .sk-circle4 {\n  -webkit-transform: rotate(90deg);\n      -ms-transform: rotate(90deg);\n          transform: rotate(90deg); }\n.sk-circle .sk-circle5 {\n  -webkit-transform: rotate(120deg);\n      -ms-transform: rotate(120deg);\n          transform: rotate(120deg); }\n.sk-circle .sk-circle6 {\n  -webkit-transform: rotate(150deg);\n      -ms-transform: rotate(150deg);\n          transform: rotate(150deg); }\n.sk-circle .sk-circle7 {\n  -webkit-transform: rotate(180deg);\n      -ms-transform: rotate(180deg);\n          transform: rotate(180deg); }\n.sk-circle .sk-circle8 {\n  -webkit-transform: rotate(210deg);\n      -ms-transform: rotate(210deg);\n          transform: rotate(210deg); }\n.sk-circle .sk-circle9 {\n  -webkit-transform: rotate(240deg);\n      -ms-transform: rotate(240deg);\n          transform: rotate(240deg); }\n.sk-circle .sk-circle10 {\n  -webkit-transform: rotate(270deg);\n      -ms-transform: rotate(270deg);\n          transform: rotate(270deg); }\n.sk-circle .sk-circle11 {\n  -webkit-transform: rotate(300deg);\n      -ms-transform: rotate(300deg);\n          transform: rotate(300deg); }\n.sk-circle .sk-circle12 {\n  -webkit-transform: rotate(330deg);\n      -ms-transform: rotate(330deg);\n          transform: rotate(330deg); }\n.sk-circle .sk-circle2:before {\n  -webkit-animation-delay: -1.1s;\n          animation-delay: -1.1s; }\n.sk-circle .sk-circle3:before {\n  -webkit-animation-delay: -1s;\n          animation-delay: -1s; }\n.sk-circle .sk-circle4:before {\n  -webkit-animation-delay: -0.9s;\n          animation-delay: -0.9s; }\n.sk-circle .sk-circle5:before {\n  -webkit-animation-delay: -0.8s;\n          animation-delay: -0.8s; }\n.sk-circle .sk-circle6:before {\n  -webkit-animation-delay: -0.7s;\n          animation-delay: -0.7s; }\n.sk-circle .sk-circle7:before {\n  -webkit-animation-delay: -0.6s;\n          animation-delay: -0.6s; }\n.sk-circle .sk-circle8:before {\n  -webkit-animation-delay: -0.5s;\n          animation-delay: -0.5s; }\n.sk-circle .sk-circle9:before {\n  -webkit-animation-delay: -0.4s;\n          animation-delay: -0.4s; }\n.sk-circle .sk-circle10:before {\n  -webkit-animation-delay: -0.3s;\n          animation-delay: -0.3s; }\n.sk-circle .sk-circle11:before {\n  -webkit-animation-delay: -0.2s;\n          animation-delay: -0.2s; }\n.sk-circle .sk-circle12:before {\n  -webkit-animation-delay: -0.1s;\n          animation-delay: -0.1s; }\n@-webkit-keyframes sk-circleBounceDelay {\n  0%, 80%, 100% {\n    -webkit-transform: scale(0);\n            transform: scale(0);\n  } 40% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n}\n@keyframes sk-circleBounceDelay {\n  0%, 80%, 100% {\n    -webkit-transform: scale(0);\n            transform: scale(0);\n  } 40% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n}\n.sk-cube-grid {\n    width: 60px;\n    height: 60px;\n    text-align: center;\n    font-size: 10px;\n}\n.sk-cube-grid .sk-cube-child {\n  width: 33%;\n  height: 33%;\n  background-color: #333;\n  float: left;\n  -webkit-animation: sk-cubeGridScaleDelay 1.3s infinite ease-in-out;\n          animation: sk-cubeGridScaleDelay 1.3s infinite ease-in-out; \n}\n.sk-cube-grid .sk-cube-grid1 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n.sk-cube-grid .sk-cube-grid2 {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s; }\n.sk-cube-grid .sk-cube-grid3 {\n  -webkit-animation-delay: 0.4s;\n          animation-delay: 0.4s; }\n.sk-cube-grid .sk-cube-grid4 {\n  -webkit-animation-delay: 0.1s;\n          animation-delay: 0.1s; }\n.sk-cube-grid .sk-cube-grid5 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n.sk-cube-grid .sk-cube-grid6 {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s; }\n.sk-cube-grid .sk-cube-grid7 {\n  -webkit-animation-delay: 0s;\n          animation-delay: 0s; }\n.sk-cube-grid .sk-cube-grid8 {\n  -webkit-animation-delay: 0.1s;\n          animation-delay: 0.1s; }\n.sk-cube-grid .sk-cube-grid9 {\n  -webkit-animation-delay: 0.2s;\n          animation-delay: 0.2s; }\n@-webkit-keyframes sk-cubeGridScaleDelay {\n  0%, 70%, 100% {\n    -webkit-transform: scale3D(1, 1, 1);\n            transform: scale3D(1, 1, 1);\n  } 35% {\n    -webkit-transform: scale3D(0, 0, 1);\n            transform: scale3D(0, 0, 1); \n  }\n}\n@keyframes sk-cubeGridScaleDelay {\n  0%, 70%, 100% {\n    -webkit-transform: scale3D(1, 1, 1);\n            transform: scale3D(1, 1, 1);\n  } 35% {\n    -webkit-transform: scale3D(0, 0, 1);\n            transform: scale3D(0, 0, 1);\n  } \n}\n.sk-folding-cube {\n  margin: 20px auto;\n  width: 40px;\n  height: 40px;\n  position: relative;\n  -webkit-transform: rotateZ(45deg);\n          transform: rotateZ(45deg);\n}\n.sk-folding-cube .sk-cube-parent {\n  float: left;\n  width: 50%;\n  height: 50%;\n  position: relative;\n  -webkit-transform: scale(1.1);\n      -ms-transform: scale(1.1);\n          transform: scale(1.1); \n}\n.sk-folding-cube .sk-cube-parent:before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: #333;\n  -webkit-animation: sk-foldCubeAngle 2.4s infinite linear both;\n          animation: sk-foldCubeAngle 2.4s infinite linear both;\n  -webkit-transform-origin: 100% 100%;\n      -ms-transform-origin: 100% 100%;\n          transform-origin: 100% 100%;\n}\n.sk-folding-cube .sk-cubechild2 {\n  -webkit-transform: scale(1.1) rotateZ(90deg);\n          transform: scale(1.1) rotateZ(90deg);\n}\n.sk-folding-cube .sk-cubechild3 {\n  -webkit-transform: scale(1.1) rotateZ(180deg);\n          transform: scale(1.1) rotateZ(180deg);\n}\n.sk-folding-cube .sk-cubechild4 {\n  -webkit-transform: scale(1.1) rotateZ(270deg);\n          transform: scale(1.1) rotateZ(270deg);\n}\n.sk-folding-cube .sk-cubechild2:before {\n  -webkit-animation-delay: 0.3s;\n          animation-delay: 0.3s;\n}\n.sk-folding-cube .sk-cubechild3:before {\n  -webkit-animation-delay: 0.6s;\n          animation-delay: 0.6s; \n}\n.sk-folding-cube .sk-cubechild4:before {\n  -webkit-animation-delay: 0.9s;\n          animation-delay: 0.9s;\n}\n@-webkit-keyframes sk-foldCubeAngle {\n  0%, 10% {\n    -webkit-transform: perspective(140px) rotateX(-180deg);\n            transform: perspective(140px) rotateX(-180deg);\n    opacity: 0; \n  } 25%, 75% {\n    -webkit-transform: perspective(140px) rotateX(0deg);\n            transform: perspective(140px) rotateX(0deg);\n    opacity: 1; \n  } 90%, 100% {\n    -webkit-transform: perspective(140px) rotateY(180deg);\n            transform: perspective(140px) rotateY(180deg);\n    opacity: 0; \n  } \n}\n@keyframes sk-foldCubeAngle {\n  0%, 10% {\n    -webkit-transform: perspective(140px) rotateX(-180deg);\n            transform: perspective(140px) rotateX(-180deg);\n    opacity: 0; \n  } 25%, 75% {\n    -webkit-transform: perspective(140px) rotateX(0deg);\n            transform: perspective(140px) rotateX(0deg);\n    opacity: 1; \n  } 90%, 100% {\n    -webkit-transform: perspective(140px) rotateY(180deg);\n            transform: perspective(140px) rotateY(180deg);\n    opacity: 0; \n  }\n}\n",t=!1,i=function(e){
var n=document.createElement("div");return n.innerHTML=e,n.firstChild},r={};return r.start=function(r){t||(e(n),t=!0);var o=document.querySelector("#holdon-overlay");o&&(o.parentNode.removeChild(o),o=null);var a="sk-rect",s="",c="";switch(r&&(r.hasOwnProperty("theme")&&(a=r.theme),r.hasOwnProperty("message")&&(c=r.message)),a){case"custom":s='<div style="text-align: center;">'+r.content+"</div>";break;case"sk-dot":s='<div class="sk-dot"> <div class="sk-dot1"></div> <div class="sk-dot2"></div> </div>';break;case"sk-rect":s='<div class="sk-rect"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>';break;case"sk-cube":s='<div class="sk-cube"> <div class="sk-cube1"></div> <div class="sk-cube2"></div> </div>';break;case"sk-bounce":s='<div class="sk-bounce"> <div class="bounce1"></div> <div class="bounce2"></div> <div class="bounce3"></div> </div>';break;case"sk-circle":s='<div class="sk-circle"> <div class="sk-circle1 sk-child"></div> <div class="sk-circle2 sk-child"></div> <div class="sk-circle3 sk-child"></div> <div class="sk-circle4 sk-child"></div> <div class="sk-circle5 sk-child"></div> <div class="sk-circle6 sk-child"></div> <div class="sk-circle7 sk-child"></div> <div class="sk-circle8 sk-child"></div> <div class="sk-circle9 sk-child"></div> <div class="sk-circle10 sk-child"></div> <div class="sk-circle11 sk-child"></div> <div class="sk-circle12 sk-child"></div> </div>';break;case"sk-cube-grid":s='<div class="sk-cube-grid"> <div class="sk-cube-child sk-cube-grid1"></div> <div class="sk-cube-child sk-cube-grid2"></div> <div class="sk-cube-child sk-cube-grid3"></div> <div class="sk-cube-child sk-cube-grid4"></div> <div class="sk-cube-child sk-cube-grid5"></div> <div class="sk-cube-child sk-cube-grid6"></div> <div class="sk-cube-child sk-cube-grid7"></div> <div class="sk-cube-child sk-cube-grid8"></div> <div class="sk-cube-child sk-cube-grid9"></div> </div>';break;case"sk-folding-cube":s='<div class="sk-folding-cube"> <div class="sk-cubechild1 sk-cube-parent"></div> <div class="sk-cubechild2 sk-cube-parent"></div> <div class="sk-cubechild4 sk-cube-parent"></div> <div class="sk-cubechild3 sk-cube-parent"></div> </div>';break;default:s='<div class="sk-rect"> <div class="rect1"></div> <div class="rect2"></div> <div class="rect3"></div> <div class="rect4"></div> <div class="rect5"></div> </div>',p("[loading] "+a+" doesn't exist")}var l='<div id="holdon-overlay">\n   <div id="holdon-content-container">\n       <div id="holdon-content">'+s+'</div>\n       <div id="holdon-message">'+c+"</div>\n   </div>\n</div>",d=document.getElementsByTagName("body")[0],u=i(l);r&&r.backgroundColor&&(u.style.backgroundColor=r.backgroundColor,u.querySelector("#holdon-message").style.color=r.textColor),d.appendChild(u),u=null,setTimeout(function(){var e=document.getElementById("holdon-overlay");e.classList.add("show")},1)},r.stop=function(){var e=document.querySelector("#holdon-overlay");e&&(e.classList.remove("show"),setTimeout(function(){e.parentNode.removeChild(e),e=null},500))},r}(),j=function(e){"object"!=typeof e&&(e={}),e.theme||(e.theme="sk-circle"),M.start(e)},N=function(){M.stop()},G=function(e){var n=document.querySelector("#holdon-message");return n?(n.textContent=e,!0):!1};"object"!=typeof o.test&&(o.test={}),"object"!=typeof o.test.loading&&(o.test.loading={}),o.test.loading.start=j,o.test.loading.stop=N,o.test.loading.change=G,window.startLoading=j,window.stopLoading=N;var B={id:"",alias:"",type:"",verbosity:"",paymethod:"",subscribeMethod:"stargate",returnUrl:"",callbackSuccess:function(){f("[IAP] Undefined callbackSuccess")},callbackError:function(){f("[IAP] Undefined callbackError")},refreshDone:!1,lastCreateuserUrl:"",lastCreateuserData:"",createUserAttempt:0,maxCreateUserAttempt:6,initialize:function(){return window.store?(B.returnUrl=document.location.href,I.IAP.id&&(B.id=I.IAP.id),I.IAP.alias&&(B.alias=I.IAP.alias),I.IAP.type&&(B.type=I.IAP.type),B.verbosity="INFO",B.paymethod=g()?"gwallet":"itunes",f("IAP initialize id: "+B.id),g()&&B.getGoogleAccount(),window.store.verbosity=window.store[B.verbosity],window.store.register({id:B.id,alias:B.alias,type:window.store[B.type]}),window.store.when(B.alias).approved(function(e){B.onPurchaseApproved(e)}),window.store.when(B.alias).verified(function(e){B.onPurchaseVerified(e)}),window.store.when(B.alias).updated(function(e){B.onProductUpdate(e)}),window.store.when(B.alias).owned(function(e){B.onProductOwned(e)}),window.store.when(B.alias).cancelled(function(e){B.onCancelledProduct(e)}),window.store.when(B.alias).error(function(e){B.error(JSON.stringify(e))}),window.store.ready(function(){B.onStoreReady()}),void window.store.when("order "+B.id).approved(function(e){B.onOrderApproved(e)})):void p("Store not available")},doRefresh:function(e){(!B.refreshDone||e)&&(window.store.refresh(),B.refreshDone=!0)},getPassword:function(e){return L("iap."+e+".playme").substr(0,8)},getGoogleAccount:function(){window.accountmanager.getAccounts(B.checkGoogleAccount,B.error,"com.google")},checkGoogleAccount:function(e){if(e){f("[IAP] accounts"),f(e);for(var n in e)return window.localStorage.setItem("googleAccount",e[n].email),e[n].email}},onProductUpdate:function(e){f("IAP> Product updated."),f(JSON.stringify(e)),f(e.owned?"[IAP] Subscribed!":"[IAP] Not Subscribed")},onPurchaseApproved:function(e){f("IAP> Purchase approved."),f(JSON.stringify(e)),e.finish()},onPurchaseVerified:function(e){f("subscription verified ",e)},onStoreReady:function(){f("\\o/ STORE READY \\o/")},onProductOwned:function(e){if(f("[IAP] > Product Owned."),!e.transaction.id&&w())return f("[IAP] > no transaction id"),!1;if(window.localStorage.setItem("product",e),w()&&window.localStorage.setItem("transaction_id",e.transaction.id),g()){var n=e.transaction.purchaseToken+"|"+C.id+"|"+B.id;f("[IAP] Purchase Token: "+n),window.localStorage.getItem("user_account")||B.createUser(e,n)}else window.storekit.loadReceipts(function(n){window.localStorage.getItem("user_account")||(n.appStoreReceipt?(f("[IAP] appStoreReceipt: "+n.appStoreReceipt),B.createUser(e,n.appStoreReceipt)):f("[IAP] appStoreReceipt empty, ignoring request"))})},onCancelledProduct:function(e){T(!1),B.callbackError({iap_cancelled:1,return_url:B.returnUrl}),f("[IAP] > Purchase cancelled ##################################",e)},onOrderApproved:function(e){f("[IAP] ORDER APPROVED "+B.id),e.finish()},error:function(e){T(!1),B.callbackError({iap_error:1,return_url:B.returnUrl}),p("[IAP] error: "+e)},createUser:function(e,n){f("[IAP] createUser start "),window.localStorage.setItem("user_account",g()?window.localStorage.getItem("googleAccount")?window.localStorage.getItem("googleAccount"):n+"@google.com":e.transaction.id+"@itunes.com");var t=B.subscribeMethod,i={paymethod:B.paymethod,user_account:window.localStorage.getItem("user_account"),purchase_token:n,return_url:B.returnUrl,inapp_pwd:B.getPassword(n),hybrid:1};B.lastCreateuserUrl=t,B.lastCreateuserData=i;var r=function(e){if(B.createUserAttempt<=B.maxCreateUserAttempt)p("[IAP] createUser failed "+B.createUserAttempt+" times, trying again... last error: "+JSON.stringify(e)),s();else{f("[IAP] createUser onCreateError: removing user_account"),window.localStorage.removeItem("user_account");var n={iap_error:"1",return_url:B.returnUrl};T(!1),B.callbackError(n)}},o=function(e){f("[IAP] createUser success ",e);try{e.device_id=m.uuid,window.localStorage.getItem("transaction_id")&&(e.transaction_id=window.localStorage.getItem("transaction_id")),T(!1),B.callbackSuccess(e)}catch(n){r(n)}},a=10,s=function(){setTimeout(function(){B.createUserAttempt=B.createUserAttempt+1,f("[IAP] createUser attempt: "+B.createUserAttempt+" with timeout: "+a+"sec."),window.aja().method("POST").url(B.lastCreateuserUrl).cache(!1).timeout(1e3*a).data(B.lastCreateuserData).on("success",function(e){o(e)}).on("error",function(e){r(e)}).on("4**",function(e){r(e)}).on("5**",function(e){r(e)}).on("timeout",function(){r("timeout")}).on("end",function(){f("[IAP] createUser end"),T(!1)}).go(),a+=5},10)};B.createUserAttempt=0,s()}};o.inAppPurchaseSubscription=function(e,n,t,i){return h?(T(!0),"undefined"!=typeof i&&(B.returnUrl=i),"undefined"!=typeof t&&(B.subscribeMethod=t),B.callbackSuccess=e,B.callbackError=n,B.doRefresh(),void window.store.order(B.id)):n("Stargate not initialized, call Stargate.initialize first!")},o.inAppRestore=function(e,n,t,i){return h?("undefined"!=typeof t&&(B.subscribeMethod=t),"undefined"!=typeof i&&(B.returnUrl=i),B.callbackSuccess=e,B.callbackError=n,void B.doRefresh(!0)):n("Stargate not initialized, call Stargate.initialize first!")},o.facebookLogin=function(e,n,t){return h?void facebookConnectPlugin.login(e.split(","),function(e){f("[facebook] got userdata: ",e),facebookConnectPlugin.getAccessToken(function(e){n({accessToken:e})},function(e){t({error:e})})},function(e){p("Got FB login error:",e),t({error:e})}):t("Stargate not initialized, call Stargate.initialize first!")},o.facebookShare=function(e,n,t){if(!h)return t("Stargate not initialized, call Stargate.initialize first!");var i={method:"share",href:e};facebookConnectPlugin.showDialog(i,function(e){n({message:e})},function(e){p("Got FB share error:",e),t({error:e})})};var V=function(){deltadna.registerPushCallback(X)},J=function(e){p("[DeltaDNA] error: "+e)},X=function(e){return g()&&e.payload&&e.payload.url&&!e.foreground?v(e.payload.url):w()&&e.url?v(e.url):void 0},Y=function(){var e,n={},t={};return n.init=function(){if(!window.plugins||!window.plugins.appsFlyer)return p("[appsflyer] missing cordova plugin");if("undefined"==typeof C.appstore_appid)return p("[appsflyer] missing manifest configuration: appstore_appid");if("undefined"==typeof C.appsflyer_devkey)return p("[appsflyer] missing manifest configuration: appsflyer_devkey");var n=[C.appsflyer_devkey];w()&&n.push(C.appstore_appid),document.addEventListener("onInstallConversionDataLoaded",function(n){if(t=n.detail,"function"!=typeof e)return f("[appsflyer] callback not set!");try{e(t),f("[appsflyer] parameters sent to webapp callback: "+JSON.stringify(t))}catch(i){p("[appsflyer] callback error: "+i,i)}},!1),window.plugins.appsFlyer.initSdk(n)},n.setCallback=function(n){e=n},n}();o.setConversionDataCallback=function(e){Y.setCallback(e)};var K=function(){var e,n={};return n.track=function(n){if("function"!=typeof e)return f("[analytics] callback not set!");try{e(n)}catch(t){p("[analytics] callback error: "+t,t)}},n.setCallback=function(n){e=n},n}();o.setAnalyticsCallback=function(e){K.setCallback(e)};return o.game=a.game._public,o.file=a.file,o});